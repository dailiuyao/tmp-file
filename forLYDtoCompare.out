x3007c0s19b1n0:38840:38840 [0] NCCL INFO cudaDriverVersion 11040
x3007c0s19b1n0:38843:38843 [1] NCCL INFO cudaDriverVersion 11040
x3007c0s19b1n0:38849:38849 [3] NCCL INFO cudaDriverVersion 11040
x3007c0s19b1n0:38847:38847 [2] NCCL INFO cudaDriverVersion 11040
x3007c0s19b1n0:38843:38843 [1] NCCL INFO Bootstrap : Using hsn0:10.201.2.47<0>
x3007c0s19b1n0:38843:38843 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3007c0s19b1n0:38840:38840 [0] NCCL INFO Bootstrap : Using hsn0:10.201.2.47<0>
x3007c0s19b1n0:38840:38840 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3007c0s19b1n0:38849:38849 [3] NCCL INFO Bootstrap : Using hsn0:10.201.2.47<0>
x3007c0s19b1n0:38849:38849 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3007c0s19b1n0:38847:38847 [2] NCCL INFO Bootstrap : Using hsn0:10.201.2.47<0>
x3007c0s19b1n0:38847:38847 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3007c0s19b1n0:38843:39932 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.2.47<0>
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Using network IB
x3007c0s19b1n0:38840:39933 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.2.47<0>
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Using network IB
x3007c0s19b1n0:38847:39934 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.2.47<0>
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Using network IB
x3007c0s19b1n0:38849:39939 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.2.47<0>
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Using network IB
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Trees [0] 13/-1/-1->12->8 [1] 13/-1/-1->12->8 [2] 13/4/-1->12->-1 [3] 13/4/-1->12->-1
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 00/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Trees [0] 14/-1/-1->13->12 [1] 14/-1/-1->13->12 [2] 14/-1/-1->13->12 [3] 14/-1/-1->13->12
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Trees [0] 15/-1/-1->14->13 [1] 15/-1/-1->14->13 [2] 15/-1/-1->14->13 [3] 15/-1/-1->14->13
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 00/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 01/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Trees [0] -1/-1/-1->15->14 [1] -1/-1/-1->15->14 [2] -1/-1/-1->15->14 [3] -1/-1/-1->15->14
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 00/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 01/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 02/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 02/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 01/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 03/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 03/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 02/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 03/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 00/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 01/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 02/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 03/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 00/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 01/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 02/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 00/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 03/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 01/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 02/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Channel 03/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 00/0 : 8[7000] -> 12[7000] [receive] via NET/IB/1
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 01/0 : 8[7000] -> 12[7000] [receive] via NET/IB/0
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 00/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 01/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 02/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Channel 03/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38847:39934 [2] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38847:39934 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38847:39934 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38849:39939 [3] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38849:39939 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38849:39939 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38843:39932 [1] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38843:39932 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38843:39932 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 02/0 : 4[7000] -> 12[7000] [receive] via NET/IB/1
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 03/0 : 4[7000] -> 12[7000] [receive] via NET/IB/0
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 02/0 : 12[7000] -> 4[7000] [send] via NET/IB/1
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 03/0 : 12[7000] -> 4[7000] [send] via NET/IB/0
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 00/0 : 12[7000] -> 8[7000] [send] via NET/IB/1
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Channel 01/0 : 12[7000] -> 8[7000] [send] via NET/IB/0
x3007c0s19b1n0:38840:39933 [0] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38840:39933 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38840:39933 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38849:39939 [3] NCCL INFO comm 0x55f4c52ab840 rank 15 nranks 16 cudaDev 3 busId c7000 - Init COMPLETE
x3007c0s19b1n0:38847:39934 [2] NCCL INFO comm 0x55aeb63b2000 rank 14 nranks 16 cudaDev 2 busId 85000 - Init COMPLETE
x3007c0s19b1n0:38843:39932 [1] NCCL INFO comm 0x557d9e97a0c0 rank 13 nranks 16 cudaDev 1 busId 46000 - Init COMPLETE
x3007c0s19b1n0:38840:39933 [0] NCCL INFO comm 0x557e1f73ab30 rank 12 nranks 16 cudaDev 0 busId 7000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 1287943 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 1317525 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 1306840 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 1337674 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 5306288 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 1158346 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 2059126 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 4417103 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce TREE LL Min double Elapsed time: 15629 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce TREE LL Min double Elapsed time: 4 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce TREE LL Min double Elapsed time: 25477 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce TREE LL Min double Elapsed time: 6 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum double Elapsed time: 97643 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum double Elapsed time: 72133 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum double Elapsed time: 88897 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum double Elapsed time: 80960 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 98685 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 127292 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 71171 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 27436 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 139040 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 181683 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 105460 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 152561 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 57669 us
time (ms) | load-checkpoint: 79.54
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 70278 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 62275 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 79118 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 74159 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 62142 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 50019 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 79681 us
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Using network IB
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Using network IB
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Using network IB
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Using network IB
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Trees [0] 13/-1/-1->12->8 [1] 13/-1/-1->12->8 [2] 13/4/-1->12->-1 [3] 13/4/-1->12->-1
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 00/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Trees [0] 14/-1/-1->13->12 [1] 14/-1/-1->13->12 [2] 14/-1/-1->13->12 [3] 14/-1/-1->13->12
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 01/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Trees [0] 15/-1/-1->14->13 [1] 15/-1/-1->14->13 [2] 15/-1/-1->14->13 [3] 15/-1/-1->14->13
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 00/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Trees [0] -1/-1/-1->15->14 [1] -1/-1/-1->15->14 [2] -1/-1/-1->15->14 [3] -1/-1/-1->15->14
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 02/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 00/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 01/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 03/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 01/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 02/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 02/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 03/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 03/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 00/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 01/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 02/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 03/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 00/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 01/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 02/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 03/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 00/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 01/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 02/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Channel 03/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 00/0 : 8[7000] -> 12[7000] [receive] via NET/IB/1
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 01/0 : 8[7000] -> 12[7000] [receive] via NET/IB/0
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 00/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 01/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 02/0 : 4[7000] -> 12[7000] [receive] via NET/IB/1
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 02/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Channel 03/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 03/0 : 4[7000] -> 12[7000] [receive] via NET/IB/0
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 02/0 : 12[7000] -> 4[7000] [send] via NET/IB/1
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 03/0 : 12[7000] -> 4[7000] [send] via NET/IB/0
x3007c0s19b1n0:38847:41772 [2] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38847:41772 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38847:41772 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38843:41773 [1] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38843:41773 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38843:41773 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38849:41771 [3] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38849:41771 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38849:41771 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 00/0 : 12[7000] -> 8[7000] [send] via NET/IB/1
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Channel 01/0 : 12[7000] -> 8[7000] [send] via NET/IB/0
x3007c0s19b1n0:38840:41774 [0] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38840:41774 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3007c0s19b1n0:38840:41774 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3007c0s19b1n0:38849:41771 [3] NCCL INFO comm 0x55f4e3cf32c0 rank 15 nranks 16 cudaDev 3 busId c7000 - Init COMPLETE
x3007c0s19b1n0:38847:41772 [2] NCCL INFO comm 0x55aed48248d0 rank 14 nranks 16 cudaDev 2 busId 85000 - Init COMPLETE
x3007c0s19b1n0:38843:41773 [1] NCCL INFO comm 0x557da3e8c860 rank 13 nranks 16 cudaDev 1 busId 46000 - Init COMPLETE
x3007c0s19b1n0:38840:41774 [0] NCCL INFO comm 0x557e3b35eed0 rank 12 nranks 16 cudaDev 0 busId 7000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Using network IB
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Using network IB
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Using network IB
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Using network IB
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Connected all rings
x3007c0s19b1n0:38843:42180 [1] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38843:42180 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:42178 [3] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38849:42178 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Connected all rings
x3007c0s19b1n0:38847:42182 [2] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38847:42182 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:42187 [0] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38840:42187 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38843:42180 [1] NCCL INFO comm 0x557da3e8fd60 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
x3007c0s19b1n0:38847:42182 [2] NCCL INFO comm 0x55aed3df4cd0 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
x3007c0s19b1n0:38849:42178 [3] NCCL INFO comm 0x55f4e3cf6750 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
x3007c0s19b1n0:38840:42187 [0] NCCL INFO comm 0x557e3a1f2d80 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum int64_t Elapsed time: 1243069 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum int64_t Elapsed time: 1333679 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum int64_t Elapsed time: 1322335 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum int64_t Elapsed time: 1321999 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum int64_t Elapsed time: 538820 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum int64_t Elapsed time: 513570 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum int64_t Elapsed time: 537762 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum int64_t Elapsed time: 525746 us
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Using network IB
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Using network IB
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Using network IB
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Using network IB
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Connected all rings
x3007c0s19b1n0:38843:42661 [1] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38843:42661 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:42659 [3] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38849:42659 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Connected all rings
x3007c0s19b1n0:38847:42665 [2] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38847:42665 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:42663 [0] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38840:42663 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38843:42661 [1] NCCL INFO comm 0x557da5903ff0 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3007c0s19b1n0:38849:42659 [3] NCCL INFO comm 0x55f4e3cfcc70 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3007c0s19b1n0:38840:42663 [0] NCCL INFO comm 0x557e397af360 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3007c0s19b1n0:38847:42665 [2] NCCL INFO comm 0x55aed482cb70 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 183266 us
time (ms) | model-and-optimizer-setup: 914.81 | train/valid/test-data-iterators-setup: 22741.74

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 161639 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 267521 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 92742 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 49590 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 48134 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 34187 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 10144 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 63452 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 50501 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 34589 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 21797 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1514003 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1514131 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1566500 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1566597 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1529905 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1530026 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1489966 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1490178 us
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Using network IB
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Using network IB
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Using network IB
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Using network IB
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Connected all rings
x3007c0s19b1n0:38840:44284 [0] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38840:44284 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Connected all rings
x3007c0s19b1n0:38849:44288 [3] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38849:44288 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Connected all rings
x3007c0s19b1n0:38847:44286 [2] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38847:44286 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 00/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 01/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 02/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 03/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 04/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 05/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 06/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 07/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 08/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 09/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 10/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 11/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 12/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 13/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 14/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 15/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 16/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 17/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 18/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 19/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 20/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 21/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 22/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 23/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 24/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 25/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 26/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 27/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 28/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 29/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 30/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Channel 31/32 :    0
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Connected all rings
x3007c0s19b1n0:38843:44290 [1] NCCL INFO Connected all trees by HAO
x3007c0s19b1n0:38843:44290 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3007c0s19b1n0:38840:44284 [0] NCCL INFO comm 0x557e6f5e2c60 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
x3007c0s19b1n0:38849:44288 [3] NCCL INFO comm 0x55f5196cf2f0 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
x3007c0s19b1n0:38843:44290 [1] NCCL INFO comm 0x557dd9068c00 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
x3007c0s19b1n0:38847:44286 [2] NCCL INFO comm 0x55af09b13730 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        1/     100 | consumed samples:          192 | elapsed time per iteration (ms): 7212.5 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 4294967296.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 2858.88 | backward-compute: 2013.04 | backward-params-all-reduce: 1597.97 | backward-embedding-all-reduce: 0.05 | optimizer-copy-to-main-grad: 32.78 | optimizer-unscale-and-check-inf: 643.32 | optimizer: 676.21 | batch-generator: 2.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 251126 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 234209 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 222705 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 243639 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1699830 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1700021 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1639132 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1639260 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1765438 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1765535 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1729431 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1729534 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
 iteration        2/     100 | consumed samples:          384 | elapsed time per iteration (ms): 2424.6 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 2147483648.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 366.22 | backward-compute: 147.21 | backward-params-all-reduce: 1848.13 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 54.46 | optimizer: 60.82 | batch-generator: 2.11
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 64863 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 37003 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 85578 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 35247 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1866998 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1867100 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1809507 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1809607 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration        3/     100 | consumed samples:          576 | elapsed time per iteration (ms): 2291.6 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 1073741824.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 242.88 | backward-compute: 201.04 | backward-params-all-reduce: 1832.96 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 6.18 | optimizer: 12.51 | batch-generator: 1.95

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1890901 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1891034 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1826611 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1826732 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 95797 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 166644 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 169090 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 150783 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1816213 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1816312 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1863848 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1863978 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1904725 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1904856 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1940580 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1940677 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration        4/     100 | consumed samples:          768 | elapsed time per iteration (ms): 2522.2 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 536870912.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 406.00 | backward-compute: 221.42 | backward-params-all-reduce: 1837.94 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 48.39 | optimizer: 54.74 | batch-generator: 56.26
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 233647 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 200992 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 204439 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 166763 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1956062 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1956196 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1826211 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1826505 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1720613 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1720753 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1688397 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1688508 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        5/     100 | consumed samples:          960 | elapsed time per iteration (ms): 2600.4 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 268435456.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 394.50 | backward-compute: 151.40 | backward-params-all-reduce: 1992.13 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 53.77 | optimizer: 60.13 | batch-generator: 2.11
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 68865 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 57796 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 96840 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 56766 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1768659 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1768762 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1891012 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1891136 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1814936 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1815066 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1710781 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1710891 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration        6/     100 | consumed samples:         1152 | elapsed time per iteration (ms): 2433.6 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 134217728.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 299.40 | backward-compute: 234.67 | backward-params-all-reduce: 1843.48 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 47.43 | optimizer: 53.77 | batch-generator: 2.09
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 126520 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 131334 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 166138 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 151008 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1660631 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1660733 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1713694 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1713841 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1780045 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1780175 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1677935 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1678035 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration        7/     100 | consumed samples:         1344 | elapsed time per iteration (ms): 2319.3 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 67108864.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 385.36 | backward-compute: 189.85 | backward-params-all-reduce: 1690.17 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.22 | optimizer-unscale-and-check-inf: 45.20 | optimizer: 51.53 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 90003 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 86727 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 99482 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 70773 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1849644 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1849741 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1738724 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1738848 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1835429 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1835559 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1793730 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1793828 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        8/     100 | consumed samples:         1536 | elapsed time per iteration (ms): 2366.3 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 33554432.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 242.45 | backward-compute: 177.07 | backward-params-all-reduce: 1882.95 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 55.33 | optimizer: 61.68 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000048000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 103182 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 47365 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 75592 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 92607 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1770352 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1770451 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1742679 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1742776 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1714863 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1715024 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1635065 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1635198 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        9/     100 | consumed samples:         1728 | elapsed time per iteration (ms): 2323.0 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 16777216.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 223.17 | backward-compute: 214.06 | backward-params-all-reduce: 1837.09 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 32.16 | optimizer-unscale-and-check-inf: 14.20 | optimizer: 46.47 | batch-generator: 2.02
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 74912 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 36406 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 21648 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 101500 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1733808 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1733905 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1659100 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1659244 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1680077 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1680195 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1715269 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1715403 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       10/     100 | consumed samples:         1920 | elapsed time per iteration (ms): 2180.6 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 8388608.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 284.53 | backward-compute: 150.26 | backward-params-all-reduce: 1713.70 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 23.64 | optimizer: 29.99 | batch-generator: 2.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 140845 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 10 | lm loss value: 1.105502E+01 | lm loss PPL: 6.326087E+04 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 131034 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 107989 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 133898 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 53552 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 41481 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 30998 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 44654 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1674862 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1675016 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       11/     100 | consumed samples:         2112 | elapsed time per iteration (ms): 3258.7 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 4194304.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 1313.81 | backward-compute: 241.86 | backward-params-all-reduce: 1685.75 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.85 | optimizer: 12.20 | batch-generator: 14.98

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1807637 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1807763 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1724932 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1725031 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1747912 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1748103 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 111795 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 69440 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 82144 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 78277 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1562135 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1562239 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1656724 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1656899 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1578216 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1578337 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1667576 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1667697 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       12/     100 | consumed samples:         2304 | elapsed time per iteration (ms): 2170.7 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 2097152.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 281.38 | backward-compute: 173.52 | backward-params-all-reduce: 1701.67 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 5.62 | optimizer: 11.95 | batch-generator: 47.54
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 59200 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 80594 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 67067 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 50237 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1973812 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1973922 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 2099844 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 2099992 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1950683 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1950784 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2043281 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2043413 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       13/     100 | consumed samples:         2496 | elapsed time per iteration (ms): 2560.6 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 1048576.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 302.11 | backward-compute: 190.66 | backward-params-all-reduce: 2021.74 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 5.54 | optimizer: 43.91 | batch-generator: 56.31
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98836 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 85866 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 90941 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 109302 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1877650 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1877775 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1903231 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1903336 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1826455 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1826552 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1769372 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1769501 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       14/     100 | consumed samples:         2688 | elapsed time per iteration (ms): 2404.1 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 524288.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 241.24 | backward-compute: 154.38 | backward-params-all-reduce: 1949.74 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 50.22 | optimizer: 56.57 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 148428 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 169951 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 150292 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 150900 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1802944 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1803131 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1738628 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1738737 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1777411 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1777509 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1664264 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1664396 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       15/     100 | consumed samples:         2880 | elapsed time per iteration (ms): 2391.8 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 262144.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 320.31 | backward-compute: 216.67 | backward-params-all-reduce: 1840.76 | backward-embedding-all-reduce: 0.05 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 5.60 | optimizer: 11.94 | batch-generator: 1.99
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000057000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 97666 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 94894 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 126139 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 109919 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1683068 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1683199 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1746840 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1747032 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1826628 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1826731 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1771263 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1771442 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       16/     100 | consumed samples:         3072 | elapsed time per iteration (ms): 2447.4 | learning rate: 1.500E-04 | global batch size:   192 | lm loss: 1.107613E+01 | loss scale: 262144.0 | grad norm: 35.738 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 293.93 | backward-compute: 185.74 | backward-params-all-reduce: 1838.25 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 72.07 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 127.29 | batch-generator: 52.59
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 61793 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 48461 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 82981 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 21173 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1875296 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1875427 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1850687 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1850887 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1908016 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1908116 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1832745 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1832902 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       17/     100 | consumed samples:         3264 | elapsed time per iteration (ms): 2528.6 | learning rate: 1.498E-04 | global batch size:   192 | lm loss: 1.107726E+01 | loss scale: 262144.0 | grad norm: 36.024 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 296.33 | backward-compute: 157.00 | backward-params-all-reduce: 1886.08 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 37.73 | optimizer-clip-main-grad: 51.87 | optimizer-copy-main-to-model-params: 61.98 | optimizer: 175.92 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 63030 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 86392 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 76610 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 101555 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1789467 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1789610 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1816263 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1816362 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1672738 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1672837 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1702815 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1702956 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       18/     100 | consumed samples:         3456 | elapsed time per iteration (ms): 2280.1 | learning rate: 1.498E-04 | global batch size:   192 | loss scale: 131072.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 181.00 | backward-compute: 162.56 | backward-params-all-reduce: 1877.08 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 50.93 | optimizer-clip-main-grad: 0.00 | optimizer-copy-main-to-model-params: 0.00 | optimizer: 57.26 | batch-generator: 1.92
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 62240 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 73808 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 117796 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 33542 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1495400 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1495526 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1571853 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1571950 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1560931 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1561111 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1453087 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1453189 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       19/     100 | consumed samples:         3648 | elapsed time per iteration (ms): 2138.5 | learning rate: 1.495E-04 | global batch size:   192 | lm loss: 9.717583E+00 | loss scale: 131072.0 | grad norm: 13.507 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 235.85 | backward-compute: 163.59 | backward-params-all-reduce: 1608.97 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 44.19 | optimizer-clip-main-grad: 9.27 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 127.77 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 11290 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 83202 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 86980 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 45894 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1854324 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1854423 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1877964 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1878083 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1942779 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1942876 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1850676 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1850808 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
 iteration       20/     100 | consumed samples:         3840 | elapsed time per iteration (ms): 2423.9 | learning rate: 1.490E-04 | global batch size:   192 | lm loss: 1.044656E+01 | loss scale: 131072.0 | grad norm: 6.151 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 247.77 | backward-compute: 185.11 | backward-params-all-reduce: 1874.22 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 49.64 | optimizer-clip-main-grad: 9.25 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 114.50 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 114774 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 20 | lm loss value: 9.542729E+00 | lm loss PPL: 1.394295E+04 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 81373 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 10197 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 60993 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 92216 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 90814 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 76697 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 74945 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1779711 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1779837 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1753440 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1753537 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1838964 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1839061 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1815423 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1815585 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       21/     100 | consumed samples:         4032 | elapsed time per iteration (ms): 2724.9 | learning rate: 1.483E-04 | global batch size:   192 | lm loss: 9.612200E+00 | loss scale: 131072.0 | grad norm: 2.992 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 577.54 | backward-compute: 166.03 | backward-params-all-reduce: 1807.19 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 55.73 | optimizer-clip-main-grad: 21.27 | optimizer-copy-main-to-model-params: 6.72 | optimizer: 169.42 | batch-generator: 3.87
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 42605 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 55838 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 8383 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 20210 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1731399 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1731569 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1696121 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1696294 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1660787 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1660888 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1627594 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1627715 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       22/     100 | consumed samples:         4224 | elapsed time per iteration (ms): 2297.3 | learning rate: 1.474E-04 | global batch size:   192 | lm loss: 9.266836E+00 | loss scale: 131072.0 | grad norm: 2.420 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 207.45 | backward-compute: 158.87 | backward-params-all-reduce: 1819.82 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 33.73 | optimizer-clip-main-grad: 9.25 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 108.78 | batch-generator: 2.00
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000060000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 105547 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 92331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 78017 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 61145 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1885591 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1885689 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1848029 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1848126 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1974004 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1974132 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1920703 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1920831 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       23/     100 | consumed samples:         4416 | elapsed time per iteration (ms): 2551.8 | learning rate: 1.463E-04 | global batch size:   192 | lm loss: 8.976410E+00 | loss scale: 131072.0 | grad norm: 2.362 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 258.39 | backward-compute: 272.39 | backward-params-all-reduce: 1898.62 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 49.19 | optimizer-clip-main-grad: 39.86 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 120.02 | batch-generator: 2.13
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 40805 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 58816 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 57809 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 34668 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1803782 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1803880 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1726221 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1726342 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1754334 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1754432 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1869806 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1869964 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       24/     100 | consumed samples:         4608 | elapsed time per iteration (ms): 2387.4 | learning rate: 1.451E-04 | global batch size:   192 | lm loss: 8.740615E+00 | loss scale: 131072.0 | grad norm: 2.357 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 267.46 | backward-compute: 166.85 | backward-params-all-reduce: 1825.93 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 34.64 | optimizer-clip-main-grad: 39.89 | optimizer-copy-main-to-model-params: 25.96 | optimizer: 124.87 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 134552 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 91278 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 70939 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 62731 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1676356 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1676458 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1617772 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1617904 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1762905 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1763037 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1733745 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1733876 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       25/     100 | consumed samples:         4800 | elapsed time per iteration (ms): 2342.6 | learning rate: 1.436E-04 | global batch size:   192 | lm loss: 8.532214E+00 | loss scale: 131072.0 | grad norm: 1.903 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 279.42 | backward-compute: 168.15 | backward-params-all-reduce: 1782.66 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 15.49 | optimizer-unscale-and-check-inf: 23.31 | optimizer-clip-main-grad: 40.54 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 110.07 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000058000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 113567 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 86953 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 30347 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 101888 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1943909 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1944007 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1882419 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1882553 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1817961 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1818057 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1921245 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1921372 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       26/     100 | consumed samples:         4992 | elapsed time per iteration (ms): 2516.0 | learning rate: 1.421E-04 | global batch size:   192 | lm loss: 8.379333E+00 | loss scale: 131072.0 | grad norm: 1.957 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 291.12 | backward-compute: 214.13 | backward-params-all-reduce: 1849.60 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 15.83 | optimizer-unscale-and-check-inf: 5.69 | optimizer-clip-main-grad: 35.53 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 102.51 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 31622 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 43626 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 62815 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 73739 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1737425 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1737553 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1828782 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1828916 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1771806 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1771912 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1794177 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1794291 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       27/     100 | consumed samples:         5184 | elapsed time per iteration (ms): 2428.0 | learning rate: 1.403E-04 | global batch size:   192 | lm loss: 8.300729E+00 | loss scale: 131072.0 | grad norm: 3.217 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 277.16 | backward-compute: 167.88 | backward-params-all-reduce: 1856.47 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 11.34 | optimizer-unscale-and-check-inf: 5.65 | optimizer-clip-main-grad: 44.56 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 124.26 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 87353 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 47305 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 68777 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 78166 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1921647 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1921746 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1810644 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1810743 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1881216 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1881341 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1962827 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1962950 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
 iteration       28/     100 | consumed samples:         5376 | elapsed time per iteration (ms): 2492.0 | learning rate: 1.384E-04 | global batch size:   192 | lm loss: 8.162030E+00 | loss scale: 131072.0 | grad norm: 2.260 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 218.43 | backward-compute: 208.13 | backward-params-all-reduce: 1946.82 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 31.62 | optimizer-clip-main-grad: 9.26 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 96.43 | batch-generator: 1.99
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 25508 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 102610 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 40105 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 73568 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1844237 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1844370 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1860331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1860459 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1766427 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1766525 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1883587 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1883709 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       29/     100 | consumed samples:         5568 | elapsed time per iteration (ms): 2492.0 | learning rate: 1.364E-04 | global batch size:   192 | lm loss: 8.030540E+00 | loss scale: 131072.0 | grad norm: 1.593 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 279.71 | backward-compute: 148.26 | backward-params-all-reduce: 1917.56 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.62 | optimizer-clip-main-grad: 65.93 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 116.29 | batch-generator: 2.12
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 46117 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 31485 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 101982 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 107046 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1911437 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1911570 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1857946 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1858072 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1975413 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1975514 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1706556 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1706678 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       30/     100 | consumed samples:         5760 | elapsed time per iteration (ms): 2562.6 | learning rate: 1.341E-04 | global batch size:   192 | lm loss: 7.920771E+00 | loss scale: 131072.0 | grad norm: 1.083 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 309.84 | backward-compute: 327.30 | backward-params-all-reduce: 1801.85 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 25.73 | optimizer-clip-main-grad: 9.26 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 101.13 | batch-generator: 2.11
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98400 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 30 | lm loss value: 8.014776E+00 | lm loss PPL: 3.025332E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 7997 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 108234 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 74276 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 24073 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 16439 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 3706 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 47053 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1808569 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1808719 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1729611 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1729708 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1833830 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1833939 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1799756 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1799906 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       31/     100 | consumed samples:         5952 | elapsed time per iteration (ms): 2573.4 | learning rate: 1.318E-04 | global batch size:   192 | lm loss: 7.854444E+00 | loss scale: 131072.0 | grad norm: 1.352 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 451.94 | backward-compute: 152.91 | backward-params-all-reduce: 1857.43 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 61.40 | optimizer-clip-main-grad: 9.24 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 106.25 | batch-generator: 3.60
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 93329 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 102754 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 91327 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 121725 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1923139 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1923264 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1889223 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1889319 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1946428 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1946619 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1842290 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1842392 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
 iteration       32/     100 | consumed samples:         6144 | elapsed time per iteration (ms): 2527.9 | learning rate: 1.293E-04 | global batch size:   192 | lm loss: 7.798200E+00 | loss scale: 131072.0 | grad norm: 1.435 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 342.70 | backward-compute: 147.54 | backward-params-all-reduce: 1921.02 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 59.12 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 114.42 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 108531 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 53463 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 86037 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 76878 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1713542 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1713738 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1770236 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1770334 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1634226 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1634324 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1738486 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1738620 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       33/     100 | consumed samples:         6336 | elapsed time per iteration (ms): 2404.1 | learning rate: 1.266E-04 | global batch size:   192 | lm loss: 7.704471E+00 | loss scale: 131072.0 | grad norm: 1.524 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 254.34 | backward-compute: 151.02 | backward-params-all-reduce: 1811.56 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 38.84 | optimizer-unscale-and-check-inf: 5.68 | optimizer-clip-main-grad: 9.23 | optimizer-copy-main-to-model-params: 6.70 | optimizer: 165.41 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 108057 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 87342 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 15428 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 98593 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1756222 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1756370 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1890592 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1890689 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1886655 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1886752 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1812762 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1812897 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       34/     100 | consumed samples:         6528 | elapsed time per iteration (ms): 2479.9 | learning rate: 1.239E-04 | global batch size:   192 | lm loss: 7.655545E+00 | loss scale: 131072.0 | grad norm: 1.296 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 254.04 | backward-compute: 170.81 | backward-params-all-reduce: 1890.49 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 57.43 | optimizer-clip-main-grad: 9.25 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 162.27 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 109381 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 143237 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 102451 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 112262 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1868298 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1868464 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1927690 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1927792 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1963568 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1963693 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1907498 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1907632 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       35/     100 | consumed samples:         6720 | elapsed time per iteration (ms): 2611.6 | learning rate: 1.210E-04 | global batch size:   192 | lm loss: 7.602894E+00 | loss scale: 131072.0 | grad norm: 1.015 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 307.78 | backward-compute: 199.10 | backward-params-all-reduce: 1920.40 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 75.86 | optimizer-copy-main-to-model-params: 76.20 | optimizer: 182.03 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 236871 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 247304 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 233480 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 232737 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1739068 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1739165 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1792136 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1792268 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1684688 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1684787 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1765448 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1765598 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       36/     100 | consumed samples:         6912 | elapsed time per iteration (ms): 2457.8 | learning rate: 1.180E-04 | global batch size:   192 | lm loss: 7.578309E+00 | loss scale: 131072.0 | grad norm: 0.667 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 391.55 | backward-compute: 169.82 | backward-params-all-reduce: 1794.45 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 63.08 | optimizer-copy-main-to-model-params: 6.60 | optimizer: 99.63 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 121317 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 77122 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 78342 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 83157 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1635280 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1635378 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1769230 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1769362 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1699949 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1700082 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1757422 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1757749 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       37/     100 | consumed samples:         7104 | elapsed time per iteration (ms): 2414.6 | learning rate: 1.149E-04 | global batch size:   192 | lm loss: 7.519432E+00 | loss scale: 131072.0 | grad norm: 0.801 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 295.82 | backward-compute: 171.71 | backward-params-all-reduce: 1798.36 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.22 | optimizer-unscale-and-check-inf: 49.59 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 146.43 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 157392 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 111728 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 147283 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 55085 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2043900 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2044002 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1986665 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1986802 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1918541 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1918640 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 2010887 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 2011010 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
 iteration       38/     100 | consumed samples:         7296 | elapsed time per iteration (ms): 2579.9 | learning rate: 1.117E-04 | global batch size:   192 | lm loss: 7.481350E+00 | loss scale: 131072.0 | grad norm: 0.963 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 295.84 | backward-compute: 237.55 | backward-params-all-reduce: 1955.32 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 12.27 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 89.00 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 20472 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 59181 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 39366 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 20572 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1754394 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1754558 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1852482 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1852589 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1787615 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1787747 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1828603 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1828773 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       39/     100 | consumed samples:         7488 | elapsed time per iteration (ms): 2356.0 | learning rate: 1.084E-04 | global batch size:   192 | lm loss: 7.439357E+00 | loss scale: 131072.0 | grad norm: 0.713 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 209.78 | backward-compute: 221.19 | backward-params-all-reduce: 1764.22 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 29.81 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 98.69 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000063000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 124981 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 157895 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 182986 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 113039 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1925335 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1925436 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1828214 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1828340 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1880745 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1880843 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1951144 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1951360 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       40/     100 | consumed samples:         7680 | elapsed time per iteration (ms): 2624.0 | learning rate: 1.051E-04 | global batch size:   192 | lm loss: 7.425623E+00 | loss scale: 131072.0 | grad norm: 0.521 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 378.41 | backward-compute: 185.71 | backward-params-all-reduce: 1927.77 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 40.93 | optimizer-clip-main-grad: 21.65 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 129.85 | batch-generator: 2.10
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 88985 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 40 | lm loss value: 7.777015E+00 | lm loss PPL: 2.385144E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 153494 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 98713 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 100394 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 65665 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 77994 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 93007 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 84198 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1868265 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1868390 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 2002691 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 2002815 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1876433 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1876543 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1962328 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1962430 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       41/     100 | consumed samples:         7872 | elapsed time per iteration (ms): 2816.0 | learning rate: 1.016E-04 | global batch size:   192 | lm loss: 7.400822E+00 | loss scale: 131072.0 | grad norm: 0.518 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 540.35 | backward-compute: 196.59 | backward-params-all-reduce: 1938.53 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 45.63 | optimizer-clip-main-grad: 4.16 | optimizer-copy-main-to-model-params: 6.69 | optimizer: 122.61 | batch-generator: 3.59
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 89793 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 92844 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 61413 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 58138 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1642059 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1642200 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1732242 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1732339 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1800149 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1800305 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1769873 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1769974 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       42/     100 | consumed samples:         8064 | elapsed time per iteration (ms): 2299.9 | learning rate: 9.812E-05 | global batch size:   192 | lm loss: 7.385534E+00 | loss scale: 131072.0 | grad norm: 0.629 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 290.51 | backward-compute: 160.80 | backward-params-all-reduce: 1740.96 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 52.46 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 105.26 | batch-generator: 2.53
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 136708 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 151824 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 180568 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 135805 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1846529 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1846632 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1895902 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1896030 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1927439 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1927567 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1779629 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1779727 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       43/     100 | consumed samples:         8256 | elapsed time per iteration (ms): 2588.0 | learning rate: 9.456E-05 | global batch size:   192 | lm loss: 7.413561E+00 | loss scale: 131072.0 | grad norm: 0.612 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 379.31 | backward-compute: 154.64 | backward-params-all-reduce: 1957.38 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 21.71 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 74.53 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 47228 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 70172 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 3631 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 60226 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1803125 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1803227 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1829527 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1829646 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1755435 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1755533 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1782478 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1782609 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       44/     100 | consumed samples:         8448 | elapsed time per iteration (ms): 2392.5 | learning rate: 9.094E-05 | global batch size:   192 | lm loss: 7.416158E+00 | loss scale: 131072.0 | grad norm: 0.616 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 300.65 | backward-compute: 182.80 | backward-params-all-reduce: 1830.02 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 4.36 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 76.77 | batch-generator: 2.12
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 52741 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 65274 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 16967 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 52226 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1888389 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1888488 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1872248 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1872346 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1835813 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1835947 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1782750 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1782874 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       45/     100 | consumed samples:         8640 | elapsed time per iteration (ms): 2416.1 | learning rate: 8.729E-05 | global batch size:   192 | lm loss: 7.375598E+00 | loss scale: 131072.0 | grad norm: 0.489 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 215.71 | backward-compute: 217.57 | backward-params-all-reduce: 1892.19 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.60 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.61 | optimizer: 88.08 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000053000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 67368 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 104328 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 40745 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 25828 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1969570 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1969784 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1994956 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1995086 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2020404 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2020630 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2040092 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2040196 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
 iteration       46/     100 | consumed samples:         8832 | elapsed time per iteration (ms): 2581.4 | learning rate: 8.361E-05 | global batch size:   192 | lm loss: 7.375164E+00 | loss scale: 131072.0 | grad norm: 0.348 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 317.44 | backward-compute: 208.44 | backward-params-all-reduce: 1975.14 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 8.36 | optimizer-unscale-and-check-inf: 11.51 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 78.05 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 71760 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 21872 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 72707 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 109936 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1800477 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1800616 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1739846 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1739966 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1833879 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1834005 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1781765 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1781863 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       47/     100 | consumed samples:         9024 | elapsed time per iteration (ms): 2412.1 | learning rate: 7.991E-05 | global batch size:   192 | lm loss: 7.371035E+00 | loss scale: 131072.0 | grad norm: 0.346 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 311.27 | backward-compute: 223.78 | backward-params-all-reduce: 1788.13 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 51.51 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 86.53 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 117283 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 92350 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 30985 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 91259 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1854874 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1854973 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1878658 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1878785 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1809498 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1809631 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1772183 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1772424 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       48/     100 | consumed samples:         9216 | elapsed time per iteration (ms): 2505.8 | learning rate: 7.619E-05 | global batch size:   192 | lm loss: 7.392964E+00 | loss scale: 131072.0 | grad norm: 0.398 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 278.94 | backward-compute: 166.07 | backward-params-all-reduce: 1932.65 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 59.10 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 116.14 | batch-generator: 2.10
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 290007 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 263859 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 236645 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 302506 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1840393 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1840521 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1770069 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1770205 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1869949 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1870047 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1937850 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1937949 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       49/     100 | consumed samples:         9408 | elapsed time per iteration (ms): 2708.1 | learning rate: 7.247E-05 | global batch size:   192 | lm loss: 7.378971E+00 | loss scale: 131072.0 | grad norm: 0.479 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 430.91 | backward-compute: 158.36 | backward-params-all-reduce: 1997.81 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 38.02 | optimizer-clip-main-grad: 4.13 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 118.72 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 45517 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 58228 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 38911 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 80907 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1878010 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1878112 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1770928 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1771066 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1677030 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1677154 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1853890 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1854035 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       50/     100 | consumed samples:         9600 | elapsed time per iteration (ms): 2459.9 | learning rate: 6.876E-05 | global batch size:   192 | lm loss: 7.360871E+00 | loss scale: 131072.0 | grad norm: 0.472 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 246.00 | backward-compute: 148.14 | backward-params-all-reduce: 1953.40 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.66 | optimizer-clip-main-grad: 4.14 | optimizer-copy-main-to-model-params: 6.69 | optimizer: 89.80 | batch-generator: 2.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 132063 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 131616 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 63911 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 50 | lm loss value: 7.820457E+00 | lm loss PPL: 2.491044E+03 | 
----------------------------------------------------------------------------------------------
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 107544 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 56556 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 55091 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 51752 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 21034 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 33499476 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 33522544 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 33506761 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 33502702 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 44296 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 57419 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 31858 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 20177 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 23401 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 51409 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 26019 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 39798 us
time (ms) | save-checkpoint: 33659.00
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 34024 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 20183 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 32756 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 9567 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1234390 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1234488 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1215347 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1215447 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1263150 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1263272 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1299407 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1299544 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       51/     100 | consumed samples:         9792 | elapsed time per iteration (ms): 35827.7 | learning rate: 6.506E-05 | global batch size:   192 | lm loss: 7.352393E+00 | loss scale: 131072.0 | grad norm: 0.367 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 412.59 | backward-compute: 250.63 | backward-params-all-reduce: 1261.02 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 27.39 | optimizer-unscale-and-check-inf: 8.91 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.72 | optimizer: 170.95 | batch-generator: 4.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 225949 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 243641 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 261040 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 167120 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1838791 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1838911 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1789879 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1789977 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1772849 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1773041 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1815229 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1815406 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       52/     100 | consumed samples:         9984 | elapsed time per iteration (ms): 2568.3 | learning rate: 6.139E-05 | global batch size:   192 | lm loss: 7.360666E+00 | loss scale: 131072.0 | grad norm: 0.313 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 392.05 | backward-compute: 213.26 | backward-params-all-reduce: 1829.98 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 37.62 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 130.67 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 12012 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 231217 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 2021 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 205305 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1652967 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1653130 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1697644 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1697784 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1732947 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1733047 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1747520 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1747784 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       53/     100 | consumed samples:        10176 | elapsed time per iteration (ms): 2407.8 | learning rate: 5.775E-05 | global batch size:   192 | lm loss: 7.341165E+00 | loss scale: 131072.0 | grad norm: 0.266 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 365.75 | backward-compute: 242.41 | backward-params-all-reduce: 1662.20 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 59.98 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 135.11 | batch-generator: 3.83
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 74403 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 35453 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 86281 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 69113 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1896818 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1896990 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1888340 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1888443 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1840937 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1841073 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1789491 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1789591 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       54/     100 | consumed samples:        10368 | elapsed time per iteration (ms): 2508.0 | learning rate: 5.416E-05 | global batch size:   192 | lm loss: 7.368979E+00 | loss scale: 131072.0 | grad norm: 0.281 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 249.97 | backward-compute: 183.05 | backward-params-all-reduce: 1934.12 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 16.51 | optimizer-unscale-and-check-inf: 5.65 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 138.45 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000095000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 90621 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 73688 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 64433 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 93767 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1892157 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1892280 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1951472 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1951670 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1925211 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1925313 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1864414 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1864604 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       55/     100 | consumed samples:        10560 | elapsed time per iteration (ms): 2538.1 | learning rate: 5.061E-05 | global batch size:   192 | lm loss: 7.343782E+00 | loss scale: 131072.0 | grad norm: 0.355 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 262.22 | backward-compute: 166.79 | backward-params-all-reduce: 1975.49 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 50.50 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 131.05 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 87190 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 98858 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 84784 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 48960 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1794652 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1794779 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1841286 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1841412 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1875125 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1875226 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1932054 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1932161 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       56/     100 | consumed samples:        10752 | elapsed time per iteration (ms): 2514.1 | learning rate: 4.713E-05 | global batch size:   192 | lm loss: 7.367580E+00 | loss scale: 131072.0 | grad norm: 0.347 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 228.05 | backward-compute: 166.86 | backward-params-all-reduce: 1994.20 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 45.71 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.80 | optimizer: 122.71 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 99085 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 55770 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 34997 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 90072 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1851625 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1851722 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1703722 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1703818 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1768405 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1768528 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1823165 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1823300 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       57/     100 | consumed samples:        10944 | elapsed time per iteration (ms): 2389.2 | learning rate: 4.371E-05 | global batch size:   192 | lm loss: 7.345683E+00 | loss scale: 131072.0 | grad norm: 0.290 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 257.34 | backward-compute: 244.10 | backward-params-all-reduce: 1733.85 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 42.30 | optimizer-clip-main-grad: 4.14 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 135.88 | batch-generator: 2.02
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 124202 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 73502 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 90035 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 87290 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1989109 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1989242 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2024792 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2024889 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1924496 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1924605 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1954097 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1954226 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       58/     100 | consumed samples:        11136 | elapsed time per iteration (ms): 2678.5 | learning rate: 4.037E-05 | global batch size:   192 | lm loss: 7.356733E+00 | loss scale: 131072.0 | grad norm: 0.258 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 294.53 | backward-compute: 225.21 | backward-params-all-reduce: 1990.10 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 49.63 | optimizer-clip-main-grad: 13.34 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 166.39 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 22325 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 70089 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 66737 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 5029 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1833429 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1833558 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1922055 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1922173 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1743436 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1743571 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1862998 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1863097 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       59/     100 | consumed samples:        11328 | elapsed time per iteration (ms): 2432.1 | learning rate: 3.711E-05 | global batch size:   192 | lm loss: 7.363332E+00 | loss scale: 131072.0 | grad norm: 0.241 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 163.60 | backward-compute: 149.52 | backward-params-all-reduce: 1959.10 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 73.10 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 157.66 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 24823 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 47617 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 20078 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 9523 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1663378 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1663515 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1683914 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1684019 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1711559 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1711658 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1642280 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1642523 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       60/     100 | consumed samples:        11520 | elapsed time per iteration (ms): 2256.0 | learning rate: 3.395E-05 | global batch size:   192 | lm loss: 7.341727E+00 | loss scale: 131072.0 | grad norm: 0.229 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 184.73 | backward-compute: 164.21 | backward-params-all-reduce: 1774.54 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 14.68 | optimizer-unscale-and-check-inf: 5.66 | optimizer-clip-main-grad: 39.31 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 130.25 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 56256 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 8540 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 51159 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 64653 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 60 | lm loss value: 7.785685E+00 | lm loss PPL: 2.405913E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 83312 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 80126 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 73620 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 89120 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1794050 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1794196 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1743173 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1743275 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1665241 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1665338 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1798592 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1798723 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       61/     100 | consumed samples:        11712 | elapsed time per iteration (ms): 2624.0 | learning rate: 3.089E-05 | global batch size:   192 | lm loss: 7.360823E+00 | loss scale: 131072.0 | grad norm: 0.237 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 512.62 | backward-compute: 200.54 | backward-params-all-reduce: 1789.04 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 60.12 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 116.95 | batch-generator: 7.91
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 138253 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 95050 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 103247 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 124561 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1910278 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1910374 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1931264 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1931403 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1955091 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1955218 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1982495 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1982593 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       62/     100 | consumed samples:        11904 | elapsed time per iteration (ms): 2576.0 | learning rate: 2.794E-05 | global batch size:   192 | lm loss: 7.350605E+00 | loss scale: 131072.0 | grad norm: 0.247 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 355.88 | backward-compute: 162.22 | backward-params-all-reduce: 1941.69 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 31.34 | optimizer-unscale-and-check-inf: 5.76 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 113.97 | batch-generator: 2.10
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 68300 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 84553 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 103551 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 114597 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1855564 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1855662 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1893349 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1893483 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1819219 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1819352 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1748598 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1748700 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       63/     100 | consumed samples:        12096 | elapsed time per iteration (ms): 2432.0 | learning rate: 2.510E-05 | global batch size:   192 | lm loss: 7.332828E+00 | loss scale: 131072.0 | grad norm: 0.229 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 254.16 | backward-compute: 182.79 | backward-params-all-reduce: 1885.19 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 34.73 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 107.57 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 194554 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 174098 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 203609 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 192241 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1803455 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1803579 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1839221 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1839318 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1735833 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1735931 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1816925 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1817050 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       64/     100 | consumed samples:        12288 | elapsed time per iteration (ms): 2515.7 | learning rate: 2.239E-05 | global batch size:   192 | lm loss: 7.349171E+00 | loss scale: 131072.0 | grad norm: 0.253 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 344.76 | backward-compute: 168.19 | backward-params-all-reduce: 1862.29 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 5.60 | optimizer-clip-main-grad: 64.07 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 138.19 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 61742 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 17886 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 30876 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 61855 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1758236 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1758333 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1788829 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1788928 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1714692 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1714819 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1738909 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1739060 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       65/     100 | consumed samples:        12480 | elapsed time per iteration (ms): 2384.3 | learning rate: 1.980E-05 | global batch size:   192 | lm loss: 7.337546E+00 | loss scale: 131072.0 | grad norm: 0.222 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 225.33 | backward-compute: 159.91 | backward-params-all-reduce: 1880.76 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 39.14 | optimizer-clip-main-grad: 4.16 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 115.99 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 161317 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 15823 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 137268 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 91450 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1835147 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1835275 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1891272 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1891372 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1848606 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1848725 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1767384 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1767549 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       66/     100 | consumed samples:        12672 | elapsed time per iteration (ms): 2585.1 | learning rate: 1.736E-05 | global batch size:   192 | lm loss: 7.314539E+00 | loss scale: 131072.0 | grad norm: 0.230 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 361.89 | backward-compute: 243.65 | backward-params-all-reduce: 1884.49 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.62 | optimizer-clip-main-grad: 4.06 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 92.69 | batch-generator: 2.15
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 118259 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 90225 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 68501 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 131653 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1772586 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1772685 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1923532 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1923634 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1852998 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1853132 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1990464 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1990596 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       67/     100 | consumed samples:        12864 | elapsed time per iteration (ms): 2562.9 | learning rate: 1.505E-05 | global batch size:   192 | lm loss: 7.355127E+00 | loss scale: 131072.0 | grad norm: 0.222 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 358.82 | backward-compute: 298.73 | backward-params-all-reduce: 1817.02 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.59 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 85.72 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 70972 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 112387 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 50133 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 155912 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1881958 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1882057 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1773488 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1773629 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1839786 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1839913 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1911057 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1911186 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       68/     100 | consumed samples:        13056 | elapsed time per iteration (ms): 2604.0 | learning rate: 1.289E-05 | global batch size:   192 | lm loss: 7.325490E+00 | loss scale: 131072.0 | grad norm: 0.219 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 397.84 | backward-compute: 188.23 | backward-params-all-reduce: 1884.97 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.29 | optimizer-unscale-and-check-inf: 43.71 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 130.53 | batch-generator: 2.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 70374 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 28970 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 28077 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 16655 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1910404 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1910532 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1699422 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1699649 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1880110 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1880245 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1836159 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1836260 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       69/     100 | consumed samples:        13248 | elapsed time per iteration (ms): 2448.0 | learning rate: 1.088E-05 | global batch size:   192 | lm loss: 7.293809E+00 | loss scale: 131072.0 | grad norm: 0.210 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 228.98 | backward-compute: 343.41 | backward-params-all-reduce: 1774.36 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 45.79 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 98.55 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 50611 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 18279 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 86759 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 59889 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1895873 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1895970 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1947810 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1947947 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1971480 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1971578 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1922678 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1922814 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       70/     100 | consumed samples:        13440 | elapsed time per iteration (ms): 2516.0 | learning rate: 9.032E-06 | global batch size:   192 | lm loss: 7.308636E+00 | loss scale: 131072.0 | grad norm: 0.198 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 293.98 | backward-compute: 171.78 | backward-params-all-reduce: 1925.65 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 33.10 | optimizer-unscale-and-check-inf: 5.72 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 98.45 | batch-generator: 2.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 89583 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 70 | lm loss value: 7.774359E+00 | lm loss PPL: 2.378819E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 57666 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 56422 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 103039 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 66308 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 69047 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 49081 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 54401 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1840933 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1841110 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1760167 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1760304 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1811435 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1811537 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1874035 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1874137 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       71/     100 | consumed samples:        13632 | elapsed time per iteration (ms): 2644.1 | learning rate: 7.345E-06 | global batch size:   192 | lm loss: 7.313299E+00 | loss scale: 131072.0 | grad norm: 0.203 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 469.21 | backward-compute: 226.54 | backward-params-all-reduce: 1864.95 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 25.70 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 78.66 | batch-generator: 3.80
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 172945 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 134333 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 98498 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 134893 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1749609 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1749770 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1706187 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1706314 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1663231 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1663329 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1785043 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1785141 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       72/     100 | consumed samples:        13824 | elapsed time per iteration (ms): 2443.9 | learning rate: 5.823E-06 | global batch size:   192 | lm loss: 7.313953E+00 | loss scale: 131072.0 | grad norm: 0.209 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 317.63 | backward-compute: 167.21 | backward-params-all-reduce: 1842.21 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 33.79 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 114.56 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 120296 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 159936 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 143562 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 133918 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1870155 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1870253 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1788792 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1788919 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1941023 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1941127 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1870315 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1870515 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       73/     100 | consumed samples:        14016 | elapsed time per iteration (ms): 2572.1 | learning rate: 4.472E-06 | global batch size:   192 | lm loss: 7.299714E+00 | loss scale: 131072.0 | grad norm: 0.199 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 330.37 | backward-compute: 148.22 | backward-params-all-reduce: 1992.62 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 25.63 | optimizer-clip-main-grad: 4.16 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 98.66 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 39249 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 28810 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 16113 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 47365 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1778136 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1778288 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1731497 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1731623 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1758337 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1758439 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1692331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1692477 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       74/     100 | consumed samples:        14208 | elapsed time per iteration (ms): 2307.9 | learning rate: 3.295E-06 | global batch size:   192 | lm loss: 7.315882E+00 | loss scale: 131072.0 | grad norm: 0.198 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 196.35 | backward-compute: 181.43 | backward-params-all-reduce: 1841.08 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 12.17 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 86.54 | batch-generator: 2.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000060000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 122453 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 139145 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 131059 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 165355 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1814754 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1814852 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1845879 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1845978 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1889451 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1889583 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1918344 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1918476 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       75/     100 | consumed samples:        14400 | elapsed time per iteration (ms): 2580.0 | learning rate: 2.293E-06 | global batch size:   192 | lm loss: 7.307744E+00 | loss scale: 131072.0 | grad norm: 0.253 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 360.36 | backward-compute: 226.43 | backward-params-all-reduce: 1841.10 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 52.07 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 126.52 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 22401 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 7948 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 34925 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 11488 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1829808 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1829906 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1910429 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1910563 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1886855 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1886953 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1982728 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1982903 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       76/     100 | consumed samples:        14592 | elapsed time per iteration (ms): 2492.0 | learning rate: 1.470E-06 | global batch size:   192 | lm loss: 7.296934E+00 | loss scale: 131072.0 | grad norm: 0.179 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 185.47 | backward-compute: 258.66 | backward-params-all-reduce: 1871.11 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 13.85 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 122.58 | batch-generator: 2.02
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000048000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 99923 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 131028 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 10364 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 100277 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1778565 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1778663 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1736426 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1736577 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1748306 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1748443 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1848370 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1848473 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       77/     100 | consumed samples:        14784 | elapsed time per iteration (ms): 2371.9 | learning rate: 8.282E-07 | global batch size:   192 | lm loss: 7.305716E+00 | loss scale: 131072.0 | grad norm: 0.180 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 310.04 | backward-compute: 147.85 | backward-params-all-reduce: 1844.77 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 30.30 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 67.02 | batch-generator: 1.96
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 60987 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 73145 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 107715 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 8596 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1774149 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1774247 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1735019 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1735256 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1836835 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1836960 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1791390 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1791492 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       78/     100 | consumed samples:        14976 | elapsed time per iteration (ms): 2478.0 | learning rate: 3.685E-07 | global batch size:   192 | lm loss: 7.314735E+00 | loss scale: 131072.0 | grad norm: 0.186 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 333.75 | backward-compute: 167.25 | backward-params-all-reduce: 1866.25 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 33.69 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 46.34 | optimizer: 108.44 | batch-generator: 52.63
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 30150 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 77214 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 86529 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 57461 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1822932 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1823049 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1859302 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1859433 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1901145 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1901243 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1843448 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1843569 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       79/     100 | consumed samples:        15168 | elapsed time per iteration (ms): 2500.1 | learning rate: 9.217E-08 | global batch size:   192 | lm loss: 7.331884E+00 | loss scale: 131072.0 | grad norm: 0.207 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 259.64 | backward-compute: 187.82 | backward-params-all-reduce: 1893.95 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 11.98 | optimizer-unscale-and-check-inf: 5.63 | optimizer-clip-main-grad: 38.54 | optimizer-copy-main-to-model-params: 82.08 | optimizer: 156.33 | batch-generator: 2.10
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 38111 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 8290 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 22024 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 136294 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 2151645 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 2151774 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2107278 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2107409 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2078954 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2079063 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 2052912 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 2053028 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       80/     100 | consumed samples:        15360 | elapsed time per iteration (ms): 2730.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.298370E+00 | loss scale: 131072.0 | grad norm: 0.191 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 255.66 | backward-compute: 230.20 | backward-params-all-reduce: 2107.25 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 41.71 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 134.49 | batch-generator: 2.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 88206 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 114263 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 105346 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 84875 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 80 | lm loss value: 7.779095E+00 | lm loss PPL: 2.390110E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000063000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 168695 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 160930 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 207092 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 201266 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1871088 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1871211 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1835376 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1835519 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1807419 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1807523 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1743463 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1743689 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       81/     100 | consumed samples:        15552 | elapsed time per iteration (ms): 2757.4 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.309465E+00 | loss scale: 131072.0 | grad norm: 0.203 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 556.86 | backward-compute: 169.64 | backward-params-all-reduce: 1904.80 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 14.93 | optimizer-unscale-and-check-inf: 46.84 | optimizer-clip-main-grad: 15.65 | optimizer-copy-main-to-model-params: 25.98 | optimizer: 121.43 | batch-generator: 2.45
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 164369 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 65079 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 56137 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 4961 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1863149 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1863246 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1768036 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1768162 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1814969 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1815095 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1841300 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1841400 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       82/     100 | consumed samples:        15744 | elapsed time per iteration (ms): 2518.5 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.341008E+00 | loss scale: 131072.0 | grad norm: 0.180 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 309.45 | backward-compute: 190.52 | backward-params-all-reduce: 1908.82 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 42.50 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 107.27 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 50381 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 29246 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 39688 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 28034 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1992839 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1992937 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1878419 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1878520 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1830145 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1830281 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1948427 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1948604 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       83/     100 | consumed samples:        15936 | elapsed time per iteration (ms): 2504.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.321951E+00 | loss scale: 131072.0 | grad norm: 0.203 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 186.22 | backward-compute: 148.06 | backward-params-all-reduce: 2034.90 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 37.35 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 102.13 | batch-generator: 1.97
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000057000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 177635 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 159418 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 201201 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 224614 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1782593 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1782690 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1880542 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1880666 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1895115 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1895243 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1875842 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1875941 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
 iteration       84/     100 | consumed samples:        16128 | elapsed time per iteration (ms): 2572.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.313368E+00 | loss scale: 131072.0 | grad norm: 0.189 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 429.65 | backward-compute: 220.30 | backward-params-all-reduce: 1828.85 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 30.43 | optimizer-unscale-and-check-inf: 5.69 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 78.99 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 81327 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 82417 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 15446 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 38727 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1599150 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1599247 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1752362 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1752716 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1631501 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1631622 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1711152 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1711302 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       85/     100 | consumed samples:        16320 | elapsed time per iteration (ms): 2362.2 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.306476E+00 | loss scale: 131072.0 | grad norm: 0.177 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 254.89 | backward-compute: 174.09 | backward-params-all-reduce: 1858.36 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 37.60 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 72.62 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 32048 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 62981 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 3395 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 62101 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1796397 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1796495 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1754447 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1754545 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1852326 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1852461 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1823375 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1823520 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       86/     100 | consumed samples:        16512 | elapsed time per iteration (ms): 2369.8 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.327464E+00 | loss scale: 131072.0 | grad norm: 0.211 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 263.68 | backward-compute: 232.60 | backward-params-all-reduce: 1792.63 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 37.62 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 78.53 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 81618 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 61972 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 59401 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 28003 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1691589 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1691803 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1606305 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1606442 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1670995 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1671094 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1577842 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1577968 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       87/     100 | consumed samples:        16704 | elapsed time per iteration (ms): 2325.6 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.322574E+00 | loss scale: 131072.0 | grad norm: 0.194 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 247.83 | backward-compute: 149.14 | backward-params-all-reduce: 1798.58 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 57.31 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 127.77 | batch-generator: 2.12
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 53183 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 43169 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 54196 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 74796 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1806730 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1806826 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1831416 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1831545 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1882742 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1882840 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1816892 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1817027 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
 iteration       88/     100 | consumed samples:        16896 | elapsed time per iteration (ms): 2410.3 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.296597E+00 | loss scale: 131072.0 | grad norm: 0.198 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 265.10 | backward-compute: 150.35 | backward-params-all-reduce: 1882.28 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 17.65 | optimizer-clip-main-grad: 6.94 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 110.41 | batch-generator: 12.19
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000095000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 39939 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 48093 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 15042 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 5987 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1557946 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1558048 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1541248 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1541365 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1524306 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1524439 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1476504 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1476637 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       89/     100 | consumed samples:        17088 | elapsed time per iteration (ms): 2176.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.308100E+00 | loss scale: 131072.0 | grad norm: 0.194 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 239.73 | backward-compute: 180.45 | backward-params-all-reduce: 1588.32 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 7.00 | optimizer-unscale-and-check-inf: 46.69 | optimizer-clip-main-grad: 4.56 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 148.33 | batch-generator: 2.10
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 75900 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 193454 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 8399 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 168497 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1778560 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1778681 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1674383 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1674515 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1715855 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1715954 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1849258 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1849354 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       90/     100 | consumed samples:        17280 | elapsed time per iteration (ms): 2480.5 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.320272E+00 | loss scale: 131072.0 | grad norm: 0.197 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 286.28 | backward-compute: 174.65 | backward-params-all-reduce: 1879.32 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 38.97 | optimizer-unscale-and-check-inf: 5.70 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 137.87 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 136938 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 159005 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 14360 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 107361 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
----------------------------------------------------------------------------------------------
 validation loss at iteration 90 | lm loss value: 7.777882E+00 | lm loss PPL: 2.387212E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 58871 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 41219 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 22793 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 36978 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1630307 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1630404 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1668734 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1668834 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1725324 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1725454 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1698068 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1698219 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       91/     100 | consumed samples:        17472 | elapsed time per iteration (ms): 2552.9 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.346004E+00 | loss scale: 131072.0 | grad norm: 0.194 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 477.42 | backward-compute: 177.87 | backward-params-all-reduce: 1735.89 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 42.73 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 85.76 | optimizer: 156.86 | batch-generator: 2.62
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 68223 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 30573 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 47402 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 74576 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1810576 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1810681 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1778708 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1778885 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1823196 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1823311 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1859040 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1859173 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       92/     100 | consumed samples:        17664 | elapsed time per iteration (ms): 2358.6 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.292135E+00 | loss scale: 131072.0 | grad norm: 0.204 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 205.43 | backward-compute: 182.14 | backward-params-all-reduce: 1858.02 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 25.72 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 110.54 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 101406 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 126627 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 89177 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 162682 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1821495 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1821624 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1681020 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1681118 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1773417 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1773514 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1810300 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1810421 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       93/     100 | consumed samples:        17856 | elapsed time per iteration (ms): 2436.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.301465E+00 | loss scale: 131072.0 | grad norm: 0.187 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 295.62 | backward-compute: 215.95 | backward-params-all-reduce: 1827.45 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.67 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 94.54 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 60330 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 121728 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 60600 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 20501 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1913078 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1913210 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1899242 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1899342 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1817306 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1817493 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1862702 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1862839 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       94/     100 | consumed samples:        18048 | elapsed time per iteration (ms): 2416.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.309344E+00 | loss scale: 131072.0 | grad norm: 0.196 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 249.48 | backward-compute: 175.48 | backward-params-all-reduce: 1922.97 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 15.21 | optimizer-unscale-and-check-inf: 5.69 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 65.82 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 72301 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 100444 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 108737 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 77742 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1808276 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1808397 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1757916 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1758013 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1885280 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1885377 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1811584 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1811712 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
 iteration       95/     100 | consumed samples:        18240 | elapsed time per iteration (ms): 2412.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.342716E+00 | loss scale: 131072.0 | grad norm: 0.213 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 266.11 | backward-compute: 224.98 | backward-params-all-reduce: 1780.19 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 33.80 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 98.52 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 2925 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98350 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 82724 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 103161 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1844742 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1844840 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1821632 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1821752 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1769326 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1769423 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1858462 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1858588 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       96/     100 | consumed samples:        18432 | elapsed time per iteration (ms): 2496.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.313468E+00 | loss scale: 131072.0 | grad norm: 0.186 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 308.00 | backward-compute: 219.23 | backward-params-all-reduce: 1871.70 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 53.67 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 94.54 | batch-generator: 2.11
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 40763 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 43907 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 28271 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 70821 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1803248 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1803410 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1726604 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1726731 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1695753 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1695854 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1779398 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1779548 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       97/     100 | consumed samples:        18624 | elapsed time per iteration (ms): 2316.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.324044E+00 | loss scale: 131072.0 | grad norm: 0.183 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 233.49 | backward-compute: 163.49 | backward-params-all-reduce: 1810.92 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 51.08 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.61 | optimizer: 105.84 | batch-generator: 0.72
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 83232 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 58660 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 46417 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 79419 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1598749 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1598930 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1625135 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1625255 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1643501 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1643599 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1668956 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1669063 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       98/     100 | consumed samples:        18816 | elapsed time per iteration (ms): 2236.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.333560E+00 | loss scale: 131072.0 | grad norm: 0.205 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 218.83 | backward-compute: 202.37 | backward-params-all-reduce: 1706.04 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 44.11 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 94.58 | batch-generator: 0.69
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 26287 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 50059 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 6265 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 38781 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1719798 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1719921 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1819272 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1819461 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1785257 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1785450 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1802317 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1802419 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       99/     100 | consumed samples:        19008 | elapsed time per iteration (ms): 2344.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.317745E+00 | loss scale: 131072.0 | grad norm: 0.189 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 223.67 | backward-compute: 165.31 | backward-params-all-reduce: 1850.33 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 53.60 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.61 | optimizer: 102.44 | batch-generator: 0.69
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 121044 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 85795 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 103964 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 101554 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1436772 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1436871 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1357795 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1357901 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1451284 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1451434 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1388234 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1388361 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration      100/     100 | consumed samples:        19200 | elapsed time per iteration (ms): 1980.1 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.316997E+00 | loss scale: 131072.0 | grad norm: 0.181 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 271.43 | backward-compute: 148.02 | backward-params-all-reduce: 1445.27 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 26.78 | optimizer-unscale-and-check-inf: 5.66 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 77.07 | batch-generator: 0.67
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 108744 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 89241 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 131999 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 106447 us
-----------------------------------------------------------------------------------------------
 validation loss at iteration 100 | lm loss value: 7.768998E+00 | lm loss PPL: 2.366100E+03 | 
-----------------------------------------------------------------------------------------------
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 12524 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 48978 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 68184 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 32881 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4