x3003c0s31b0n0:61298:61298 [3] NCCL INFO cudaDriverVersion 11040
x3003c0s31b0n0:61297:61297 [2] NCCL INFO cudaDriverVersion 11040
x3003c0s31b0n0:61296:61296 [1] NCCL INFO cudaDriverVersion 11040
x3003c0s31b0n0:61295:61295 [0] NCCL INFO cudaDriverVersion 11040
x3003c0s31b0n0:61297:61297 [2] NCCL INFO Bootstrap : Using hsn0:10.201.1.146<0>
x3003c0s31b0n0:61295:61295 [0] NCCL INFO Bootstrap : Using hsn0:10.201.1.146<0>
x3003c0s31b0n0:61296:61296 [1] NCCL INFO Bootstrap : Using hsn0:10.201.1.146<0>
x3003c0s31b0n0:61298:61298 [3] NCCL INFO Bootstrap : Using hsn0:10.201.1.146<0>
x3003c0s31b0n0:61297:61297 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3003c0s31b0n0:61295:61295 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3003c0s31b0n0:61296:61296 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3003c0s31b0n0:61298:61298 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3003c0s31b0n0:61297:62798 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.146<0>
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Using network IB
x3003c0s31b0n0:61296:62800 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.146<0>
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Using network IB
x3003c0s31b0n0:61295:62799 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.146<0>
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Using network IB
x3003c0s31b0n0:61298:62803 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.146<0>
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Using network IB
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Trees [0] 14/-1/-1->13->12 [1] 14/-1/-1->13->12 [2] 14/-1/-1->13->12 [3] 14/-1/-1->13->12
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Trees [0] 15/-1/-1->14->13 [1] 15/-1/-1->14->13 [2] 15/-1/-1->14->13 [3] 15/-1/-1->14->13
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 00/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Trees [0] -1/-1/-1->15->14 [1] -1/-1/-1->15->14 [2] -1/-1/-1->15->14 [3] -1/-1/-1->15->14
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 00/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 01/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 01/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 02/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Trees [0] 13/-1/-1->12->8 [1] 13/-1/-1->12->8 [2] 13/4/-1->12->-1 [3] 13/4/-1->12->-1
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 00/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 02/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 03/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 01/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 03/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 02/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 03/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 00/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 01/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 02/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 03/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 00/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 01/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 02/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 03/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 00/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 01/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 02/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Channel 03/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 00/0 : 8[7000] -> 12[7000] [receive] via NET/IB/1
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 01/0 : 8[7000] -> 12[7000] [receive] via NET/IB/0
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 00/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 01/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 02/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Channel 03/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:62798 [2] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61297:62798 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61297:62798 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61298:62803 [3] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61298:62803 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61298:62803 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61296:62800 [1] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61296:62800 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61296:62800 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 02/0 : 4[7000] -> 12[7000] [receive] via NET/IB/1
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 03/0 : 4[7000] -> 12[7000] [receive] via NET/IB/0
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 02/0 : 12[7000] -> 4[7000] [send] via NET/IB/1
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 03/0 : 12[7000] -> 4[7000] [send] via NET/IB/0
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 00/0 : 12[7000] -> 8[7000] [send] via NET/IB/1
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Channel 01/0 : 12[7000] -> 8[7000] [send] via NET/IB/0
x3003c0s31b0n0:61295:62799 [0] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61295:62799 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61295:62799 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61298:62803 [3] NCCL INFO comm 0x55ea71333630 rank 15 nranks 16 cudaDev 3 busId c7000 - Init COMPLETE
x3003c0s31b0n0:61297:62798 [2] NCCL INFO comm 0x564f5d3178f0 rank 14 nranks 16 cudaDev 2 busId 85000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4x3003c0s31b0n0:61296:62800 [1] NCCL INFO comm 0x55b7a96f4a50 rank 13 nranks 16 cudaDev 1 busId 46000 - Init COMPLETE
x3003c0s31b0n0:61295:62799 [0] NCCL INFO comm 0x55dc5e3eb610 rank 12 nranks 16 cudaDev 0 busId 7000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 1265672 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 1204724 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 1240312 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 1282744 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 3086918 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 2764914 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 2756505 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 2749042 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce TREE LL Min double Elapsed time: 18724 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum double Elapsed time: 37769 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce TREE LL Min double Elapsed time: 4 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum double Elapsed time: 27735 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce TREE LL Min double Elapsed time: 6 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum double Elapsed time: 19095 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce TREE LL Min double Elapsed time: 9 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum double Elapsed time: 10794 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 51507 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 42141 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 32895 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 57902 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 108023 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 144118 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 110227 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 180928 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 72730 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 61132 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 40096 us
time (ms) | load-checkpoint: 75.81
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 23316 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 60331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 66870 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 34129 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 22590 us
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Using network IB
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Using network IB
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Using network IB
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Using network IB
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Trees [0] 15/-1/-1->14->13 [1] 15/-1/-1->14->13 [2] 15/-1/-1->14->13 [3] 15/-1/-1->14->13
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 00/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Trees [0] -1/-1/-1->15->14 [1] -1/-1/-1->15->14 [2] -1/-1/-1->15->14 [3] -1/-1/-1->15->14
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Trees [0] 13/-1/-1->12->8 [1] 13/-1/-1->12->8 [2] 13/4/-1->12->-1 [3] 13/4/-1->12->-1
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 00/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 01/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 01/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Trees [0] 14/-1/-1->13->12 [1] 14/-1/-1->13->12 [2] 14/-1/-1->13->12 [3] 14/-1/-1->13->12
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 02/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 02/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 00/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 03/0 : 14[85000] -> 15[c7000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 03/0 : 12[7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 01/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 02/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/1
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 03/0 : 11[c7000] -> 13[46000] [receive] via NET/IB/0
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 1[46000] [send] via NET/IB/1
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 1[46000] [send] via NET/IB/0
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 00/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 01/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 00/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 02/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 01/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Channel 03/0 : 15[c7000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 02/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 03/0 : 13[46000] -> 12[7000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 00/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 01/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 02/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 03/0 : 12[7000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 00/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 01/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 02/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Channel 03/0 : 13[46000] -> 14[85000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 00/0 : 8[7000] -> 12[7000] [receive] via NET/IB/1
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 01/0 : 8[7000] -> 12[7000] [receive] via NET/IB/0
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 00/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 01/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 02/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Channel 03/0 : 14[85000] -> 13[46000] via P2P/IPC/read
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 02/0 : 4[7000] -> 12[7000] [receive] via NET/IB/1
x3003c0s31b0n0:61297:65318 [2] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61297:65318 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61297:65318 [2] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61298:65307 [3] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61298:65307 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61298:65307 [3] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61296:65316 [1] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61296:65316 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61296:65316 [1] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 03/0 : 4[7000] -> 12[7000] [receive] via NET/IB/0
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 02/0 : 12[7000] -> 4[7000] [send] via NET/IB/1
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 03/0 : 12[7000] -> 4[7000] [send] via NET/IB/0
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 00/0 : 12[7000] -> 8[7000] [send] via NET/IB/1
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Channel 01/0 : 12[7000] -> 8[7000] [send] via NET/IB/0
x3003c0s31b0n0:61295:65317 [0] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61295:65317 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 512 | 512
x3003c0s31b0n0:61295:65317 [0] NCCL INFO 4 coll channels, 4 p2p channels, 2 p2p channels per peer
x3003c0s31b0n0:61298:65307 [3] NCCL INFO comm 0x55ea77525480 rank 15 nranks 16 cudaDev 3 busId c7000 - Init COMPLETE
x3003c0s31b0n0:61296:65316 [1] NCCL INFO comm 0x55b7c36336f0 rank 13 nranks 16 cudaDev 1 busId 46000 - Init COMPLETE
x3003c0s31b0n0:61297:65318 [2] NCCL INFO comm 0x564f7f015cc0 rank 14 nranks 16 cudaDev 2 busId 85000 - Init COMPLETE
x3003c0s31b0n0:61295:65317 [0] NCCL INFO comm 0x55dc796e0ab0 rank 12 nranks 16 cudaDev 0 busId 7000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4NCCL version 2.14.3+cuda11.8
x3003c0s31b0n0:61298:699 [3] NCCL INFO Using network IB
x3003c0s31b0n0:61296:701 [1] NCCL INFO Using network IB
x3003c0s31b0n0:61295:703 [0] NCCL INFO Using network IB
x3003c0s31b0n0:61297:706 [2] NCCL INFO Using network IB
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61296:701 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61296:701 [1] NCCL INFO Connected all rings
x3003c0s31b0n0:61296:701 [1] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61296:701 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61298:699 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61298:699 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61298:699 [3] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:699 [3] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61298:699 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61295:703 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61297:706 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61295:703 [0] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:703 [0] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61295:703 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61297:706 [2] NCCL INFO Connected all rings
x3003c0s31b0n0:61297:706 [2] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61297:706 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61298:699 [3] NCCL INFO comm 0x55ea77528930 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
x3003c0s31b0n0:61296:701 [1] NCCL INFO comm 0x55b7c4029030 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
x3003c0s31b0n0:61297:706 [2] NCCL INFO comm 0x564f7d363820 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
x3003c0s31b0n0:61295:703 [0] NCCL INFO comm 0x55dc796e4240 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum int64_t Elapsed time: 1329942 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum int64_t Elapsed time: 1347812 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum int64_t Elapsed time: 1376763 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum int64_t Elapsed time: 1352502 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum int64_t Elapsed time: 593332 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum int64_t Elapsed time: 610345 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum int64_t Elapsed time: 599227 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum int64_t Elapsed time: 589348 us
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Using network IB
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Using network IB
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Using network IB
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Using network IB
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Connected all rings
x3003c0s31b0n0:61297:1255 [2] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61297:1255 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Connected all rings
x3003c0s31b0n0:61296:1257 [1] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61296:1257 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:1253 [3] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61298:1253 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:1259 [0] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61295:1259 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61297:1255 [2] NCCL INFO comm 0x564f7d369440 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3003c0s31b0n0:61296:1257 [1] NCCL INFO comm 0x55b7c361dea0 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3003c0s31b0n0:61298:1253 [3] NCCL INFO comm 0x55ea77e450a0 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
x3003c0s31b0n0:61295:1259 [0] NCCL INFO comm 0x55dc796ea330 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 10432 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 220286 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 167071 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 104841 us
time (ms) | model-and-optimizer-setup: 933.49 | train/valid/test-data-iterators-setup: 23092.89
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 99685 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 4988 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 88288 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 96926 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 167017 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 152029 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 203165 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 153791 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1750142 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1750240 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1728647 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1728800 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1718880 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1718982 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1634927 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1635112 us
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Using network IB
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Using network IB
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Using network IB
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Using network IB
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Connected all rings
x3003c0s31b0n0:61295:3043 [0] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61295:3043 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Setting affinity for GPU 3 to 01
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Connected all rings
x3003c0s31b0n0:61298:3041 [3] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61298:3041 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Connected all rings
x3003c0s31b0n0:61297:3045 [2] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61297:3045 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 00/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 01/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 02/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 03/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 04/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 05/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 06/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 07/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 08/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 09/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 10/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 11/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 12/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 13/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 14/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 15/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 16/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 17/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 18/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 19/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 20/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 21/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 22/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 23/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 24/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 25/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 26/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 27/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 28/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 29/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 30/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Channel 31/32 :    0
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Connected all rings
x3003c0s31b0n0:61296:3047 [1] NCCL INFO Connected all trees by HAO
x3003c0s31b0n0:61296:3047 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3003c0s31b0n0:61296:3047 [1] NCCL INFO comm 0x55b7f87962b0 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
x3003c0s31b0n0:61295:3043 [0] NCCL INFO comm 0x55dcadfc26a0 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
x3003c0s31b0n0:61297:3045 [2] NCCL INFO comm 0x564fb1d26b10 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
x3003c0s31b0n0:61298:3041 [3] NCCL INFO comm 0x55eaaca7a990 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration        1/     100 | consumed samples:          192 | elapsed time per iteration (ms): 8313.7 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 4294967296.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 3556.42 | backward-compute: 2098.51 | backward-params-all-reduce: 1715.81 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 806.27 | optimizer: 812.59 | batch-generator: 2.85
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 159390 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 193610 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 187971 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 13626 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1457661 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1457790 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1503382 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1503476 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1533990 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1534097 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1492437 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1492536 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration        2/     100 | consumed samples:          384 | elapsed time per iteration (ms): 2081.3 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 2147483648.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 318.09 | backward-compute: 202.31 | backward-params-all-reduce: 1497.27 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 6.23 | optimizer-unscale-and-check-inf: 54.94 | optimizer: 61.31 | batch-generator: 2.10
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 115736 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 103832 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 61204 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 114315 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1776263 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1776394 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1884596 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1884693 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        3/     100 | consumed samples:          576 | elapsed time per iteration (ms): 2321.8 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 1073741824.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 295.50 | backward-compute: 188.17 | backward-params-all-reduce: 1787.72 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 41.89 | optimizer: 48.27 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1872387 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1872484 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1854635 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1854738 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 572 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 11389 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 73425 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 38611 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1843811 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1843914 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1815576 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1815676 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1678227 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1678321 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1775516 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1775667 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration        4/     100 | consumed samples:          768 | elapsed time per iteration (ms): 2317.3 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 536870912.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 261.27 | backward-compute: 184.55 | backward-params-all-reduce: 1809.18 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 53.73 | optimizer: 60.09 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 155987 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 156798 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 148570 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 163492 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1882592 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1882697 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1922590 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1922690 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1985891 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1986003 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 2012266 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 2012454 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration        5/     100 | consumed samples:          960 | elapsed time per iteration (ms): 2548.8 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 268435456.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 284.30 | backward-compute: 159.20 | backward-params-all-reduce: 2042.02 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 54.45 | optimizer: 61.08 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 57008 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 67731 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 33241 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 58789 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1732831 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1732928 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1886491 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1886596 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2039928 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2040046 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1991628 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1991814 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        6/     100 | consumed samples:         1152 | elapsed time per iteration (ms): 2487.2 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 134217728.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 221.61 | backward-compute: 196.89 | backward-params-all-reduce: 2030.61 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 29.39 | optimizer: 35.74 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 7241 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 16216 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 65286 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 91483 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1577296 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1577396 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1667776 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1667903 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1681430 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1681525 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1716912 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1717009 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration        7/     100 | consumed samples:         1344 | elapsed time per iteration (ms): 2184.1 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 67108864.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 302.25 | backward-compute: 165.44 | backward-params-all-reduce: 1684.74 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 23.17 | optimizer: 29.52 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 86319 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 3684 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 76321 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 20759 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1864118 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1864217 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1804437 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1804531 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1839276 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1839373 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1797654 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1797782 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration        8/     100 | consumed samples:         1536 | elapsed time per iteration (ms): 2343.8 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 33554432.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 259.95 | backward-compute: 201.77 | backward-params-all-reduce: 1847.86 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 25.70 | optimizer: 32.08 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 12978 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 34916 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 61964 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 106299 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1385802 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1385932 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1426973 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1427073 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1475487 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1475583 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1458169 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1458267 us
 iteration        9/     100 | consumed samples:         1728 | elapsed time per iteration (ms): 1944.4 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 16777216.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 304.80 | backward-compute: 216.48 | backward-params-all-reduce: 1408.29 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.60 | optimizer-unscale-and-check-inf: 6.00 | optimizer: 12.70 | batch-generator: 2.09
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 134336 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 130585 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 128697 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 117762 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1811688 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1811815 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1761457 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1761556 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1889581 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1889725 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1838469 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1838565 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       10/     100 | consumed samples:         1920 | elapsed time per iteration (ms): 2515.6 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 8388608.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 283.55 | backward-compute: 253.54 | backward-params-all-reduce: 1865.78 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 53.38 | optimizer: 59.74 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000064000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 200448 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 10 | lm loss value: 1.105502E+01 | lm loss PPL: 6.326087E+04 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 233485 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 242063 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 222675 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 45498 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 76411 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 56705 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 41659 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1842405 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1842561 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1752459 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1752561 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1664593 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1664689 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1811743 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1811889 us
 iteration       11/     100 | consumed samples:         2112 | elapsed time per iteration (ms): 3436.4 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 4194304.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 1304.16 | backward-compute: 180.51 | backward-params-all-reduce: 1907.95 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 32.49 | optimizer: 38.84 | batch-generator: 3.94
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 184409 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 92382 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 92880 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 131031 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1370941 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1371040 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1415923 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1416050 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1302252 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1302347 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1468061 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1468187 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       12/     100 | consumed samples:         2304 | elapsed time per iteration (ms): 2033.7 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 2097152.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 314.11 | backward-compute: 176.94 | backward-params-all-reduce: 1504.47 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 14.95 | optimizer-unscale-and-check-inf: 20.88 | optimizer: 35.95 | batch-generator: 16.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 64847 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 55810 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 70811 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 66061 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1891086 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1891213 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1766266 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1766369 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1845365 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1845460 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1819837 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1819935 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       13/     100 | consumed samples:         2496 | elapsed time per iteration (ms): 2369.2 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 1048576.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 199.83 | backward-compute: 181.52 | backward-params-all-reduce: 1921.56 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 57.76 | optimizer: 64.13 | batch-generator: 1.92
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 60378 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 90115 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 50083 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 57490 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1855396 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1855500 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1880395 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1880493 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1873987 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1874102 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1811695 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1811839 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       14/     100 | consumed samples:         2688 | elapsed time per iteration (ms): 2404.7 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 524288.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 267.82 | backward-compute: 192.59 | backward-params-all-reduce: 1909.97 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 25.79 | optimizer: 32.16 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 108567 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 75815 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 64174 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 27805 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1795471 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1795646 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1746621 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1746723 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1747592 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1747690 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1699472 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1699616 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       15/     100 | consumed samples:         2880 | elapsed time per iteration (ms): 2403.9 | learning rate: 0.000E+00 | global batch size:   192 | loss scale: 262144.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 247.31 | backward-compute: 176.15 | backward-params-all-reduce: 1926.29 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 45.70 | optimizer: 52.05 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 68671 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 53483 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 66344 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 13800 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1862451 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1862553 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1813864 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1814023 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1855128 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1855234 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1831353 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1831452 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       16/     100 | consumed samples:         3072 | elapsed time per iteration (ms): 2395.3 | learning rate: 1.500E-04 | global batch size:   192 | lm loss: 1.107613E+01 | loss scale: 262144.0 | grad norm: 35.738 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 247.86 | backward-compute: 197.91 | backward-params-all-reduce: 1827.78 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.53 | optimizer-clip-main-grad: 63.29 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 119.36 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 199422 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 123299 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 110712 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 191080 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1854223 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1854321 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1802490 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1802654 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1714084 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1714186 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1774886 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1775013 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       17/     100 | consumed samples:         3264 | elapsed time per iteration (ms): 2627.2 | learning rate: 1.498E-04 | global batch size:   192 | lm loss: 1.107726E+01 | loss scale: 262144.0 | grad norm: 36.024 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 407.11 | backward-compute: 209.42 | backward-params-all-reduce: 1853.11 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.58 | optimizer-clip-main-grad: 61.25 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 154.66 | batch-generator: 1.90
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 20914 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 33820 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 32335 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 5492 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1781084 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1781184 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1842279 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1842451 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1759069 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1759310 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1693334 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1693438 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       18/     100 | consumed samples:         3456 | elapsed time per iteration (ms): 2226.6 | learning rate: 1.498E-04 | global batch size:   192 | loss scale: 131072.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 157.73 | backward-compute: 147.77 | backward-params-all-reduce: 1857.52 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 54.89 | optimizer-clip-main-grad: 0.00 | optimizer-copy-main-to-model-params: 0.00 | optimizer: 61.24 | batch-generator: 2.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 42655 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 72345 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 103168 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 61554 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1284072 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1284176 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1211498 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1211700 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1272514 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1272616 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1240130 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1240229 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       19/     100 | consumed samples:         3648 | elapsed time per iteration (ms): 1877.4 | learning rate: 1.495E-04 | global batch size:   192 | lm loss: 9.717583E+00 | loss scale: 131072.0 | grad norm: 13.507 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 270.47 | backward-compute: 192.13 | backward-params-all-reduce: 1278.46 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 6.96 | optimizer-clip-main-grad: 47.35 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 134.13 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 185291 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 204847 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 178846 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 30913 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1762271 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1762374 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1678751 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1678851 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1736942 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1792486 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1792641 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1737072 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       20/     100 | consumed samples:         3840 | elapsed time per iteration (ms): 2427.8 | learning rate: 1.490E-04 | global batch size:   192 | lm loss: 1.044656E+01 | loss scale: 131072.0 | grad norm: 6.151 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 345.54 | backward-compute: 155.28 | backward-params-all-reduce: 1822.28 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 45.55 | optimizer-clip-main-grad: 9.23 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 102.37 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000058000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 166522 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 182997 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 140954 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 226118 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 20 | lm loss value: 9.542729E+00 | lm loss PPL: 1.394295E+04 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 46559 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 49875 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 31928 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 8792 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1891433 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1891563 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1850162 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1850256 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1838769 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1838866 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1998210 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1998309 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
 iteration       21/     100 | consumed samples:         4032 | elapsed time per iteration (ms): 2804.5 | learning rate: 1.483E-04 | global batch size:   192 | lm loss: 9.612200E+00 | loss scale: 131072.0 | grad norm: 2.992 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 606.73 | backward-compute: 164.31 | backward-params-all-reduce: 1905.73 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 55.84 | optimizer-unscale-and-check-inf: 5.70 | optimizer-clip-main-grad: 9.21 | optimizer-copy-main-to-model-params: 6.61 | optimizer: 122.94 | batch-generator: 3.87
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000060000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 96098 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 52906 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 135662 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 41617 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1831735 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1831829 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1733671 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1733806 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1783512 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1783610 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1765732 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1765831 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       22/     100 | consumed samples:         4224 | elapsed time per iteration (ms): 2451.5 | learning rate: 1.474E-04 | global batch size:   192 | lm loss: 9.266836E+00 | loss scale: 131072.0 | grad norm: 2.420 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 365.67 | backward-compute: 212.62 | backward-params-all-reduce: 1756.80 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 12.82 | optimizer-clip-main-grad: 23.51 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 114.02 | batch-generator: 2.02
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 38092 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 14188 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 66426 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 76566 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1920130 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1920256 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1972262 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1972363 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2028527 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2028628 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1713034 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1713134 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       23/     100 | consumed samples:         4416 | elapsed time per iteration (ms): 2575.3 | learning rate: 1.463E-04 | global batch size:   192 | lm loss: 8.976410E+00 | loss scale: 131072.0 | grad norm: 2.362 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 255.88 | backward-compute: 229.22 | backward-params-all-reduce: 1929.76 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 15.28 | optimizer-unscale-and-check-inf: 5.67 | optimizer-clip-main-grad: 55.91 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 157.62 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 110331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 62196 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 53873 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 20844 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1712875 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1712977 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1814099 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1814240 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1776715 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1776814 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1759505 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1759686 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       24/     100 | consumed samples:         4608 | elapsed time per iteration (ms): 2340.8 | learning rate: 1.451E-04 | global batch size:   192 | lm loss: 8.740615E+00 | loss scale: 131072.0 | grad norm: 2.357 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 264.79 | backward-compute: 175.14 | backward-params-all-reduce: 1775.36 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 62.17 | optimizer-clip-main-grad: 9.24 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 123.11 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 128673 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 44176 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 82639 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 80639 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1711719 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1711819 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1906114 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1906212 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1848485 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1848582 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1881511 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1881648 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       25/     100 | consumed samples:         4800 | elapsed time per iteration (ms): 2571.9 | learning rate: 1.436E-04 | global batch size:   192 | lm loss: 8.532214E+00 | loss scale: 131072.0 | grad norm: 1.903 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 282.98 | backward-compute: 221.94 | backward-params-all-reduce: 1930.13 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.56 | optimizer-clip-main-grad: 25.19 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 134.56 | batch-generator: 2.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 110932 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 66076 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 81283 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 66215 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1774680 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1774818 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1749838 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1749939 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1802835 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1802934 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1721461 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1721583 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       26/     100 | consumed samples:         4992 | elapsed time per iteration (ms): 2311.9 | learning rate: 1.421E-04 | global batch size:   192 | lm loss: 8.379333E+00 | loss scale: 131072.0 | grad norm: 1.957 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 244.82 | backward-compute: 168.83 | backward-params-all-reduce: 1791.91 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 40.09 | optimizer-clip-main-grad: 9.22 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 104.01 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 120279 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 187506 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 157343 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 142483 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1724185 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1724288 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1840007 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1840106 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1736991 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1737086 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1802982 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1803113 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       27/     100 | consumed samples:         5184 | elapsed time per iteration (ms): 2508.1 | learning rate: 1.403E-04 | global batch size:   192 | lm loss: 8.300729E+00 | loss scale: 131072.0 | grad norm: 3.217 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 351.38 | backward-compute: 167.13 | backward-params-all-reduce: 1872.66 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 29.72 | optimizer-clip-main-grad: 9.26 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 114.66 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 85537 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 130099 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 111535 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 163519 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1876509 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1876612 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1774573 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1774670 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1680680 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1680785 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1851531 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1851669 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       28/     100 | consumed samples:         5376 | elapsed time per iteration (ms): 2561.4 | learning rate: 1.384E-04 | global batch size:   192 | lm loss: 8.162030E+00 | loss scale: 131072.0 | grad norm: 2.260 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 317.84 | backward-compute: 155.04 | backward-params-all-reduce: 1909.93 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 29.98 | optimizer-clip-main-grad: 25.24 | optimizer-copy-main-to-model-params: 96.78 | optimizer: 176.32 | batch-generator: 2.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 226469 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 189598 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 256412 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 203538 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1782379 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1782478 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1806147 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1806247 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1707963 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1708060 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1782300 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1782421 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       29/     100 | consumed samples:         5568 | elapsed time per iteration (ms): 2574.6 | learning rate: 1.364E-04 | global batch size:   192 | lm loss: 8.030540E+00 | loss scale: 131072.0 | grad norm: 1.593 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 402.93 | backward-compute: 182.54 | backward-params-all-reduce: 1837.11 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 56.21 | optimizer-copy-main-to-model-params: 6.71 | optimizer: 149.64 | batch-generator: 2.08
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98862 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 245182 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 212846 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 241100 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1869422 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1869548 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1712087 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1712185 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1812005 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1812147 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1811942 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1812037 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       30/     100 | consumed samples:         5760 | elapsed time per iteration (ms): 2575.3 | learning rate: 1.341E-04 | global batch size:   192 | lm loss: 7.920771E+00 | loss scale: 131072.0 | grad norm: 1.083 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 349.49 | backward-compute: 154.37 | backward-params-all-reduce: 1903.30 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 38.59 | optimizer-clip-main-grad: 9.29 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 165.75 | batch-generator: 2.60
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 121209 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 30 | lm loss value: 8.014776E+00 | lm loss PPL: 3.025332E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 158253 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 151020 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 91502 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 107649 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 142882 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 140784 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 121218 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1677094 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1677199 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1656577 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1656724 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1711563 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1711666 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1700992 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1701212 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       31/     100 | consumed samples:         5952 | elapsed time per iteration (ms): 2615.3 | learning rate: 1.318E-04 | global batch size:   192 | lm loss: 7.854444E+00 | loss scale: 131072.0 | grad norm: 1.352 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 566.15 | backward-compute: 185.08 | backward-params-all-reduce: 1741.48 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 42.44 | optimizer-clip-main-grad: 9.22 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 117.92 | batch-generator: 3.62
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 153281 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 86029 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 136694 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 129957 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1592044 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1592141 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1556031 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1556134 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1673188 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1673344 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1699749 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1699901 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       32/     100 | consumed samples:         6144 | elapsed time per iteration (ms): 2341.2 | learning rate: 1.293E-04 | global batch size:   192 | lm loss: 7.798200E+00 | loss scale: 131072.0 | grad norm: 1.435 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 279.50 | backward-compute: 147.70 | backward-params-all-reduce: 1750.42 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 60.61 | optimizer-clip-main-grad: 9.25 | optimizer-copy-main-to-model-params: 67.25 | optimizer: 161.34 | batch-generator: 1.91
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 89812 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 94871 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 79969 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 10356 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1941888 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1941998 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1853745 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1853843 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1902282 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1902383 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1884789 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1884930 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       33/     100 | consumed samples:         6336 | elapsed time per iteration (ms): 2504.1 | learning rate: 1.266E-04 | global batch size:   192 | lm loss: 7.704471E+00 | loss scale: 131072.0 | grad norm: 1.524 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 244.96 | backward-compute: 193.22 | backward-params-all-reduce: 1909.06 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.60 | optimizer-clip-main-grad: 75.99 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 154.56 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 149509 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 124522 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 94184 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 86012 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1915646 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1915748 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1944302 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1944436 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1783900 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1784010 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1974877 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1974972 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       34/     100 | consumed samples:         6528 | elapsed time per iteration (ms): 2564.4 | learning rate: 1.239E-04 | global batch size:   192 | lm loss: 7.655545E+00 | loss scale: 131072.0 | grad norm: 1.296 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 273.03 | backward-compute: 150.97 | backward-params-all-reduce: 1960.09 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.66 | optimizer-clip-main-grad: 80.26 | optimizer-copy-main-to-model-params: 6.73 | optimizer: 178.10 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 5256 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 38233 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 87736 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 93037 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1845554 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1845695 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1754378 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1754483 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1704168 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1704280 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1767147 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1767249 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       35/     100 | consumed samples:         6720 | elapsed time per iteration (ms): 2417.4 | learning rate: 1.210E-04 | global batch size:   192 | lm loss: 7.602894E+00 | loss scale: 131072.0 | grad norm: 1.015 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 222.52 | backward-compute: 148.51 | backward-params-all-reduce: 1876.32 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 5.62 | optimizer-clip-main-grad: 76.57 | optimizer-copy-main-to-model-params: 34.33 | optimizer: 167.76 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 78092 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 14386 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 18957 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98433 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1883664 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1883764 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1813392 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1813492 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1796308 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1796449 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1780479 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1780625 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       36/     100 | consumed samples:         6912 | elapsed time per iteration (ms): 2410.2 | learning rate: 1.180E-04 | global batch size:   192 | lm loss: 7.578309E+00 | loss scale: 131072.0 | grad norm: 0.667 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 270.36 | backward-compute: 204.58 | backward-params-all-reduce: 1826.09 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 37.65 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 106.63 | batch-generator: 2.05
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 156529 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 120829 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 132665 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 165783 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1835458 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1835553 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1897854 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1897962 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1874031 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1874206 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1822687 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1822831 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       37/     100 | consumed samples:         7104 | elapsed time per iteration (ms): 2577.2 | learning rate: 1.149E-04 | global batch size:   192 | lm loss: 7.519432E+00 | loss scale: 131072.0 | grad norm: 0.801 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 337.80 | backward-compute: 219.20 | backward-params-all-reduce: 1905.99 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 29.68 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.68 | optimizer: 111.88 | batch-generator: 2.00
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 100766 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 132450 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 131221 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 101852 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1696769 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1696868 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1901710 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1901882 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1976887 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1976986 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1912638 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1912732 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       38/     100 | consumed samples:         7296 | elapsed time per iteration (ms): 2502.6 | learning rate: 1.117E-04 | global batch size:   192 | lm loss: 7.481350E+00 | loss scale: 131072.0 | grad norm: 0.963 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 290.48 | backward-compute: 208.66 | backward-params-all-reduce: 1918.66 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 82.46 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 137525 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 106392 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 106814 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 118361 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1918597 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1918693 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1901083 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1901180 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1868708 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1868807 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1853857 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1853984 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       39/     100 | consumed samples:         7488 | elapsed time per iteration (ms): 2508.0 | learning rate: 1.084E-04 | global batch size:   192 | lm loss: 7.439357E+00 | loss scale: 131072.0 | grad norm: 0.713 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 355.29 | backward-compute: 183.97 | backward-params-all-reduce: 1879.75 | backward-embedding-all-reduce: 0.05 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 25.88 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 86.71 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 91902 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 68074 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 68119 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 79584 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1891658 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1891758 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 2012530 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 2012682 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1978586 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1978732 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1925177 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1925277 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
 iteration       40/     100 | consumed samples:         7680 | elapsed time per iteration (ms): 2584.0 | learning rate: 1.051E-04 | global batch size:   192 | lm loss: 7.425623E+00 | loss scale: 131072.0 | grad norm: 0.521 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 228.47 | backward-compute: 176.43 | backward-params-all-reduce: 2026.28 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 36.10 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 150.48 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 9095 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 86141 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 40 | lm loss value: 7.777015E+00 | lm loss PPL: 2.385144E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 69174 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 137777 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 22174 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 54719 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 46296 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 28680 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1837398 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1837493 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1872120 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1872222 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1832228 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1832353 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1738557 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1738656 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       41/     100 | consumed samples:         7872 | elapsed time per iteration (ms): 2676.0 | learning rate: 1.016E-04 | global batch size:   192 | lm loss: 7.400822E+00 | loss scale: 131072.0 | grad norm: 0.518 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 466.30 | backward-compute: 179.01 | backward-params-all-reduce: 1883.22 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 61.59 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 142.58 | batch-generator: 3.57
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 70126 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 126724 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 94866 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 37076 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1937537 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1937694 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1842394 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1842493 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1906899 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1907065 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1974844 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1974949 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       42/     100 | consumed samples:         8064 | elapsed time per iteration (ms): 2500.0 | learning rate: 9.812E-05 | global batch size:   192 | lm loss: 7.385534E+00 | loss scale: 131072.0 | grad norm: 0.629 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 251.32 | backward-compute: 158.29 | backward-params-all-reduce: 1978.33 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 43.01 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 109.82 | batch-generator: 1.88
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 112028 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 107302 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 95764 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 104481 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1692015 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1692143 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1663197 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1663296 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1736156 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1736254 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1607156 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1607250 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       43/     100 | consumed samples:         8256 | elapsed time per iteration (ms): 2327.5 | learning rate: 9.456E-05 | global batch size:   192 | lm loss: 7.413561E+00 | loss scale: 131072.0 | grad norm: 0.612 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 282.26 | backward-compute: 189.36 | backward-params-all-reduce: 1712.28 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 35.19 | optimizer-unscale-and-check-inf: 5.72 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 6.69 | optimizer: 141.31 | batch-generator: 1.90
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 87772 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 111144 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 100266 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 85242 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1842892 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1843082 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1815733 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1815871 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1699337 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1699432 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1742689 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1742788 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
 iteration       44/     100 | consumed samples:         8448 | elapsed time per iteration (ms): 2396.6 | learning rate: 9.094E-05 | global batch size:   192 | lm loss: 7.416158E+00 | loss scale: 131072.0 | grad norm: 0.616 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 259.09 | backward-compute: 160.71 | backward-params-all-reduce: 1887.82 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.27 | optimizer-unscale-and-check-inf: 21.28 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 86.61 | batch-generator: 2.00
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 117182 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 2981 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 71959 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 62384 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1850085 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1850182 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1808736 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1808863 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1832735 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1832870 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1722424 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1722523 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       45/     100 | consumed samples:         8640 | elapsed time per iteration (ms): 2487.9 | learning rate: 8.729E-05 | global batch size:   192 | lm loss: 7.375598E+00 | loss scale: 131072.0 | grad norm: 0.489 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 279.66 | backward-compute: 201.20 | backward-params-all-reduce: 1870.12 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.63 | optimizer-clip-main-grad: 72.07 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 134.58 | batch-generator: 2.12
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 58674 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 37936 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 12652 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 18559 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1682158 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1682258 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1780663 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1780757 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1756875 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1757003 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1729697 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1729796 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       46/     100 | consumed samples:         8832 | elapsed time per iteration (ms): 2392.0 | learning rate: 8.361E-05 | global batch size:   192 | lm loss: 7.375164E+00 | loss scale: 131072.0 | grad norm: 0.348 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 225.75 | backward-compute: 183.59 | backward-params-all-reduce: 1859.98 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 7.98 | optimizer-unscale-and-check-inf: 5.63 | optimizer-clip-main-grad: 36.08 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 120.33 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 109456 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 11769 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 92626 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 82434 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1718771 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1718897 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1748991 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1749085 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1661374 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1661479 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1807904 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1808002 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       47/     100 | consumed samples:         9024 | elapsed time per iteration (ms): 2399.9 | learning rate: 7.991E-05 | global batch size:   192 | lm loss: 7.371035E+00 | loss scale: 131072.0 | grad norm: 0.346 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 319.86 | backward-compute: 223.02 | backward-params-all-reduce: 1738.46 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 59.24 | optimizer-clip-main-grad: 4.07 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 116.07 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 56437 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 58396 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 83041 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 114314 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1622345 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1622445 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1603165 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1603268 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1723393 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1723497 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1704265 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1704425 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       48/     100 | consumed samples:         9216 | elapsed time per iteration (ms): 2304.1 | learning rate: 7.619E-05 | global batch size:   192 | lm loss: 7.392964E+00 | loss scale: 131072.0 | grad norm: 0.398 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 281.21 | backward-compute: 162.31 | backward-params-all-reduce: 1755.57 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 13.71 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 102.65 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000060000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 136737 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 39892 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 165413 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 227671 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1546081 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1546175 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1462332 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1462456 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1542075 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1542172 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1564832 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1564931 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       49/     100 | consumed samples:         9408 | elapsed time per iteration (ms): 2211.9 | learning rate: 7.247E-05 | global batch size:   192 | lm loss: 7.378971E+00 | loss scale: 131072.0 | grad norm: 0.479 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 369.59 | backward-compute: 222.21 | backward-params-all-reduce: 1507.72 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 24.01 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 110.03 | batch-generator: 2.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 54154 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 95659 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 8750 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 137168 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1666324 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1666457 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1927654 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1927818 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1845371 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1845468 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1749160 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1749260 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       50/     100 | consumed samples:         9600 | elapsed time per iteration (ms): 2471.7 | learning rate: 6.876E-05 | global batch size:   192 | lm loss: 7.360871E+00 | loss scale: 131072.0 | grad norm: 0.472 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 261.37 | backward-compute: 364.62 | backward-params-all-reduce: 1712.80 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 17.70 | optimizer-unscale-and-check-inf: 5.61 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 130.29 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 106134 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 50 | lm loss value: 7.820457E+00 | lm loss PPL: 2.491044E+03 | 
----------------------------------------------------------------------------------------------
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 136622 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 64360 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 76284 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 7582 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 18498 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 49821 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 36477 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 34249277 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 34506518 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 34518476 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 34497655 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 48086 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 6356 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 47249 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 40051 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 55861 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 47755 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 19865 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 35857 us
time (ms) | save-checkpoint: 34671.87
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 45219 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 37056 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 77647 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 27004 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1756919 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1757018 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1790835 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1790931 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1728092 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1728194 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1704228 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1704396 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       51/     100 | consumed samples:         9792 | elapsed time per iteration (ms): 37361.7 | learning rate: 6.506E-05 | global batch size:   192 | lm loss: 7.352393E+00 | loss scale: 131072.0 | grad norm: 0.367 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 471.09 | backward-compute: 198.30 | backward-params-all-reduce: 1809.40 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.67 | optimizer-clip-main-grad: 74.12 | optimizer-copy-main-to-model-params: 51.78 | optimizer: 155.89 | batch-generator: 3.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 35034 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 15224 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 62059 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 72878 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1903366 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1903460 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1867383 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1867509 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1906852 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1906967 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1956813 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1956913 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
 iteration       52/     100 | consumed samples:         9984 | elapsed time per iteration (ms): 2398.6 | learning rate: 6.139E-05 | global batch size:   192 | lm loss: 7.360666E+00 | loss scale: 131072.0 | grad norm: 0.313 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 175.79 | backward-compute: 245.50 | backward-params-all-reduce: 1884.40 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 32.46 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 90.53 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 5357 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 21523 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 72940 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98943 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1721494 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1721591 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1678270 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1678369 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1660241 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1660400 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1645241 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1645386 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       53/     100 | consumed samples:        10176 | elapsed time per iteration (ms): 2372.1 | learning rate: 5.775E-05 | global batch size:   192 | lm loss: 7.341165E+00 | loss scale: 131072.0 | grad norm: 0.266 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 297.64 | backward-compute: 207.32 | backward-params-all-reduce: 1700.88 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 47.05 | optimizer-clip-main-grad: 31.99 | optimizer-copy-main-to-model-params: 6.72 | optimizer: 163.96 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 97214 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 85371 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 76671 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 100283 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1885679 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1885978 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1917634 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1917729 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1987971 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1988071 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1964000 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1964099 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       54/     100 | consumed samples:        10368 | elapsed time per iteration (ms): 2543.9 | learning rate: 5.416E-05 | global batch size:   192 | lm loss: 7.368979E+00 | loss scale: 131072.0 | grad norm: 0.281 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 268.97 | backward-compute: 254.81 | backward-params-all-reduce: 1939.55 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 19.66 | optimizer-unscale-and-check-inf: 5.69 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 78.28 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 96962 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 118437 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 14685 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 143454 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1976559 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1976742 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2028486 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2028589 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1912701 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1912818 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1985934 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1986033 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       55/     100 | consumed samples:        10560 | elapsed time per iteration (ms): 2664.1 | learning rate: 5.061E-05 | global batch size:   192 | lm loss: 7.343782E+00 | loss scale: 131072.0 | grad norm: 0.355 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 399.25 | backward-compute: 155.73 | backward-params-all-reduce: 1989.45 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 52.43 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 117.42 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 67134 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 94851 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 99729 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 90909 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1692869 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1692999 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1728537 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1728637 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1753198 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1753297 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1712919 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1713017 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000050000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       56/     100 | consumed samples:        10752 | elapsed time per iteration (ms): 2258.1 | learning rate: 4.713E-05 | global batch size:   192 | lm loss: 7.367580E+00 | loss scale: 131072.0 | grad norm: 0.347 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 299.74 | backward-compute: 161.07 | backward-params-all-reduce: 1709.46 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 50.52 | optimizer-clip-main-grad: 4.08 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 85.60 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 43270 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 603 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 79951 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 79335 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1444483 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1444579 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1534504 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1534606 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1573542 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1573637 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1518256 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1518392 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       57/     100 | consumed samples:        10944 | elapsed time per iteration (ms): 2203.2 | learning rate: 4.371E-05 | global batch size:   192 | lm loss: 7.345683E+00 | loss scale: 131072.0 | grad norm: 0.290 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 269.15 | backward-compute: 195.32 | backward-params-all-reduce: 1600.81 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 31.42 | optimizer-unscale-and-check-inf: 5.71 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 76.17 | optimizer: 135.48 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 152820 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 175725 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 179986 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 139756 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1767604 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1767705 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1824609 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1824715 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1748561 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1748815 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1855802 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1855936 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       58/     100 | consumed samples:        11136 | elapsed time per iteration (ms): 2539.2 | learning rate: 4.037E-05 | global batch size:   192 | lm loss: 7.356733E+00 | loss scale: 131072.0 | grad norm: 0.258 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 279.09 | backward-compute: 160.47 | backward-params-all-reduce: 1942.24 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 57.67 | optimizer-clip-main-grad: 4.14 | optimizer-copy-main-to-model-params: 6.73 | optimizer: 155.14 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 87922 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 16202 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 70240 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 112533 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1784273 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1784375 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1644883 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1644980 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1700139 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1700241 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1752258 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1752384 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       59/     100 | consumed samples:        11328 | elapsed time per iteration (ms): 2336.4 | learning rate: 3.711E-05 | global batch size:   192 | lm loss: 7.363332E+00 | loss scale: 131072.0 | grad norm: 0.241 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 195.47 | backward-compute: 175.50 | backward-params-all-reduce: 1839.59 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.66 | optimizer-clip-main-grad: 56.03 | optimizer-copy-main-to-model-params: 6.72 | optimizer: 123.52 | batch-generator: 2.02
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 53918 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 104319 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 39634 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 51917 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1794321 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1794425 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1877579 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1877680 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1867113 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1867212 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1918133 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1918257 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       60/     100 | consumed samples:        11520 | elapsed time per iteration (ms): 2471.5 | learning rate: 3.395E-05 | global batch size:   192 | lm loss: 7.341727E+00 | loss scale: 131072.0 | grad norm: 0.229 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 228.68 | backward-compute: 147.78 | backward-params-all-reduce: 1989.65 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 25.71 | optimizer-clip-main-grad: 4.14 | optimizer-copy-main-to-model-params: 6.68 | optimizer: 102.99 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 66323 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 60 | lm loss value: 7.785685E+00 | lm loss PPL: 2.405913E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 65964 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 50497 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 96680 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 40634 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 54080 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 26526 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 36226 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1894444 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1894567 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1909044 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1909141 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1813922 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1814026 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1897661 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1897804 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       61/     100 | consumed samples:        11712 | elapsed time per iteration (ms): 2675.6 | learning rate: 3.089E-05 | global batch size:   192 | lm loss: 7.360823E+00 | loss scale: 131072.0 | grad norm: 0.237 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 416.66 | backward-compute: 177.49 | backward-params-all-reduce: 1986.19 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 25.73 | optimizer-clip-main-grad: 4.16 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 90.68 | batch-generator: 3.67
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 87011 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 102329 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 67153 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 90655 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1748912 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1749029 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1707562 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1707687 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1786067 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1786163 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1780684 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1780785 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       62/     100 | consumed samples:        11904 | elapsed time per iteration (ms): 2386.6 | learning rate: 2.794E-05 | global batch size:   192 | lm loss: 7.350605E+00 | loss scale: 131072.0 | grad norm: 0.247 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 297.91 | backward-compute: 200.19 | backward-params-all-reduce: 1758.63 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 49.12 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 127.51 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 122150 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 116263 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 114827 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 83439 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1920075 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1920242 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1860653 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1860895 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1750215 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1750318 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1774980 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1775081 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       63/     100 | consumed samples:        12096 | elapsed time per iteration (ms): 2505.7 | learning rate: 2.510E-05 | global batch size:   192 | lm loss: 7.332828E+00 | loss scale: 131072.0 | grad norm: 0.229 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 257.25 | backward-compute: 194.45 | backward-params-all-reduce: 1930.72 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 47.75 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 121.05 | batch-generator: 1.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000068000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 110409 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 154423 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 169307 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 152370 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1795438 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1795582 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1763525 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1763655 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1793255 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1793350 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1707227 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1707327 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       64/     100 | consumed samples:        12288 | elapsed time per iteration (ms): 2407.5 | learning rate: 2.239E-05 | global batch size:   192 | lm loss: 7.349171E+00 | loss scale: 131072.0 | grad norm: 0.253 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 328.66 | backward-compute: 176.48 | backward-params-all-reduce: 1792.95 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 46.37 | optimizer-clip-main-grad: 4.16 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 107.20 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000061000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 64664 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 99875 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 78875 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 104940 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1898531 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1898657 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1939976 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1940078 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1831472 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1831569 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1981706 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1981813 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       65/     100 | consumed samples:        12480 | elapsed time per iteration (ms): 2552.0 | learning rate: 1.980E-05 | global batch size:   192 | lm loss: 7.337546E+00 | loss scale: 131072.0 | grad norm: 0.222 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 310.39 | backward-compute: 192.55 | backward-params-all-reduce: 1948.22 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 37.70 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 98.54 | batch-generator: 2.11
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 84408 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 62848 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 67015 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 110602 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1691929 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1692027 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1576885 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1576983 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1628933 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1629034 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1725635 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1725820 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       66/     100 | consumed samples:        12672 | elapsed time per iteration (ms): 2289.4 | learning rate: 1.736E-05 | global batch size:   192 | lm loss: 7.314539E+00 | loss scale: 131072.0 | grad norm: 0.230 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 254.54 | backward-compute: 154.45 | backward-params-all-reduce: 1758.55 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 38.85 | optimizer-clip-main-grad: 26.51 | optimizer-copy-main-to-model-params: 27.52 | optimizer: 119.59 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000050000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 112908 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 44330 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 36282 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 29078 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1732725 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1732856 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1780662 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1780761 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1614330 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1614424 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1706775 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1706882 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       67/     100 | consumed samples:        12864 | elapsed time per iteration (ms): 2315.2 | learning rate: 1.505E-05 | global batch size:   192 | lm loss: 7.355127E+00 | loss scale: 131072.0 | grad norm: 0.222 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 256.60 | backward-compute: 203.60 | backward-params-all-reduce: 1754.05 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 37.26 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 98.53 | batch-generator: 2.06
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 274138 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 241448 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 225150 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 261685 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1788021 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1788118 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1770932 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1771113 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1808124 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1808219 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1851936 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1852036 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       68/     100 | consumed samples:        13056 | elapsed time per iteration (ms): 2635.5 | learning rate: 1.289E-05 | global batch size:   192 | lm loss: 7.325490E+00 | loss scale: 131072.0 | grad norm: 0.219 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 491.28 | backward-compute: 215.33 | backward-params-all-reduce: 1803.86 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 9.89 | optimizer-clip-main-grad: 4.13 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 122.57 | batch-generator: 2.66
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 231108 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 267664 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 147045 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 281050 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1886095 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1886196 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1817614 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1817712 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1842846 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1842941 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1775817 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1775945 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       69/     100 | consumed samples:        13248 | elapsed time per iteration (ms): 2643.3 | learning rate: 1.088E-05 | global batch size:   192 | lm loss: 7.293809E+00 | loss scale: 131072.0 | grad norm: 0.210 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 437.20 | backward-compute: 272.45 | backward-params-all-reduce: 1809.51 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 48.61 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.71 | optimizer: 120.79 | batch-generator: 2.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 94660 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 116313 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 154345 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 110502 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1903285 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1903382 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1995695 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1995791 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1980175 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1980274 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1955884 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1956057 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
 iteration       70/     100 | consumed samples:        13440 | elapsed time per iteration (ms): 2628.6 | learning rate: 9.032E-06 | global batch size:   192 | lm loss: 7.308636E+00 | loss scale: 131072.0 | grad norm: 0.198 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 292.58 | backward-compute: 237.29 | backward-params-all-reduce: 2018.02 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 10.36 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 78.24 | batch-generator: 3.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 27892 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 43522 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 49862 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 117111 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 70 | lm loss value: 7.774359E+00 | lm loss PPL: 2.378819E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000058000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 135442 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 135353 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 119178 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 121705 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1839414 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1839560 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1891301 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1891399 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1871445 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1871554 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1796916 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1797065 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       71/     100 | consumed samples:        13632 | elapsed time per iteration (ms): 2884.4 | learning rate: 7.345E-06 | global batch size:   192 | lm loss: 7.313299E+00 | loss scale: 131072.0 | grad norm: 0.203 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 613.36 | backward-compute: 200.84 | backward-params-all-reduce: 1926.40 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 13.73 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.68 | optimizer: 138.95 | batch-generator: 3.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 21401 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 7761 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 564 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 7072 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1910397 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1910491 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1870215 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1870336 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1833145 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1833245 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000048000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1900472 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1900621 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       72/     100 | consumed samples:        13824 | elapsed time per iteration (ms): 2337.8 | learning rate: 5.823E-06 | global batch size:   192 | lm loss: 7.313953E+00 | loss scale: 131072.0 | grad norm: 0.209 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 154.22 | backward-compute: 204.33 | backward-params-all-reduce: 1906.79 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 35.13 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 70.23 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 69647 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 48809 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 88634 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 27679 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1947171 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1947311 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1898592 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1898697 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1796845 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1796943 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1918510 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1918612 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       73/     100 | consumed samples:        14016 | elapsed time per iteration (ms): 2538.2 | learning rate: 4.472E-06 | global batch size:   192 | lm loss: 7.299714E+00 | loss scale: 131072.0 | grad norm: 0.199 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 276.77 | backward-compute: 185.96 | backward-params-all-reduce: 1986.17 | backward-embedding-all-reduce: 0.05 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 22.80 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 86.96 | batch-generator: 62.66
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 127694 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 58696 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 21111 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 68406 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1796808 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1796908 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1924154 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1924293 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1842880 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1842980 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1885464 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1885595 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       74/     100 | consumed samples:        14208 | elapsed time per iteration (ms): 2551.6 | learning rate: 3.295E-06 | global batch size:   192 | lm loss: 7.315882E+00 | loss scale: 131072.0 | grad norm: 0.198 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 293.01 | backward-compute: 206.08 | backward-params-all-reduce: 1912.15 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 22.74 | optimizer-unscale-and-check-inf: 5.74 | optimizer-clip-main-grad: 50.84 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 137.95 | batch-generator: 2.05
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 60823 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 80236 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 127076 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 110607 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1954384 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1954519 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1978744 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1978844 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2037571 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2037674 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1892020 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1892124 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       75/     100 | consumed samples:        14400 | elapsed time per iteration (ms): 2572.0 | learning rate: 2.293E-06 | global batch size:   192 | lm loss: 7.307744E+00 | loss scale: 131072.0 | grad norm: 0.253 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 214.86 | backward-compute: 252.13 | backward-params-all-reduce: 1980.84 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 17.72 | optimizer-unscale-and-check-inf: 5.63 | optimizer-clip-main-grad: 47.89 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 121.79 | batch-generator: 1.91
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 119591 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 59714 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 110566 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 91101 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1958391 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1958489 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2003920 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2004019 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1926951 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1927085 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1965435 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1965536 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       76/     100 | consumed samples:        14592 | elapsed time per iteration (ms): 2602.8 | learning rate: 1.470E-06 | global batch size:   192 | lm loss: 7.296934E+00 | loss scale: 131072.0 | grad norm: 0.179 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 251.59 | backward-compute: 224.21 | backward-params-all-reduce: 1954.22 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 66.90 | optimizer-clip-main-grad: 4.17 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 170.55 | batch-generator: 1.91
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 124764 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 41671 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 90133 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 46778 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1890509 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1890604 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1880385 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1880521 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1916633 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1916732 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1992146 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1992248 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       77/     100 | consumed samples:        14784 | elapsed time per iteration (ms): 2505.2 | learning rate: 8.282E-07 | global batch size:   192 | lm loss: 7.305716E+00 | loss scale: 131072.0 | grad norm: 0.180 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 257.93 | backward-compute: 164.12 | backward-params-all-reduce: 1958.60 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 69.48 | optimizer-clip-main-grad: 4.13 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 122.33 | batch-generator: 1.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 40515 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 49902 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 16351 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 60112 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1757356 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1757501 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1779770 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1779864 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1683845 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1683943 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1744491 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1744592 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
 iteration       78/     100 | consumed samples:        14976 | elapsed time per iteration (ms): 2324.0 | learning rate: 3.685E-07 | global batch size:   192 | lm loss: 7.314735E+00 | loss scale: 131072.0 | grad norm: 0.186 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 229.75 | backward-compute: 187.20 | backward-params-all-reduce: 1779.11 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 51.11 | optimizer-clip-main-grad: 4.14 | optimizer-copy-main-to-model-params: 6.71 | optimizer: 125.50 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000059000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 201388 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 209770 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 11951 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 225235 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1803151 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1803322 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1815640 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1815738 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1713128 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1713227 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1868295 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1868428 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       79/     100 | consumed samples:        15168 | elapsed time per iteration (ms): 2613.5 | learning rate: 9.217E-08 | global batch size:   192 | lm loss: 7.331884E+00 | loss scale: 131072.0 | grad norm: 0.207 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 398.91 | backward-compute: 162.13 | backward-params-all-reduce: 1936.05 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 39.71 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 16.14 | optimizer: 114.06 | batch-generator: 2.11
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 29479 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 81502 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 78481 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 62068 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1956739 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1956866 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2018020 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2018157 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1992909 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1993011 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1901412 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1901508 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       80/     100 | consumed samples:        15360 | elapsed time per iteration (ms): 2494.5 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.298370E+00 | loss scale: 131072.0 | grad norm: 0.191 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 226.31 | backward-compute: 198.99 | backward-params-all-reduce: 1978.46 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 9.28 | optimizer-unscale-and-check-inf: 32.56 | optimizer-clip-main-grad: 4.19 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 88.42 | batch-generator: 1.92
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 98910 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 78633 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 95861 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 98832 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 80 | lm loss value: 7.779095E+00 | lm loss PPL: 2.390110E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 83629 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 82767 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 81749 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 66644 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1924113 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1924231 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1808095 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1808195 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1945543 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1945641 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1889468 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1889567 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       81/     100 | consumed samples:        15552 | elapsed time per iteration (ms): 2831.6 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.309465E+00 | loss scale: 131072.0 | grad norm: 0.203 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 492.67 | backward-compute: 181.73 | backward-params-all-reduce: 2022.39 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 17.72 | optimizer-clip-main-grad: 46.27 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 129.88 | batch-generator: 2.45
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 46074 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 15610 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 6342 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 31642 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1668882 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1668983 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1848638 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1848778 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1812118 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1812217 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1759292 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1759388 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       82/     100 | consumed samples:        15744 | elapsed time per iteration (ms): 2408.4 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.341008E+00 | loss scale: 131072.0 | grad norm: 0.180 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 208.02 | backward-compute: 186.23 | backward-params-all-reduce: 1863.50 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 24.81 | optimizer-unscale-and-check-inf: 5.72 | optimizer-clip-main-grad: 39.00 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 148.18 | batch-generator: 34.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 75554 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 96246 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 119028 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 103745 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1920203 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1920339 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1826344 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1826438 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1868085 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1868184 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1832558 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1832656 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000055000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       83/     100 | consumed samples:        15936 | elapsed time per iteration (ms): 2407.9 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.321951E+00 | loss scale: 131072.0 | grad norm: 0.203 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 216.10 | backward-compute: 148.84 | backward-params-all-reduce: 1950.26 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 29.70 | optimizer-clip-main-grad: 4.06 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 90.51 | batch-generator: 1.94
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 84186 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 80483 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 33734 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 22703 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1735440 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1735542 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1896743 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1896865 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1819667 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1819761 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1597805 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1597984 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       84/     100 | consumed samples:        16128 | elapsed time per iteration (ms): 2520.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.313368E+00 | loss scale: 131072.0 | grad norm: 0.189 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 252.97 | backward-compute: 147.75 | backward-params-all-reduce: 1998.17 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 43.13 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 118.86 | batch-generator: 2.05
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000048000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 51930 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 74617 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 46319 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 52609 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1720040 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1720142 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1663314 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1663440 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1703320 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1703414 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1648630 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1648729 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       85/     100 | consumed samples:        16320 | elapsed time per iteration (ms): 2352.8 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.306476E+00 | loss scale: 131072.0 | grad norm: 0.177 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 285.99 | backward-compute: 174.97 | backward-params-all-reduce: 1778.07 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 16.35 | optimizer-unscale-and-check-inf: 5.70 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.70 | optimizer: 111.40 | batch-generator: 1.99
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 43986 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 23131 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 89303 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 53980 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 2024595 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 2024691 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1987423 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1987560 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 2013984 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 2014084 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1959661 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1959809 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       86/     100 | consumed samples:        16512 | elapsed time per iteration (ms): 2567.2 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.327464E+00 | loss scale: 131072.0 | grad norm: 0.211 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 199.82 | backward-compute: 265.62 | backward-params-all-reduce: 2004.72 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.64 | optimizer-clip-main-grad: 28.05 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 94.57 | batch-generator: 1.92
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 87762 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 70209 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 105625 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 101570 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1751316 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1751440 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1780669 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1780767 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1646799 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1646893 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1763093 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1763191 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       87/     100 | consumed samples:        16704 | elapsed time per iteration (ms): 2324.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.322574E+00 | loss scale: 131072.0 | grad norm: 0.194 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 237.72 | backward-compute: 227.23 | backward-params-all-reduce: 1754.64 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 15.40 | optimizer-unscale-and-check-inf: 5.62 | optimizer-clip-main-grad: 38.45 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 102.07 | batch-generator: 2.03
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 167687 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 196862 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 147540 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 111819 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1823822 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1823924 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1730912 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1731032 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1784644 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1784740 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1751603 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1751702 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       88/     100 | consumed samples:        16896 | elapsed time per iteration (ms): 2508.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.296597E+00 | loss scale: 131072.0 | grad norm: 0.198 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 425.43 | backward-compute: 201.02 | backward-params-all-reduce: 1766.77 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 6.11 | optimizer-clip-main-grad: 36.19 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 112.48 | batch-generator: 2.05
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 73298 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 4593 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 37331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 46405 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1751514 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1751614 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1836874 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1836978 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1735349 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1735471 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1940197 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1940298 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       89/     100 | consumed samples:        17088 | elapsed time per iteration (ms): 2536.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.308100E+00 | loss scale: 131072.0 | grad norm: 0.194 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 312.48 | backward-compute: 277.97 | backward-params-all-reduce: 1820.52 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.62 | optimizer-clip-main-grad: 24.08 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 122.57 | batch-generator: 2.01
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000053000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 160393 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 127459 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 144630 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 147811 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1843794 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1843888 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1772840 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1772939 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1793670 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1793815 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1709003 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1709107 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       90/     100 | consumed samples:        17280 | elapsed time per iteration (ms): 2464.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.320272E+00 | loss scale: 131072.0 | grad norm: 0.197 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 321.89 | backward-compute: 175.06 | backward-params-all-reduce: 1832.68 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 35.32 | optimizer-clip-main-grad: 4.12 | optimizer-copy-main-to-model-params: 6.68 | optimizer: 132.08 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 88235 us
----------------------------------------------------------------------------------------------
 validation loss at iteration 90 | lm loss value: 7.777882E+00 | lm loss PPL: 2.387212E+03 | 
----------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 131582 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 144459 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 95393 us
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 96842 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 83410 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 102855 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 96499 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1777081 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1777179 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1816194 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1816301 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1911510 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1911650 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1716346 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1716463 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       91/     100 | consumed samples:        17472 | elapsed time per iteration (ms): 2693.3 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.346004E+00 | loss scale: 131072.0 | grad norm: 0.194 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 479.87 | backward-compute: 158.09 | backward-params-all-reduce: 1946.71 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 30.81 | optimizer-clip-main-grad: 4.11 | optimizer-copy-main-to-model-params: 22.80 | optimizer: 103.89 | batch-generator: 2.47
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000053000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 129509 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 83188 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 107702 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 32 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1862909 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1863012 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1861271 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1861443 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1796013 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1796114 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1784477 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1784625 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       92/     100 | consumed samples:        17664 | elapsed time per iteration (ms): 2450.6 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.292135E+00 | loss scale: 131072.0 | grad norm: 0.204 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 268.33 | backward-compute: 199.24 | backward-params-all-reduce: 1890.14 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 19.90 | optimizer-unscale-and-check-inf: 5.71 | optimizer-clip-main-grad: 4.10 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 90.56 | batch-generator: 1.95
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000059000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 4056 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 27221 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 15312 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 44106 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 2088055 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 2088156 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 2045405 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 2045531 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 2079445 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 2079543 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1989909 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1990012 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
 iteration       93/     100 | consumed samples:        17856 | elapsed time per iteration (ms): 2596.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.301465E+00 | loss scale: 131072.0 | grad norm: 0.187 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 282.54 | backward-compute: 160.71 | backward-params-all-reduce: 2056.62 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 32.67 | optimizer-clip-main-grad: 4.13 | optimizer-copy-main-to-model-params: 6.64 | optimizer: 93.84 | batch-generator: 2.07
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 11090 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 52341 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 96093 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 37252 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1992632 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1992727 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1924423 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1924544 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1960785 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1960889 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1984257 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1984356 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       94/     100 | consumed samples:        18048 | elapsed time per iteration (ms): 2684.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.309344E+00 | loss scale: 131072.0 | grad norm: 0.196 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 306.78 | backward-compute: 192.15 | backward-params-all-reduce: 2035.42 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 5.65 | optimizer-clip-main-grad: 56.83 | optimizer-copy-main-to-model-params: 6.67 | optimizer: 147.37 | batch-generator: 2.04
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 50995 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 20703 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 15488 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 14797 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1913277 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1913411 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1849320 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1849414 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1959482 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1959583 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1992073 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1992173 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000010000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       95/     100 | consumed samples:        18240 | elapsed time per iteration (ms): 2497.8 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.342716E+00 | loss scale: 131072.0 | grad norm: 0.213 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 185.05 | backward-compute: 197.20 | backward-params-all-reduce: 1978.09 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 5.65 | optimizer-clip-main-grad: 66.81 | optimizer-copy-main-to-model-params: 6.65 | optimizer: 135.16 | batch-generator: 1.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 74890 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 69494 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 68745 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 81155 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1726295 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1726389 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1762905 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1763009 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1884481 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1884582 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1864871 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1864998 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
 iteration       96/     100 | consumed samples:        18432 | elapsed time per iteration (ms): 2490.2 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.313468E+00 | loss scale: 131072.0 | grad norm: 0.186 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 258.04 | backward-compute: 188.24 | backward-params-all-reduce: 1922.33 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 5.67 | optimizer-clip-main-grad: 47.39 | optimizer-copy-main-to-model-params: 6.66 | optimizer: 119.32 | batch-generator: 1.98
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000062000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 78913 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 91427 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 104601 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 54023 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1932178 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1932277 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1840198 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1840350 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1904131 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1904360 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1772837 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1772941 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration       97/     100 | consumed samples:        18624 | elapsed time per iteration (ms): 2447.9 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.324044E+00 | loss scale: 131072.0 | grad norm: 0.183 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 249.10 | backward-compute: 190.81 | backward-params-all-reduce: 1882.40 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.24 | optimizer-unscale-and-check-inf: 44.49 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 93.30 | batch-generator: 0.72
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000061000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 99303 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 103298 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 73652 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 72560 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1800964 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1801124 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1859887 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1859987 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1852852 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1853061 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1819245 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1819344 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
 iteration       98/     100 | consumed samples:        18816 | elapsed time per iteration (ms): 2432.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.333560E+00 | loss scale: 131072.0 | grad norm: 0.205 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 240.14 | backward-compute: 222.62 | backward-params-all-reduce: 1809.12 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 58.55 | optimizer-clip-main-grad: 4.09 | optimizer-copy-main-to-model-params: 6.62 | optimizer: 119.40 | batch-generator: 0.69
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 91026 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 5176 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 53817 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 4218 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1695364 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1695466 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1756767 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1756893 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1737862 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1737970 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1675721 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1675821 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
 iteration       99/     100 | consumed samples:        19008 | elapsed time per iteration (ms): 2372.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.317745E+00 | loss scale: 131072.0 | grad norm: 0.189 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 241.88 | backward-compute: 199.13 | backward-params-all-reduce: 1810.20 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.25 | optimizer-unscale-and-check-inf: 25.68 | optimizer-clip-main-grad: 4.05 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 118.52 | batch-generator: 0.65
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000005000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 147328 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 176738 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 203908 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 99756 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_FUNC_NAME (common.h)] 14 AllReduce RING SIMPLE Sum half Elapsed time: 1628302 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce RING LL Sum half Elapsed time: 1628397 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 15 AllReduce RING SIMPLE Sum half Elapsed time: 1716772 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce RING LL Sum half Elapsed time: 1716891 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000009000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 12 AllReduce RING SIMPLE Sum half Elapsed time: 1751148 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce RING LL Sum half Elapsed time: 1751249 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds

[LYD INFO in NCCL_FUNC_NAME (common.h)] 13 AllReduce RING SIMPLE Sum half Elapsed time: 1694717 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce RING LL Sum half Elapsed time: 1694815 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000015000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
 iteration      100/     100 | consumed samples:        19200 | elapsed time per iteration (ms): 2424.0 | learning rate: 0.000E+00 | global batch size:   192 | lm loss: 7.316997E+00 | loss scale: 131072.0 | grad norm: 0.181 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 385.46 | backward-compute: 151.51 | backward-params-all-reduce: 1746.69 | backward-embedding-all-reduce: 0.04 | optimizer-copy-to-main-grad: 6.26 | optimizer-unscale-and-check-inf: 5.70 | optimizer-clip-main-grad: 83.51 | optimizer-copy-main-to-model-params: 6.63 | optimizer: 138.07 | batch-generator: 0.65
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000013000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 5, datatype: ncclInt64, message size: 40 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 6156, datatype: ncclInt64, message size: 49248 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000012000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000008000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000007000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 6144, datatype: ncclFloat32/ncclFloat, message size: 24576 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000006000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum float Elapsed time: 85905 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum float Elapsed time: 106884 us
-----------------------------------------------------------------------------------------------
 validation loss at iteration 100 | lm loss value: 7.768998E+00 | lm loss PPL: 2.366100E+03 | 
-----------------------------------------------------------------------------------------------
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum float Elapsed time: 105945 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum float Elapsed time: 22679 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 14 AllReduce TREE LL Sum uint8_t Elapsed time: 72917 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4
[LYD INFO in NCCL_KERN_NAME (common.h)] 15 AllReduce TREE LL Sum uint8_t Elapsed time: 76938 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 12 AllReduce TREE LL Sum uint8_t Elapsed time: 80214 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 13 AllReduce TREE LL Sum uint8_t Elapsed time: 60648 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 4