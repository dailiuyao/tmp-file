10.140.57.98 10.201.1.252 10.201.1.253 
10.201.1.253
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launch.py:181: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
using world size: 4, data-parallel-size: 4, tensor-model-parallel size: 1, pipeline-model-parallel size: 1 
using torch.float16 for parameters ...
Gradient accumulation fusion to linear layer weight gradient computation is supported only with fp32 gradient accumulation. Setting gradient_accumulation_fusion to False
------------------------ arguments ------------------------
  accumulate_allreduce_grads_in_fp32 .............. False
  adam_beta1 ...................................... 0.9
  adam_beta2 ...................................... 0.999
  adam_eps ........................................ 1e-08
  adlr_autoresume ................................. False
  adlr_autoresume_interval ........................ 1000
  apply_query_key_layer_scaling ................... True
  apply_residual_connection_post_layernorm ........ False
  async_tensor_model_parallel_allreduce ........... True
  attention_dropout ............................... 0.1
  attention_softmax_in_fp32 ....................... False
  bert_binary_head ................................ True
  bert_load ....................................... None
  bf16 ............................................ False
  bias_dropout_fusion ............................. True
  bias_gelu_fusion ................................ True
  biencoder_projection_dim ........................ 0
  biencoder_shared_query_context_model ............ False
  block_data_path ................................. None
  classes_fraction ................................ 1.0
  clip_grad ....................................... 1.0
  consumed_train_samples .......................... 0
  consumed_valid_samples .......................... 0
  data_impl ....................................... infer
  data_parallel_random_init ....................... False
  data_parallel_size .............................. 4
  data_path ....................................... ['/home/yuke/lyd/Megatron-LM/my-bert_text_sentence']
  data_per_class_fraction ......................... 1.0
  data_sharding ................................... True
  dataloader_type ................................. single
  DDP_impl ........................................ local
  decoder_seq_length .............................. None
  dino_bottleneck_size ............................ 256
  dino_freeze_last_layer .......................... 1
  dino_head_hidden_size ........................... 2048
  dino_local_crops_number ......................... 10
  dino_local_img_size ............................. 96
  dino_norm_last_layer ............................ False
  dino_teacher_temp ............................... 0.07
  dino_warmup_teacher_temp ........................ 0.04
  dino_warmup_teacher_temp_epochs ................. 30
  distribute_saved_activations .................... False
  distributed_backend ............................. nccl
  embedding_path .................................. None
  empty_unused_memory_level ....................... 0
  encoder_seq_length .............................. 512
  end_weight_decay ................................ 0.01
  eod_mask_loss ................................... False
  eval_interval ................................... 10
  eval_iters ...................................... 1
  evidence_data_path .............................. None
  exit_duration_in_mins ........................... None
  exit_interval ................................... None
  exit_signal_handler ............................. False
  ffn_hidden_size ................................. 4096
  finetune ........................................ False
  fp16 ............................................ True
  fp16_lm_cross_entropy ........................... False
  fp32_residual_connection ........................ False
  global_batch_size ............................... 64
  gradient_accumulation_fusion .................... False
  head_lr_mult .................................... 1.0
  hidden_dropout .................................. 0.1
  hidden_size ..................................... 1024
  hysteresis ...................................... 2
  ict_head_size ................................... None
  ict_load ........................................ None
  img_h ........................................... 224
  img_w ........................................... 224
  indexer_batch_size .............................. 128
  indexer_log_interval ............................ 1000
  inference_batch_times_seqlen_threshold .......... 512
  init_method_std ................................. 0.02
  init_method_xavier_uniform ...................... False
  initial_loss_scale .............................. 4294967296
  iter_per_epoch .................................. 1250
  kv_channels ..................................... 64
  layernorm_epsilon ............................... 1e-05
  lazy_mpu_init ................................... None
  load ............................................ /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
  local_rank ...................................... 0
  log_batch_size_to_tensorboard ................... False
  log_interval .................................... 1
  log_learning_rate_to_tensorboard ................ True
  log_loss_scale_to_tensorboard ................... True
  log_memory_to_tensorboard ....................... False
  log_num_zeros_in_grad ........................... False
  log_params_norm ................................. False
  log_timers_to_tensorboard ....................... False
  log_validation_ppl_to_tensorboard ............... False
  log_world_size_to_tensorboard ................... False
  loss_scale ...................................... None
  loss_scale_window ............................... 1000
  lr .............................................. 0.0001
  lr_decay_iters .................................. 49
  lr_decay_samples ................................ None
  lr_decay_style .................................. linear
  lr_warmup_fraction .............................. 0.01
  lr_warmup_iters ................................. 0
  lr_warmup_samples ............................... 0
  make_vocab_size_divisible_by .................... 128
  mask_factor ..................................... 1.0
  mask_prob ....................................... 0.15
  mask_type ....................................... random
  masked_softmax_fusion ........................... True
  max_position_embeddings ......................... 512
  merge_file ...................................... None
  micro_batch_size ................................ 16
  min_loss_scale .................................. 1.0
  min_lr .......................................... 1e-05
  mmap_warmup ..................................... False
  no_load_optim ................................... None
  no_load_rng ..................................... None
  no_persist_layer_norm ........................... False
  no_save_optim ................................... None
  no_save_rng ..................................... None
  num_attention_heads ............................. 16
  num_channels .................................... 3
  num_classes ..................................... 1000
  num_experts ..................................... None
  num_layers ...................................... 24
  num_layers_per_virtual_pipeline_stage ........... None
  num_workers ..................................... 2
  onnx_safe ....................................... None
  openai_gelu ..................................... False
  optimizer ....................................... adam
  override_opt_param_scheduler .................... False
  params_dtype .................................... torch.float16
  patch_dim ....................................... 16
  pipeline_model_parallel_size .................... 1
  pipeline_model_parallel_split_rank .............. None
  query_in_block_prob ............................. 0.1
  rampup_batch_size ............................... None
  rank ............................................ 0
  recompute_granularity ........................... None
  recompute_method ................................ uniform
  recompute_num_layers ............................ 1
  reset_attention_mask ............................ False
  reset_position_ids .............................. False
  retriever_report_topk_accuracies ................ []
  retriever_score_scaling ......................... False
  retriever_seq_length ............................ 256
  sample_rate ..................................... 1.0
  save ............................................ /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
  save_interval ................................... 50
  scatter_gather_tensors_in_pipeline .............. True
  seed ............................................ 1234
  seq_length ...................................... 512
  sequence_parallel ............................... False
  sgd_momentum .................................... 0.9
  short_seq_prob .................................. 0.1
  split ........................................... 949,50,1
  standalone_embedding_stage ...................... False
  start_weight_decay .............................. 0.01
  swin_backbone_type .............................. tiny
  tensor_model_parallel_size ...................... 1
  tensorboard_dir ................................. None
  tensorboard_log_interval ........................ 1
  tensorboard_queue_size .......................... 1000
  titles_data_path ................................ None
  tokenizer_type .................................. BertWordPieceLowerCase
  train_iters ..................................... 100
  train_samples ................................... None
  transformer_pipeline_model_parallel_size ........ 1
  use_checkpoint_opt_param_scheduler .............. False
  use_contiguous_buffers_in_local_ddp ............. True
  use_cpu_initialization .......................... None
  use_one_sent_docs ............................... False
  virtual_pipeline_model_parallel_size ............ None
  vision_backbone_type ............................ vit
  vision_pretraining .............................. False
  vision_pretraining_type ......................... classify
  vocab_extra_ids ................................. 0
  vocab_file ...................................... /home/yuke/lyd/Megatron-LM/model/bert-large-cased-vocab.txt
  weight_decay .................................... 0.01
  weight_decay_incr_style ......................... constant
  world_size ...................................... 4
-------------------- end of arguments ---------------------
setting number of micro-batches to constant 1
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 28998) with 58 dummy tokens (new size: 29056)
> initializing torch distributed ...
> initializing tensor model parallel with size 1
> initializing pipeline model parallel with size 1
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
> compiling dataset index builder ...
make: Entering directory '/home/yuke/lyd/Megatron-LM/megatron/data'
make: Nothing to be done for 'default'.
make: Leaving directory '/home/yuke/lyd/Megatron-LM/megatron/data'
>>> done with dataset index builder. Compilation time: 0.047 seconds
> compiling and loading fused kernels ...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module scaled_upper_triang_masked_softmax_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module scaled_upper_triang_masked_softmax_cuda...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module scaled_masked_softmax_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module scaled_masked_softmax_cuda...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module scaled_softmax_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module scaled_softmax_cuda...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module fused_mix_prec_layer_norm_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_mix_prec_layer_norm_cuda...
x3006c0s1b1n0:39308:39308 [0] NCCL INFO Bootstrap : Using hsn0:10.201.1.253<0>
x3006c0s1b1n0:39308:39308 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3006c0s1b1n0:39308:39308 [0] NCCL INFO cudaDriverVersion 11040
NCCL version 2.14.3+cuda11.8
x3006c0s1b1n0:39309:39309 [1] NCCL INFO cudaDriverVersion 11040
x3006c0s1b1n0:39310:39310 [2] NCCL INFO cudaDriverVersion 11040
x3006c0s1b1n0:39311:39311 [3] NCCL INFO cudaDriverVersion 11040
x3006c0s1b1n0:39308:39480 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.253<0>
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Using network IB
x3006c0s1b1n0:39310:39310 [2] NCCL INFO Bootstrap : Using hsn0:10.201.1.253<0>
x3006c0s1b1n0:39310:39310 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3006c0s1b1n0:39309:39309 [1] NCCL INFO Bootstrap : Using hsn0:10.201.1.253<0>
x3006c0s1b1n0:39311:39311 [3] NCCL INFO Bootstrap : Using hsn0:10.201.1.253<0>
x3006c0s1b1n0:39309:39309 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3006c0s1b1n0:39311:39311 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3006c0s1b1n0:39310:39483 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.253<0>
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Using network IB
x3006c0s1b1n0:39309:39484 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.253<0>
x3006c0s1b1n0:39311:39485 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.253<0>
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Using network IB
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Using network IB
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] -1/-1/-1->2->0 [3] -1/-1/-1->2->0 [4] 0/-1/-1->2->-1 [5] 0/-1/-1->2->-1 [6] 1/-1/-1->2->3 [7] 1/-1/-1->2->3 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] -1/-1/-1->2->0 [11] -1/-1/-1->2->0 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] -1/-1/-1->2->0 [15] -1/-1/-1->2->0 [16] 0/-1/-1->2->-1 [17] 0/-1/-1->2->-1 [18] 1/-1/-1->2->3 [19] 1/-1/-1->2->3 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] -1/-1/-1->2->0 [23] -1/-1/-1->2->0
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 00/24 :    0   1   2   3
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 3/-1/-1->1->-1 [3] 3/-1/-1->1->-1 [4] -1/-1/-1->1->3 [5] -1/-1/-1->1->3 [6] 0/-1/-1->1->2 [7] 0/-1/-1->1->2 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 3/-1/-1->1->-1 [11] 3/-1/-1->1->-1 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 3/-1/-1->1->-1 [15] 3/-1/-1->1->-1 [16] -1/-1/-1->1->3 [17] -1/-1/-1->1->3 [18] 0/-1/-1->1->2 [19] 0/-1/-1->1->2 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 3/-1/-1->1->-1 [23] 3/-1/-1->1->-1
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] 0/-1/-1->3->1 [3] 0/-1/-1->3->1 [4] 1/-1/-1->3->0 [5] 1/-1/-1->3->0 [6] 2/-1/-1->3->-1 [7] 2/-1/-1->3->-1 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] 0/-1/-1->3->1 [11] 0/-1/-1->3->1 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] 0/-1/-1->3->1 [15] 0/-1/-1->3->1 [16] 1/-1/-1->3->0 [17] 1/-1/-1->3->0 [18] 2/-1/-1->3->-1 [19] 2/-1/-1->3->-1 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] 0/-1/-1->3->1 [23] 0/-1/-1->3->1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 01/24 :    0   1   3   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 02/24 :    0   2   3   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 03/24 :    0   2   1   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 04/24 :    0   3   1   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 05/24 :    0   3   2   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 06/24 :    0   1   2   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 07/24 :    0   1   3   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 08/24 :    0   2   3   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 09/24 :    0   2   1   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 10/24 :    0   3   1   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 11/24 :    0   3   2   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 12/24 :    0   1   2   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 13/24 :    0   1   3   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 14/24 :    0   2   3   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 15/24 :    0   2   1   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 16/24 :    0   3   1   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 17/24 :    0   3   2   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 18/24 :    0   1   2   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 19/24 :    0   1   3   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 20/24 :    0   2   3   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 21/24 :    0   2   1   3
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 22/24 :    0   3   1   2
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 23/24 :    0   3   2   1
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 2/-1/-1->0->3 [3] 2/-1/-1->0->3 [4] 3/-1/-1->0->2 [5] 3/-1/-1->0->2 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 2/-1/-1->0->3 [11] 2/-1/-1->0->3 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 2/-1/-1->0->3 [15] 2/-1/-1->0->3 [16] 3/-1/-1->0->2 [17] 3/-1/-1->0->2 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 2/-1/-1->0->3 [23] 2/-1/-1->0->3
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 00/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 02/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 04/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 06/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 06/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 08/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 10/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 12/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 06/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 12/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 14/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 07/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 16/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 18/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 12/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 18/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 20/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 13/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 22/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 18/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 19/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 01/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 04/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 07/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 10/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 03/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 07/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 13/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 08/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 09/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 16/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 09/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 13/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 19/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 14/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 15/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 22/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 15/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 19/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 20/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 21/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 21/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 01/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 02/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 04/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 03/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 05/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 05/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 05/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 07/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 08/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 10/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 09/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 11/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 11/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 11/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 13/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 14/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 16/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 15/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 17/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 17/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 17/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 19/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 20/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 22/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 21/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 23/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 23/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 23/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Connected all rings
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Connected all rings
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 01/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 07/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 08/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 09/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 13/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 01/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 19/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 07/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 20/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 09/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 08/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 21/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 13/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 09/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 19/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 20/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 21/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 21/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 02/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 04/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 05/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 10/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 11/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 02/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 04/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 14/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 03/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 05/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 16/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 05/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 10/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 17/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 11/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 11/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 22/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 14/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 16/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 23/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 15/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 17/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 17/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 22/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 23/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 23/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 00/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 01/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 06/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 02/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 00/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 07/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 01/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 08/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 14/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 06/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 12/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Channel 15/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 07/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 13/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 09/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 18/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 12/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 19/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 13/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Channel 20/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 18/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 19/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Channel 21/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39485 [3] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39311:39485 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39311:39485 [3] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39308:39480 [0] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:39480 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39308:39480 [0] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39310:39483 [2] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39310:39483 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39310:39483 [2] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39309:39484 [1] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39309:39484 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39309:39484 [1] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39308:39480 [0] NCCL INFO comm 0x557485f27b50 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3006c0s1b1n0:39311:39485 [3] NCCL INFO comm 0x561e320c1cb0 rank 3 nranks 4 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000087000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600200
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600200
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
x3006c0s1b1n0:39310:39483 [2] NCCL INFO comm 0x55c74e44f8f0 rank 2 nranks 4 cudaDev 2 busId 85000 - Init COMPLETE
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
x3006c0s1b1n0:39309:39484 [1] NCCL INFO comm 0x5613c5e94790 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum uint8_t uint8_t uint8_t uint8_t Elapsed time: 409 Elapsed time: 309 Elapsed time: 10 Elapsed time: 672 us
 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum uint8_t uint8_t uint8_t uint8_t Elapsed time: 1442588 Elapsed time: 774668 Elapsed time: 306381 Elapsed time: 6 us
 us
 us
 us
>>> done with compiling and loading fused kernels. Compilation time: 3.522 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat64/ncclDouble, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000063000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Min AllReduce RING double
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING LL Elapsed time: 10 AllReduce LL Min us
 RING Min double
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL double Elapsed time: 105 AllReduce Min Elapsed time: 4665 us
 RING double us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 LL Elapsed time: 3965 us
 AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING double AllReduce LL Elapsed time: 127 RING Sum us
 LL double
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum Elapsed time: 233 AllReduce doubletime to initialize megatron (seconds): 4.857 us
 RING Elapsed time: 4082
 LL us
 Sum double Elapsed time: 4799 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600200
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600200
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum uint8_t uint8_t Sum uint8_t Elapsed time: 138 Elapsed time: 203 uint8_t Elapsed time: 7 us
 us
 Elapsed time: 129 us
 us
[after megatron is initialized] datetime: 2023-10-23 19:35:14 
building BERT model ...
 > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 334723458
> learning rate decay style: linear
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum uint8_t uint8_t Sum uint8_t Elapsed time: 306 Elapsed time: 2982 uint8_t Elapsed time: 7331 us
 us
 Elapsed time: 10 us
 us
WARNING: could not find the metadata file /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m/latest_checkpointed_iteration.txt [LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24    will not load any checkpoints and will start from random[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum uint8_t uint8_t Sum uint8_t Elapsed time: 6 Elapsed time: 263 uint8_t Elapsed time: 240 us
 us
 Elapsed time: 168 us
 us
time (ms) | load-checkpoint: 0.77[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum uint8_t uint8_t Sum uint8_t Elapsed time: 157 Elapsed time: 6 uint8_t Elapsed time: 180 us
 us
 Elapsed time: 84 us
 us
[after model, optimizer, and learning rate scheduler are built] datetime: 2023-10-23 19:35:14 
> building train, validation, and test datasets ...
 > datasets target sizes (minimum size):
    train:      6400
    validation: 704
    test:       64
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.003394 seconds
 > indexed dataset stats:
    number of documents: 35
    number of sentences: 7860
 > dataset split:
    train:
     document indices in [0, 33) total of 33 documents
     sentence indices in [0, 7617) total of 7617 sentences
    validation:
     document indices in [33, 35) total of 2 documents
     sentence indices in [7617, 7860) total of 243 sentences
    test:
     document indices in [35, 35) total of 0 documents
     sentence indices in [7860, 7860) total of 0 sentences
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Using network IB
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Using network IB
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Using network IB
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Using network IB
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 00/24 :    0   1   2   3
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] 0/-1/-1->3->1 [3] 0/-1/-1->3->1 [4] 1/-1/-1->3->0 [5] 1/-1/-1->3->0 [6] 2/-1/-1->3->-1 [7] 2/-1/-1->3->-1 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] 0/-1/-1->3->1 [11] 0/-1/-1->3->1 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] 0/-1/-1->3->1 [15] 0/-1/-1->3->1 [16] 1/-1/-1->3->0 [17] 1/-1/-1->3->0 [18] 2/-1/-1->3->-1 [19] 2/-1/-1->3->-1 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] 0/-1/-1->3->1 [23] 0/-1/-1->3->1
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] -1/-1/-1->2->0 [3] -1/-1/-1->2->0 [4] 0/-1/-1->2->-1 [5] 0/-1/-1->2->-1 [6] 1/-1/-1->2->3 [7] 1/-1/-1->2->3 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] -1/-1/-1->2->0 [11] -1/-1/-1->2->0 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] -1/-1/-1->2->0 [15] -1/-1/-1->2->0 [16] 0/-1/-1->2->-1 [17] 0/-1/-1->2->-1 [18] 1/-1/-1->2->3 [19] 1/-1/-1->2->3 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] -1/-1/-1->2->0 [23] -1/-1/-1->2->0
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 3/-1/-1->1->-1 [3] 3/-1/-1->1->-1 [4] -1/-1/-1->1->3 [5] -1/-1/-1->1->3 [6] 0/-1/-1->1->2 [7] 0/-1/-1->1->2 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 3/-1/-1->1->-1 [11] 3/-1/-1->1->-1 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 3/-1/-1->1->-1 [15] 3/-1/-1->1->-1 [16] -1/-1/-1->1->3 [17] -1/-1/-1->1->3 [18] 0/-1/-1->1->2 [19] 0/-1/-1->1->2 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 3/-1/-1->1->-1 [23] 3/-1/-1->1->-1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 01/24 :    0   1   3   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 02/24 :    0   2   3   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 03/24 :    0   2   1   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 04/24 :    0   3   1   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 05/24 :    0   3   2   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 06/24 :    0   1   2   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 07/24 :    0   1   3   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 08/24 :    0   2   3   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 09/24 :    0   2   1   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 10/24 :    0   3   1   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 11/24 :    0   3   2   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 12/24 :    0   1   2   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 13/24 :    0   1   3   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 14/24 :    0   2   3   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 15/24 :    0   2   1   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 16/24 :    0   3   1   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 17/24 :    0   3   2   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 18/24 :    0   1   2   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 19/24 :    0   1   3   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 20/24 :    0   2   3   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 21/24 :    0   2   1   3
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 22/24 :    0   3   1   2
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 23/24 :    0   3   2   1
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 2/-1/-1->0->3 [3] 2/-1/-1->0->3 [4] 3/-1/-1->0->2 [5] 3/-1/-1->0->2 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 2/-1/-1->0->3 [11] 2/-1/-1->0->3 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 2/-1/-1->0->3 [15] 2/-1/-1->0->3 [16] 3/-1/-1->0->2 [17] 3/-1/-1->0->2 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 2/-1/-1->0->3 [23] 2/-1/-1->0->3
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 00/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 02/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 04/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 06/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 06/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 06/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 08/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 10/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 07/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 12/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 12/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 12/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 14/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 16/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 13/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 18/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 18/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 18/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 20/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 22/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 19/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 01/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 04/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 03/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 07/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 08/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 07/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 10/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 09/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 09/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 13/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 14/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 13/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 16/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 15/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 15/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 19/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 20/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 19/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 22/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 21/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 21/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 04/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 01/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 03/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 02/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 05/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 05/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 05/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 10/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 07/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 09/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 08/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 11/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 11/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 11/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 16/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 13/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 15/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 14/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 17/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 17/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 17/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 22/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 19/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 21/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 20/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 23/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 23/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 23/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Connected all rings
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Connected all rings
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 01/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 07/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 08/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 09/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 01/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 13/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 07/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 19/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 08/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 09/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 20/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 09/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 13/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 21/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 20/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 19/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 21/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 21/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 02/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 04/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 05/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 10/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 11/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 04/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 02/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 14/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 05/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 03/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 16/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 10/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 05/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 17/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 11/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 11/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 22/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 16/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 14/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 23/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 17/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 15/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 22/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 17/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 23/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 23/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 00/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 01/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 02/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 06/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 07/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 00/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 14/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 08/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 01/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Channel 15/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 12/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 06/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 13/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 07/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 18/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 09/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 19/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 12/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Channel 20/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 13/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 18/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 19/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Channel 21/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3006c0s1b1n0:39311:39544 [3] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39311:39544 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39311:39544 [3] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39308:39541 [0] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:39541 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39308:39541 [0] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39310:39542 [2] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39310:39542 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39310:39542 [2] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39309:39543 [1] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39309:39543 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3006c0s1b1n0:39309:39543 [1] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3006c0s1b1n0:39310:39542 [2] NCCL INFO comm 0x55c754802d70 rank 2 nranks 4 cudaDev 2 busId 85000 - Init COMPLETE
x3006c0s1b1n0:39308:39541 [0] NCCL INFO comm 0x5574a18c4250 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24x3006c0s1b1n0:39311:39544 [3] NCCL INFO comm 0x561e54dd2770 rank 3 nranks 4 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000062000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
x3006c0s1b1n0:39309:39543 [1] NCCL INFO comm 0x5613e44e3f20 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
NCCL version 2.14.3+cuda11.8[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96

[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24x3006c0s1b1n0:39310:39554 [2] NCCL INFO Using network IB
NCCL version 2.14.3+cuda11.8
NCCL version 2.14.3+cuda11.8
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Using network IB
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Using network IB
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Using network IB

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL Sum int64_t Elapsed time: 103 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING LL Sum int64_t Elapsed time: 54 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL Sum int64_t Elapsed time: 11 us
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 00/32 :    0

[LYD INFO in NCCL_KERN_NAME (common.h)] 2x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 01/32 :    0
 AllReducex3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 02/32 :    0
 RINGx3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 03/32 :    0
 LLx3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 04/32 :    0
 Sumx3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 05/32 :    0
 int64_tx3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Connected all rings
 Elapsed time: 520x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 07/32 :    0
 us
x3006c0s1b1n0:39311:39559 [3] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Connected all rings
x3006c0s1b1n0:39311:39559 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39310:39554 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Connected all rings
x3006c0s1b1n0:39308:39558 [0] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:39558 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39560 [1] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39309:39560 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39310:39554 [2] NCCL INFO comm 0x55c754806640 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
x3006c0s1b1n0:39311:39559 [3] NCCL INFO comm 0x561e54dd5200 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
x3006c0s1b1n0:39308:39558 [0] NCCL INFO comm 0x5574a18c6ce0 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
x3006c0s1b1n0:39309:39560 [1] NCCL INFO comm 0x5613e44e6de0 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
 > loading indexed mapping from /home/yuke/lyd/Megatron-LM/my-bert_text_sentence_train_indexmap_6400mns_509msl_0.10ssp_1234s.npy
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
    loaded indexed file in 0.001 seconds
    total number of samples: 6454
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum int64_t int64_t Sum int64_t Elapsed time: 255 Elapsed time: 849 int64_t Elapsed time: 11 us
 us
 Elapsed time: 524 us
 > loading indexed mapping from /home/yuke/lyd/Megatron-LM/my-bert_text_sentence_valid_indexmap_704mns_509msl_0.10ssp_1234s.npy us

    loaded indexed file in 0.001 seconds
    total number of samples: 705
> finished creating BERT datasets ...
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Using network IB
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Using network IB
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Using network IB
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Using network IB
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Connected all rings
x3006c0s1b1n0:39308:39572 [0] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:39572 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Connected all rings
x3006c0s1b1n0:39311:39574 [3] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39311:39574 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39310:39575 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:39576 [1] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39309:39576 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39308:39572 [0] NCCL INFO comm 0x5574a18c9770 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3006c0s1b1n0:39311:39574 [3] NCCL INFO comm 0x561e54dd7c90 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3006c0s1b1n0:39309:39576 [1] NCCL INFO comm 0x5613e44e9870 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
x3006c0s1b1n0:39310:39575 [2] NCCL INFO comm 0x55c75487c9e0 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000085000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000034000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum uint8_t uint8_t uint8_t uint8_t Elapsed time: 19408 Elapsed time: 11 Elapsed time: 22288 Elapsed time: 3017 us
 us
 us
 us
[after dataloaders are built] datetime: 2023-10-23 19:35:15 
time (ms) | model-and-optimizer-setup: 143.24 | train/valid/test-data-iterators-setup: 1113.18done with setup ...

training ...
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f4a05600400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum uint8_t uint8_t uint8_t uint8_t Elapsed time: 821 Elapsed time: 6 Elapsed time: 884 Elapsed time: 786 us
 us
 us
 us
[before the start of training step] datetime: 2023-10-23 19:35:15 
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000068000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000066000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000061000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000062000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 3167 Elapsed time: 12433 Elapsed time: 7135 Elapsed time: 11 us
 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000069000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 SIMPLE AllReduce AllReduce Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING RING half AllReduce SIMPLE SIMPLE Elapsed time: 21411 RING Sum Sum us
 SIMPLE half half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum Elapsed time: 20164 Elapsed time: 4241 AllReduce half us
 us
 RING Elapsed time: 9326
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 LL us
 AllReduce AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING RING half AllReduce LL LL Elapsed time: 21511 RING Sum Sum us
 LL half half Sum Elapsed time: 20270 Elapsed time: 4338 half us
 us
 Elapsed time: 9423 us
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Using network IB
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Using network IB
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Using network IB
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Using network IB
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Connected all rings
x3006c0s1b1n0:39310:40423 [2] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39310:40423 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Connected all rings
x3006c0s1b1n0:39309:40428 [1] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39309:40428 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 00/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 01/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 02/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 03/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 04/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 05/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 06/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 07/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 08/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 09/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 10/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 11/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 12/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 13/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 14/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 15/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Connected all rings
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 16/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 17/32 :    0
x3006c0s1b1n0:39311:40429 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 18/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 19/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 20/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 21/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 22/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 23/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 24/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 25/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 26/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 27/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 28/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 29/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 30/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Channel 31/32 :    0
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Connected all rings
x3006c0s1b1n0:39308:40425 [0] NCCL INFO Connected all trees by HAO
x3006c0s1b1n0:39308:40425 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3006c0s1b1n0:39310:40423 [2] NCCL INFO comm 0x55c788e1d550 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
x3006c0s1b1n0:39309:40428 [1] NCCL INFO comm 0x5614194b4fa0 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
x3006c0s1b1n0:39311:40429 [3] NCCL INFO comm 0x561e892c99d0 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
x3006c0s1b1n0:39308:40425 [0] NCCL INFO comm 0x5574d754bb50 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
 iteration        1/     100 | consumed samples:           64 | elapsed time per iteration (ms): 1847.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 4294967296.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 1184.88 | backward-compute: 532.28 | backward-params-all-reduce: 13.00 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.81 | optimizer-unscale-and-check-inf: 109.37 | optimizer: 113.27 | batch-generator: 459.65
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 6262 Elapsed time: 10989 Elapsed time: 5763 Elapsed time: 9 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000018000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING Sum AllReduce RING SIMPLE half RING SIMPLE Sum Elapsed time: 8846 SIMPLE Sum half us
 Sum half Elapsed time: 8692
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half Elapsed time: 7700 us
 AllReduce Elapsed time: 4881 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING Sum AllReduce RING LL half RING LL Sum Elapsed time: 8947 LL Sum half us
 Sum half Elapsed time: 8794 half Elapsed time: 7805 us
 Elapsed time: 4980 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration        2/     100 | consumed samples:          128 | elapsed time per iteration (ms): 192.3 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 2147483648.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
time (ms) | forward-compute: 76.25 | backward-compute: 100.23 | backward-params-all-reduce: 6.88 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.44 | optimizer-unscale-and-check-inf: 3.18 | optimizer: 6.79 | batch-generator: 0.93[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes

[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000014000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 3868 Elapsed time: 3569 Elapsed time: 7 Elapsed time: 2041 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING Sum AllReduce RING SIMPLE half RING SIMPLE Sum Elapsed time: 7384 SIMPLE Sum half us
 Sum half Elapsed time: 6974
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half Elapsed time: 6460 us
 AllReduce Elapsed time: 5025 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING Sum AllReduce RING LL half RING LL Sum Elapsed time: 7485 LL Sum half us
 Sum half Elapsed time: 7075 half Elapsed time: 6566 us
 Elapsed time: 5125 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
 iteration        3/     100 | consumed samples:          192 | elapsed time per iteration (ms): 186.5 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 1073741824.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 72.80 | backward-compute: 98.83 | backward-params-all-reduce: 6.74 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 2.95 | optimizer: 6.35 | batch-generator: 1.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 235 Elapsed time: 7 Elapsed time: 144 Elapsed time: 381 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce SIMPLE SIMPLE AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 5422 Elapsed time: 5676 Sum half us
 us
 half Elapsed time: 5249
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5063 us
 AllReduce AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce LL LL AllReduce RING Sum Sum RING LL half half LL Sum Elapsed time: 5521 Elapsed time: 5775 Sum half us
 us
 half Elapsed time: 5355 Elapsed time: 5163 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000050000 seconds
 iteration        4/     100 | consumed samples:          256 | elapsed time per iteration (ms): 182.6 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 536870912.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
time (ms) | forward-compute: 70.12 | backward-compute: 97.00 | backward-params-all-reduce: 6.77 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 3.23 | optimizer: 6.66 | batch-generator: 0.77[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes

[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 1633 Elapsed time: 8 Elapsed time: 1686 Elapsed time: 1831 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce Sum AllReduce AllReduce RING half RING RING SIMPLE Elapsed time: 5324 SIMPLE SIMPLE Sum us
 Sum Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half half Elapsed time: 5213 AllReduce Elapsed time: 5176 Elapsed time: 5046 us
 RING us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce Sum AllReduce AllReduce RING half RING RING LL Elapsed time: 5425 LL LL Sum us
 Sum Sum half half half Elapsed time: 5313 Elapsed time: 5280 Elapsed time: 5146 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
 iteration        5/     100 | consumed samples:          320 | elapsed time per iteration (ms): 183.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 268435456.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.76 | backward-compute: 97.14 | backward-params-all-reduce: 6.76 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 2.93 | optimizer: 6.34 | batch-generator: 1.46
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 48 Elapsed time: 86 Elapsed time: 227 Elapsed time: 7 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000044000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING Sum AllReduce RING SIMPLE half RING SIMPLE Sum Elapsed time: 5025 SIMPLE Sum half us
 Sum half Elapsed time: 5595
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half Elapsed time: 5021 us
 AllReduce Elapsed time: 6256 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING Sum AllReduce RING LL half RING LL Sum Elapsed time: 5133 LL Sum half us
 Sum half Elapsed time: 5695 half Elapsed time: 5122 us
 Elapsed time: 6356 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
 iteration        6/     100 | consumed samples:          384 | elapsed time per iteration (ms): 182.3 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 134217728.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.08 | backward-compute: 96.96 | backward-params-all-reduce: 7.31 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 2.95 | optimizer: 6.34 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 142 Elapsed time: 189 Elapsed time: 7 Elapsed time: 57 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING SIMPLE AllReduce RING SIMPLE Sum RING SIMPLE Sum half SIMPLE Sum half Elapsed time: 5590 Sum half Elapsed time: 5816 us
 half Elapsed time: 5402 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5057 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL AllReduce RING LL Sum RING LL Sum half LL Sum half Elapsed time: 5691 Sum half Elapsed time: 5918 us
 half Elapsed time: 5509 us
 Elapsed time: 5157 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
 iteration        7/     100 | consumed samples:          448 | elapsed time per iteration (ms): 182.7 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 67108864.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.17 | backward-compute: 97.76 | backward-params-all-reduce: 6.77 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 2.95 | optimizer: 6.35 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000059000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 611 Elapsed time: 7 Elapsed time: 426 Elapsed time: 585 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 RING AllReduce RING AllReduce SIMPLE RING SIMPLE RING Sum SIMPLE Sum SIMPLE half Sum half Sum Elapsed time: 5483 half Elapsed time: 6041 half us
 Elapsed time: 4975 us
 Elapsed time: 5188
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL half Sum half Sum Elapsed time: 5583 half Elapsed time: 6144 half us
 Elapsed time: 5081 us
 Elapsed time: 5288 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
 iteration        8/     100 | consumed samples:          512 | elapsed time per iteration (ms): 182.6 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 33554432.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.45 | backward-compute: 96.97 | backward-params-all-reduce: 7.20 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.34 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 324 Elapsed time: 201 Elapsed time: 62 Elapsed time: 7 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING SIMPLE AllReduce RING SIMPLE Sum RING SIMPLE Sum half SIMPLE Sum half Elapsed time: 6242 Sum half Elapsed time: 6135 us
 half Elapsed time: 5546 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5054 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL AllReduce RING LL Sum RING LL Sum half LL Sum half Elapsed time: 6343 Sum half Elapsed time: 6236 us
 half Elapsed time: 5650 us
 Elapsed time: 5154 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration        9/     100 | consumed samples:          576 | elapsed time per iteration (ms): 182.9 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 16777216.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.25 | backward-compute: 97.90 | backward-params-all-reduce: 6.74 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 2.95 | optimizer: 6.35 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 7 Elapsed time: 349 Elapsed time: 98 Elapsed time: 295 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING Sum AllReduce RING SIMPLE half RING SIMPLE Sum Elapsed time: 5858 SIMPLE Sum half us
 Sum half Elapsed time: 6270
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half Elapsed time: 5584 us
 AllReduce Elapsed time: 5071 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING Sum AllReduce RING LL half RING LL Sum Elapsed time: 5958 LL Sum half us
 Sum half Elapsed time: 6370 half Elapsed time: 5689 us
 Elapsed time: 5171 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
 iteration       10/     100 | consumed samples:          640 | elapsed time per iteration (ms): 182.6 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 8388608.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.28 | backward-compute: 97.45 | backward-params-all-reduce: 6.79 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.34 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000074000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000081000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000070000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000068000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b33ffa00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b33ffa00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 16309 Elapsed time: 15354 Elapsed time: 7 Elapsed time: 17262 us
 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 10 | lm loss value: 1.046254E+01 | lm loss PPL: 3.498041E+04 | sop loss value: 8.416327E-01 | sop loss PPL: 2.320152E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 64 Elapsed time: 7 Elapsed time: 244 Elapsed time: 106 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING SIMPLE AllReduce AllReduce SIMPLE Sum RING RING Sum half SIMPLE SIMPLE half Elapsed time: 5708 Sum Sum Elapsed time: 6041 us
 half half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5044 Elapsed time: 5546
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce us
 us
 AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING LL AllReduce AllReduce LL Sum RING RING Sum half LL LL half Elapsed time: 5809 Sum Sum Elapsed time: 6143 us
 half half us
 Elapsed time: 5144 Elapsed time: 5652 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
 iteration       11/     100 | consumed samples:          704 | elapsed time per iteration (ms): 449.6 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 4194304.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 334.93 | backward-compute: 97.35 | backward-params-all-reduce: 6.75 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 2.89 | optimizer: 6.30 | batch-generator: 1.61
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 740 Elapsed time: 975 Elapsed time: 763 Elapsed time: 7 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING SIMPLE RING RING SIMPLE Sum SIMPLE SIMPLE Sum half Sum Sum half Elapsed time: 5863 half half Elapsed time: 5731 us
 Elapsed time: 5331 Elapsed time: 4980 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum half Sum Sum half Elapsed time: 5965 half half Elapsed time: 5833 us
 Elapsed time: 5431 Elapsed time: 5087 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       12/     100 | consumed samples:          768 | elapsed time per iteration (ms): 183.3 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 2097152.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.83 | backward-compute: 97.29 | backward-params-all-reduce: 7.08 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 3.01 | optimizer: 6.42 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000061000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000057000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 163 Elapsed time: 365 Elapsed time: 206 Elapsed time: 8 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce SIMPLE SIMPLE AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 5138 Elapsed time: 5396 Sum half us
 us
 half Elapsed time: 5059
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5071 us
 AllReduce AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce LL LL AllReduce RING Sum Sum RING LL half half LL Sum Elapsed time: 5239 Elapsed time: 5496 Sum half us
 us
 half Elapsed time: 5164 Elapsed time: 5171 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
 iteration       13/     100 | consumed samples:          832 | elapsed time per iteration (ms): 182.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 1048576.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.11 | backward-compute: 97.00 | backward-params-all-reduce: 6.79 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.31 | optimizer-unscale-and-check-inf: 3.00 | optimizer: 6.40 | batch-generator: 0.83
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 7 Elapsed time: 348 Elapsed time: 15 Elapsed time: 251 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING Sum AllReduce RING SIMPLE half RING SIMPLE Sum Elapsed time: 6253 SIMPLE Sum half us
 Sum half Elapsed time: 5341
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half Elapsed time: 5707 us
 AllReduce Elapsed time: 4942 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING Sum AllReduce RING LL half RING LL Sum Elapsed time: 6356 LL Sum half us
 Sum half Elapsed time: 5440 half Elapsed time: 5808 us
 Elapsed time: 5051 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
 iteration       14/     100 | consumed samples:          896 | elapsed time per iteration (ms): 182.4 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 524288.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.04 | backward-compute: 97.59 | backward-params-all-reduce: 7.05 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 2.69 | optimizer: 6.10 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 848 Elapsed time: 997 Elapsed time: 1293 Elapsed time: 7 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum AllReduce RING AllReduce half RING SIMPLE RING Elapsed time: 6258 SIMPLE Sum SIMPLE us
 Sum half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half Elapsed time: 5246 half AllReduce Elapsed time: 5886 us
 Elapsed time: 4980 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum AllReduce RING AllReduce half RING LL RING Elapsed time: 6357 LL Sum LL us
 Sum half Sum half Elapsed time: 5346 half Elapsed time: 5986 us
 Elapsed time: 5085 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000060000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       15/     100 | consumed samples:          960 | elapsed time per iteration (ms): 183.5 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 262144.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.05 | backward-compute: 97.63 | backward-params-all-reduce: 6.96 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 2.58 | optimizer: 5.99 | batch-generator: 0.80
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 7 Elapsed time: 1226 Elapsed time: 826 Elapsed time: 1514 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 RING AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce Sum AllReduce SIMPLE RING half RING Sum SIMPLE Elapsed time: 6071 SIMPLE half Sum us
 Sum Elapsed time: 6151 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half us
 Elapsed time: 5449 AllReduce Elapsed time: 5027
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us
 RING us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING AllReduce Sum AllReduce LL RING half RING Sum LL Elapsed time: 6173 LL half Sum us
 Sum Elapsed time: 6254 half half us
 Elapsed time: 5551 Elapsed time: 5127 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
 iteration       16/     100 | consumed samples:         1024 | elapsed time per iteration (ms): 184.1 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 131072.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.42 | backward-compute: 98.13 | backward-params-all-reduce: 6.74 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 2.69 | optimizer: 6.09 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000081000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000085000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000082000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000078000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b3231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum float float float float Elapsed time: 3552 Elapsed time: 4084 Elapsed time: 5620 Elapsed time: 7 us
 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000015000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f48b8000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce Sum AllReduce AllReduce RING half RING RING SIMPLE Elapsed time: 5856 SIMPLE SIMPLE Sum us
 Sum Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half half Elapsed time: 5353 AllReduce Elapsed time: 5750 Elapsed time: 5006 us
 RING us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum AllReduce AllReduce RING half RING RING LL Elapsed time: 5958 LL LL Sum us
 Sum Sum half half half Elapsed time: 5453 Elapsed time: 5849 Elapsed time: 5112 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
Traceback (most recent call last):
Traceback (most recent call last):
  File "/home/yuke/lyd/Megatron-LM/pretrain_bert.py", line 146, in <module>
  File "/home/yuke/lyd/Megatron-LM/pretrain_bert.py", line 146, in <module>
Traceback (most recent call last):
  File "/home/yuke/lyd/Megatron-LM/pretrain_bert.py", line 146, in <module>
    pretrain(train_valid_test_datasets_provider, model_provider,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 154, in pretrain
Traceback (most recent call last):
  File "/home/yuke/lyd/Megatron-LM/pretrain_bert.py", line 146, in <module>
    pretrain(train_valid_test_datasets_provider, model_provider,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 154, in pretrain
    pretrain(train_valid_test_datasets_provider, model_provider,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 154, in pretrain
    iteration = train(forward_step_func,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 741, in train
    iteration = train(forward_step_func,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 741, in train
    iteration = train(forward_step_func,    
pretrain(train_valid_test_datasets_provider, model_provider,  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 741, in train

  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 154, in pretrain
        train_step(forward_step_func,train_step(forward_step_func,

  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 498, in train_step
      File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 498, in train_step
iteration = train(forward_step_func,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 741, in train
    train_step(forward_step_func,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 498, in train_step
    update_successful, grad_norm, num_zeros_in_grad = optimizer.step()
      File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
update_successful, grad_norm, num_zeros_in_grad = optimizer.step()
      File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
train_step(forward_step_func,
  File "/home/yuke/lyd/Megatron-LM/megatron/training.py", line 498, in train_step
    update_successful, grad_norm, num_zeros_in_grad = optimizer.step()
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
        return func(*args, **kwargs)return func(*args, **kwargs)

      File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 423, in step
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 423, in step
update_successful, grad_norm, num_zeros_in_grad = optimizer.step()
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 423, in step
    return func(*args, **kwargs)
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 423, in step
        grad_norm = self.clip_grad_norm(self.clip_grad)grad_norm = self.clip_grad_norm(self.clip_grad)

  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 97, in clip_grad_norm
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 97, in clip_grad_norm
        grad_norm = self.clip_grad_norm(self.clip_grad)grad_norm = self.clip_grad_norm(self.clip_grad)

      File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 97, in clip_grad_norm
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/optimizer.py", line 97, in clip_grad_norm
return clip_grad_norm_fp32(params, clip_grad)
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/clip_grads.py", line 95, in clip_grad_norm_fp32
    return clip_grad_norm_fp32(params, clip_grad)
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/clip_grads.py", line 95, in clip_grad_norm_fp32
    return clip_grad_norm_fp32(params, clip_grad)
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/clip_grads.py", line 95, in clip_grad_norm_fp32
        grad_norm, _ = multi_tensor_applier(grad_norm, _ = multi_tensor_applier(

  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/apex/multi_tensor_apply/multi_tensor_apply.py", line 27, in __call__
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/apex/multi_tensor_apply/multi_tensor_apply.py", line 27, in __call__
    return clip_grad_norm_fp32(params, clip_grad)
  File "/home/yuke/lyd/Megatron-LM/megatron/optimizer/clip_grads.py", line 95, in clip_grad_norm_fp32
    grad_norm, _ = multi_tensor_applier(
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/apex/multi_tensor_apply/multi_tensor_apply.py", line 27, in __call__
        return op(self.chunk_size,return op(self.chunk_size,

RuntimeErrorRuntimeError: : CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    
grad_norm, _ = multi_tensor_applier(
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/apex/multi_tensor_apply/multi_tensor_apply.py", line 27, in __call__
    return op(self.chunk_size,
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

    return op(self.chunk_size,
RuntimeError: CUDA error: no kernel image is available for execution on the device
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

x3006c0s1b1n0:39311:39492 [3] NCCL INFO [Service thread] Connection closed by localRank 3
x3006c0s1b1n0:39308:39494 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39309:39495 [1] NCCL INFO [Service thread] Connection closed by localRank 1
x3006c0s1b1n0:39310:39493 [2] NCCL INFO [Service thread] Connection closed by localRank 2
x3006c0s1b1n0:39311:39311 [3] NCCL INFO comm 0x561e320c1cb0 rank 3 nranks 4 cudaDev 3 busId c7000 - Abort COMPLETE
x3006c0s1b1n0:39311:39578 [3] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39311:39311 [3] NCCL INFO comm 0x561e54dd7c90 rank 0 nranks 1 cudaDev 3 busId c7000 - Abort COMPLETE
x3006c0s1b1n0:39311:39562 [3] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39311:39311 [3] NCCL INFO comm 0x561e54dd5200 rank 0 nranks 1 cudaDev 3 busId c7000 - Abort COMPLETE
x3006c0s1b1n0:39311:40432 [3] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39311:39311 [3] NCCL INFO comm 0x561e892c99d0 rank 0 nranks 1 cudaDev 3 busId c7000 - Abort COMPLETE
x3006c0s1b1n0:39311:39545 [3] NCCL INFO [Service thread] Connection closed by localRank 3
x3006c0s1b1n0:39308:39308 [0] NCCL INFO comm 0x557485f27b50 rank 0 nranks 4 cudaDev 0 busId 7000 - Abort COMPLETE
x3006c0s1b1n0:39308:39577 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39308:39308 [0] NCCL INFO comm 0x5574a18c9770 rank 0 nranks 1 cudaDev 0 busId 7000 - Abort COMPLETE
x3006c0s1b1n0:39308:39563 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39309:39309 [1] NCCL INFO comm 0x5613c5e94790 rank 1 nranks 4 cudaDev 1 busId 46000 - Abort COMPLETE
x3006c0s1b1n0:39308:39308 [0] NCCL INFO comm 0x5574a18c6ce0 rank 0 nranks 1 cudaDev 0 busId 7000 - Abort COMPLETE
x3006c0s1b1n0:39308:40433 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39309:39580 [1] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39310:39310 [2] NCCL INFO comm 0x55c74e44f8f0 rank 2 nranks 4 cudaDev 2 busId 85000 - Abort COMPLETE
x3006c0s1b1n0:39308:39308 [0] NCCL INFO comm 0x5574d754bb50 rank 0 nranks 1 cudaDev 0 busId 7000 - Abort COMPLETE
x3006c0s1b1n0:39310:39579 [2] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39308:39546 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39309:39309 [1] NCCL INFO comm 0x5613e44e9870 rank 0 nranks 1 cudaDev 1 busId 46000 - Abort COMPLETE
x3006c0s1b1n0:39309:39564 [1] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39310:39310 [2] NCCL INFO comm 0x55c75487c9e0 rank 0 nranks 1 cudaDev 2 busId 85000 - Abort COMPLETE
x3006c0s1b1n0:39310:39561 [2] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39309:39309 [1] NCCL INFO comm 0x5613e44e6de0 rank 0 nranks 1 cudaDev 1 busId 46000 - Abort COMPLETE
x3006c0s1b1n0:39309:40431 [1] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39310:39310 [2] NCCL INFO comm 0x55c754806640 rank 0 nranks 1 cudaDev 2 busId 85000 - Abort COMPLETE
x3006c0s1b1n0:39310:40430 [2] NCCL INFO [Service thread] Connection closed by localRank 0
x3006c0s1b1n0:39309:39309 [1] NCCL INFO comm 0x5614194b4fa0 rank 0 nranks 1 cudaDev 1 busId 46000 - Abort COMPLETE
x3006c0s1b1n0:39309:39547 [1] NCCL INFO [Service thread] Connection closed by localRank 1
x3006c0s1b1n0:39310:39310 [2] NCCL INFO comm 0x55c788e1d550 rank 0 nranks 1 cudaDev 2 busId 85000 - Abort COMPLETE
x3006c0s1b1n0:39310:39548 [2] NCCL INFO [Service thread] Connection closed by localRank 2
x3006c0s1b1n0:39311:39311 [3] NCCL INFO comm 0x561e54dd2770 rank 3 nranks 4 cudaDev 3 busId c7000 - Abort COMPLETE
x3006c0s1b1n0:39308:39308 [0] NCCL INFO comm 0x5574a18c4250 rank 0 nranks 4 cudaDev 0 busId 7000 - Abort COMPLETE
x3006c0s1b1n0:39309:39309 [1] NCCL INFO comm 0x5613e44e3f20 rank 1 nranks 4 cudaDev 1 busId 46000 - Abort COMPLETE
x3006c0s1b1n0:39310:39310 [2] NCCL INFO comm 0x55c754802d70 rank 2 nranks 4 cudaDev 2 busId 85000 - Abort COMPLETE
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 39308) of binary: /home/yuke/lyd/conda3/envs/pytorchNCCL-hao/bin/python
Traceback (most recent call last):
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launch.py", line 196, in <module>
    main()
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launch.py", line 192, in main
    launch(args)
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launch.py", line 177, in launch
    run(args)
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
pretrain_bert.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2023-10-23_19:35:22
  host      : x3006c0s1b1n0.hsn.cm.polaris.alcf.anl.gov
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 39309)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2023-10-23_19:35:22
  host      : x3006c0s1b1n0.hsn.cm.polaris.alcf.anl.gov
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 39310)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2023-10-23_19:35:22
  host      : x3006c0s1b1n0.hsn.cm.polaris.alcf.anl.gov
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 39311)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2023-10-23_19:35:22
  host      : x3006c0s1b1n0.hsn.cm.polaris.alcf.anl.gov
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 39308)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
