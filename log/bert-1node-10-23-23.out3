10.140.57.82 10.201.1.221 10.201.1.220 
10.201.1.220
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/distributed/launch.py:181: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use-env is set by default in torchrun.
If your script expects `--local-rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
using world size: 4, data-parallel-size: 4, tensor-model-parallel size: 1, pipeline-model-parallel size: 1 
using torch.float16 for parameters ...
Gradient accumulation fusion to linear layer weight gradient computation is supported only with fp32 gradient accumulation. Setting gradient_accumulation_fusion to False
------------------------ arguments ------------------------
  accumulate_allreduce_grads_in_fp32 .............. False
  adam_beta1 ...................................... 0.9
  adam_beta2 ...................................... 0.999
  adam_eps ........................................ 1e-08
  adlr_autoresume ................................. False
  adlr_autoresume_interval ........................ 1000
  apply_query_key_layer_scaling ................... True
  apply_residual_connection_post_layernorm ........ False
  async_tensor_model_parallel_allreduce ........... True
  attention_dropout ............................... 0.1
  attention_softmax_in_fp32 ....................... False
  bert_binary_head ................................ True
  bert_load ....................................... None
  bf16 ............................................ False
  bias_dropout_fusion ............................. True
  bias_gelu_fusion ................................ True
  biencoder_projection_dim ........................ 0
  biencoder_shared_query_context_model ............ False
  block_data_path ................................. None
  classes_fraction ................................ 1.0
  clip_grad ....................................... 1.0
  consumed_train_samples .......................... 0
  consumed_valid_samples .......................... 0
  data_impl ....................................... infer
  data_parallel_random_init ....................... False
  data_parallel_size .............................. 4
  data_path ....................................... ['/home/yuke/lyd/Megatron-LM/my-bert_text_sentence']
  data_per_class_fraction ......................... 1.0
  data_sharding ................................... True
  dataloader_type ................................. single
  DDP_impl ........................................ local
  decoder_seq_length .............................. None
  dino_bottleneck_size ............................ 256
  dino_freeze_last_layer .......................... 1
  dino_head_hidden_size ........................... 2048
  dino_local_crops_number ......................... 10
  dino_local_img_size ............................. 96
  dino_norm_last_layer ............................ False
  dino_teacher_temp ............................... 0.07
  dino_warmup_teacher_temp ........................ 0.04
  dino_warmup_teacher_temp_epochs ................. 30
  distribute_saved_activations .................... False
  distributed_backend ............................. nccl
  embedding_path .................................. None
  empty_unused_memory_level ....................... 0
  encoder_seq_length .............................. 512
  end_weight_decay ................................ 0.01
  eod_mask_loss ................................... False
  eval_interval ................................... 10
  eval_iters ...................................... 1
  evidence_data_path .............................. None
  exit_duration_in_mins ........................... None
  exit_interval ................................... None
  exit_signal_handler ............................. False
  ffn_hidden_size ................................. 4096
  finetune ........................................ False
  fp16 ............................................ True
  fp16_lm_cross_entropy ........................... False
  fp32_residual_connection ........................ False
  global_batch_size ............................... 64
  gradient_accumulation_fusion .................... False
  head_lr_mult .................................... 1.0
  hidden_dropout .................................. 0.1
  hidden_size ..................................... 1024
  hysteresis ...................................... 2
  ict_head_size ................................... None
  ict_load ........................................ None
  img_h ........................................... 224
  img_w ........................................... 224
  indexer_batch_size .............................. 128
  indexer_log_interval ............................ 1000
  inference_batch_times_seqlen_threshold .......... 512
  init_method_std ................................. 0.02
  init_method_xavier_uniform ...................... False
  initial_loss_scale .............................. 4294967296
  iter_per_epoch .................................. 1250
  kv_channels ..................................... 64
  layernorm_epsilon ............................... 1e-05
  lazy_mpu_init ................................... None
  load ............................................ /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
  local_rank ...................................... 0
  log_batch_size_to_tensorboard ................... False
  log_interval .................................... 1
  log_learning_rate_to_tensorboard ................ True
  log_loss_scale_to_tensorboard ................... True
  log_memory_to_tensorboard ....................... False
  log_num_zeros_in_grad ........................... False
  log_params_norm ................................. False
  log_timers_to_tensorboard ....................... False
  log_validation_ppl_to_tensorboard ............... False
  log_world_size_to_tensorboard ................... False
  loss_scale ...................................... None
  loss_scale_window ............................... 1000
  lr .............................................. 0.0001
  lr_decay_iters .................................. 49
  lr_decay_samples ................................ None
  lr_decay_style .................................. linear
  lr_warmup_fraction .............................. 0.01
  lr_warmup_iters ................................. 0
  lr_warmup_samples ............................... 0
  make_vocab_size_divisible_by .................... 128
  mask_factor ..................................... 1.0
  mask_prob ....................................... 0.15
  mask_type ....................................... random
  masked_softmax_fusion ........................... True
  max_position_embeddings ......................... 512
  merge_file ...................................... None
  micro_batch_size ................................ 16
  min_loss_scale .................................. 1.0
  min_lr .......................................... 1e-05
  mmap_warmup ..................................... False
  no_load_optim ................................... None
  no_load_rng ..................................... None
  no_persist_layer_norm ........................... False
  no_save_optim ................................... None
  no_save_rng ..................................... None
  num_attention_heads ............................. 16
  num_channels .................................... 3
  num_classes ..................................... 1000
  num_experts ..................................... None
  num_layers ...................................... 24
  num_layers_per_virtual_pipeline_stage ........... None
  num_workers ..................................... 2
  onnx_safe ....................................... None
  openai_gelu ..................................... False
  optimizer ....................................... adam
  override_opt_param_scheduler .................... False
  params_dtype .................................... torch.float16
  patch_dim ....................................... 16
  pipeline_model_parallel_size .................... 1
  pipeline_model_parallel_split_rank .............. None
  query_in_block_prob ............................. 0.1
  rampup_batch_size ............................... None
  rank ............................................ 0
  recompute_granularity ........................... None
  recompute_method ................................ uniform
  recompute_num_layers ............................ 1
  reset_attention_mask ............................ False
  reset_position_ids .............................. False
  retriever_report_topk_accuracies ................ []
  retriever_score_scaling ......................... False
  retriever_seq_length ............................ 256
  sample_rate ..................................... 1.0
  save ............................................ /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
  save_interval ................................... 50
  scatter_gather_tensors_in_pipeline .............. True
  seed ............................................ 1234
  seq_length ...................................... 512
  sequence_parallel ............................... False
  sgd_momentum .................................... 0.9
  short_seq_prob .................................. 0.1
  split ........................................... 949,50,1
  standalone_embedding_stage ...................... False
  start_weight_decay .............................. 0.01
  swin_backbone_type .............................. tiny
  tensor_model_parallel_size ...................... 1
  tensorboard_dir ................................. None
  tensorboard_log_interval ........................ 1
  tensorboard_queue_size .......................... 1000
  titles_data_path ................................ None
  tokenizer_type .................................. BertWordPieceLowerCase
  train_iters ..................................... 100
  train_samples ................................... None
  transformer_pipeline_model_parallel_size ........ 1
  use_checkpoint_opt_param_scheduler .............. False
  use_contiguous_buffers_in_local_ddp ............. True
  use_cpu_initialization .......................... None
  use_one_sent_docs ............................... False
  virtual_pipeline_model_parallel_size ............ None
  vision_backbone_type ............................ vit
  vision_pretraining .............................. False
  vision_pretraining_type ......................... classify
  vocab_extra_ids ................................. 0
  vocab_file ...................................... /home/yuke/lyd/Megatron-LM/model/bert-large-cased-vocab.txt
  weight_decay .................................... 0.01
  weight_decay_incr_style ......................... constant
  world_size ...................................... 4
-------------------- end of arguments ---------------------
setting number of micro-batches to constant 1
> building BertWordPieceLowerCase tokenizer ...
 > padded vocab (size: 28998) with 58 dummy tokens (new size: 29056)
> initializing torch distributed ...
> initializing tensor model parallel with size 1
> initializing pipeline model parallel with size 1
> setting random seeds to 1234 ...
> initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
> compiling dataset index builder ...
make: Entering directory '/home/yuke/lyd/Megatron-LM/megatron/data'
make: Nothing to be done for 'default'.
make: Leaving directory '/home/yuke/lyd/Megatron-LM/megatron/data'
>>> done with dataset index builder. Compilation time: 0.049 seconds
> compiling and loading fused kernels ...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module scaled_upper_triang_masked_softmax_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module scaled_upper_triang_masked_softmax_cuda...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module scaled_masked_softmax_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module scaled_masked_softmax_cuda...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module scaled_softmax_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module scaled_softmax_cuda...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/yuke/lyd/Megatron-LM/megatron/fused_kernels/build/build.ninja...
Building extension module fused_mix_prec_layer_norm_cuda...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_mix_prec_layer_norm_cuda...
x3005c0s19b1n0:15895:15895 [0] NCCL INFO Bootstrap : Using hsn0:10.201.1.220<0>
x3005c0s19b1n0:15895:15895 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3005c0s19b1n0:15895:15895 [0] NCCL INFO cudaDriverVersion 11040
NCCL version 2.14.3+cuda11.8
x3005c0s19b1n0:15897:15897 [2] NCCL INFO cudaDriverVersion 11040
x3005c0s19b1n0:15896:15896 [1] NCCL INFO cudaDriverVersion 11040
x3005c0s19b1n0:15898:15898 [3] NCCL INFO cudaDriverVersion 11040
x3005c0s19b1n0:15895:16180 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.220<0>
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Using network IB
x3005c0s19b1n0:15897:15897 [2] NCCL INFO Bootstrap : Using hsn0:10.201.1.220<0>
x3005c0s19b1n0:15897:15897 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3005c0s19b1n0:15896:15896 [1] NCCL INFO Bootstrap : Using hsn0:10.201.1.220<0>
x3005c0s19b1n0:15896:15896 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3005c0s19b1n0:15898:15898 [3] NCCL INFO Bootstrap : Using hsn0:10.201.1.220<0>
x3005c0s19b1n0:15898:15898 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
x3005c0s19b1n0:15896:16184 [1] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.220<0>
x3005c0s19b1n0:15897:16183 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.220<0>
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Using network IB
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Using network IB
x3005c0s19b1n0:15898:16189 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/RoCE [1]mlx5_1:1/RoCE [RO]; OOB hsn0:10.201.1.220<0>
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Using network IB
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 00/24 :    0   1   2   3
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] 0/-1/-1->3->1 [3] 0/-1/-1->3->1 [4] 1/-1/-1->3->0 [5] 1/-1/-1->3->0 [6] 2/-1/-1->3->-1 [7] 2/-1/-1->3->-1 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] 0/-1/-1->3->1 [11] 0/-1/-1->3->1 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] 0/-1/-1->3->1 [15] 0/-1/-1->3->1 [16] 1/-1/-1->3->0 [17] 1/-1/-1->3->0 [18] 2/-1/-1->3->-1 [19] 2/-1/-1->3->-1 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] 0/-1/-1->3->1 [23] 0/-1/-1->3->1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 01/24 :    0   1   3   2
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 3/-1/-1->1->-1 [3] 3/-1/-1->1->-1 [4] -1/-1/-1->1->3 [5] -1/-1/-1->1->3 [6] 0/-1/-1->1->2 [7] 0/-1/-1->1->2 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 3/-1/-1->1->-1 [11] 3/-1/-1->1->-1 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 3/-1/-1->1->-1 [15] 3/-1/-1->1->-1 [16] -1/-1/-1->1->3 [17] -1/-1/-1->1->3 [18] 0/-1/-1->1->2 [19] 0/-1/-1->1->2 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 3/-1/-1->1->-1 [23] 3/-1/-1->1->-1
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] -1/-1/-1->2->0 [3] -1/-1/-1->2->0 [4] 0/-1/-1->2->-1 [5] 0/-1/-1->2->-1 [6] 1/-1/-1->2->3 [7] 1/-1/-1->2->3 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] -1/-1/-1->2->0 [11] -1/-1/-1->2->0 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] -1/-1/-1->2->0 [15] -1/-1/-1->2->0 [16] 0/-1/-1->2->-1 [17] 0/-1/-1->2->-1 [18] 1/-1/-1->2->3 [19] 1/-1/-1->2->3 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] -1/-1/-1->2->0 [23] -1/-1/-1->2->0
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 02/24 :    0   2   3   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 03/24 :    0   2   1   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 04/24 :    0   3   1   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 05/24 :    0   3   2   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 06/24 :    0   1   2   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 07/24 :    0   1   3   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 08/24 :    0   2   3   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 09/24 :    0   2   1   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 10/24 :    0   3   1   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 11/24 :    0   3   2   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 12/24 :    0   1   2   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 13/24 :    0   1   3   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 14/24 :    0   2   3   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 15/24 :    0   2   1   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 16/24 :    0   3   1   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 17/24 :    0   3   2   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 18/24 :    0   1   2   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 19/24 :    0   1   3   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 20/24 :    0   2   3   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 21/24 :    0   2   1   3
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 22/24 :    0   3   1   2
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 23/24 :    0   3   2   1
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 2/-1/-1->0->3 [3] 2/-1/-1->0->3 [4] 3/-1/-1->0->2 [5] 3/-1/-1->0->2 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 2/-1/-1->0->3 [11] 2/-1/-1->0->3 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 2/-1/-1->0->3 [15] 2/-1/-1->0->3 [16] 3/-1/-1->0->2 [17] 3/-1/-1->0->2 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 2/-1/-1->0->3 [23] 2/-1/-1->0->3
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 00/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 04/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 02/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 06/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 06/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 06/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 10/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 08/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 07/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 12/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 12/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 12/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 16/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 14/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 13/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 18/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 18/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 18/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 22/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 20/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 19/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 01/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 04/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 03/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 07/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 07/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 08/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 10/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 09/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 09/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 13/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 13/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 14/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 16/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 15/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 15/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 19/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 19/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 20/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 22/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 21/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 21/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 01/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 02/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 03/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 04/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 05/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 05/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 05/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 07/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 08/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 09/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 10/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 11/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 11/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 11/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 13/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 14/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 15/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 16/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 17/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 17/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 17/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 19/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 20/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 21/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 22/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 23/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 23/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 23/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Connected all rings
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Connected all rings
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Connected all rings
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Connected all rings
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 01/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 07/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 08/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 09/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 13/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 01/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 19/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 07/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 20/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 09/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 08/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 21/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 13/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 09/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 19/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 20/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 21/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 21/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 02/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 04/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 05/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 10/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 11/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 02/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 04/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 14/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 03/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 05/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 16/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 05/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 10/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 17/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 11/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 11/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 22/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 14/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 16/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 23/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 15/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 17/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 17/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 22/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 23/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 23/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 00/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 01/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 06/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 02/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 07/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 00/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 08/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 14/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 01/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 12/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Channel 15/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 06/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 13/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 07/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 18/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 09/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 19/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 12/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Channel 20/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 13/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 18/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 19/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Channel 21/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16189 [3] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15898:16189 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15898:16189 [3] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15895:16180 [0] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15895:16180 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15895:16180 [0] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15897:16183 [2] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15897:16183 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15897:16183 [2] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15896:16184 [1] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15896:16184 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15896:16184 [1] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15896:16184 [1] NCCL INFO comm 0x55947743d920 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
x3005c0s19b1n0:15897:16183 [2] NCCL INFO comm 0x55585935e720 rank 2 nranks 4 cudaDev 2 busId 85000 - Init COMPLETE
x3005c0s19b1n0:15895:16180 [0] NCCL INFO comm 0x55a5d3f6f4e0 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
x3005c0s19b1n0:15898:16189 [3] NCCL INFO comm 0x55d27baec6d0 rank 3 nranks 4 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000059000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800200
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800200
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 uint8_t
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce Elapsed time: 558 AllReduce RING RING us
 RING LL LL LL Sum Sum Sum uint8_t uint8_t uint8_t Elapsed time: 350 Elapsed time: 10 Elapsed time: 68 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce AllReduce RING RING RING RING LL LL LL LL Sum Sum Sum Sum uint8_t uint8_t uint8_t uint8_t Elapsed time: 7 Elapsed time: 160648 Elapsed time: 1372276 Elapsed time: 662883 us
 us
 us
 us
>>> done with compiling and loading fused kernels. Compilation time: 3.533 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat64/ncclDouble, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000053000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 RING LL LL AllReduce LL Min Min RING Min double double LL double Elapsed time: 634 Elapsed time: 667 Min Elapsed time: 10 us
 us
 double us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 179
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce us
 AllReduce RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING LL LL AllReduce LL Sum Sum RING Sum double double LL double Elapsed time: 755 Elapsed time: 766 Sum Elapsed time: 143 us
 us
 double us
 Elapsed time: 276 us
time to initialize megatron (seconds): 5.272
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800200
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800200
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce uint8_t AllReduce RING RING Elapsed time: 161 RING LL LL us
 LL Sum Sum Sum uint8_t uint8_t uint8_t Elapsed time: 105 Elapsed time: 7 Elapsed time: 150 us
 us
 us
[after megatron is initialized] datetime: 2023-10-24 02:23:40 
building BERT model ...
 > number of parameters on (tensor, pipeline) model parallel rank (0, 0): 334723458
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24> learning rate decay style: linear
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce uint8_t AllReduce RING RING Elapsed time: 248 RING LL LL us
 LL Sum Sum Sum uint8_t uint8_t uint8_t Elapsed time: 9 Elapsed time: 47 Elapsed time: 7718 us
 us
 us
WARNING: could not find the metadata file /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m/latest_checkpointed_iteration.txt 
    will not load any checkpoints and will start from random
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL AllReduce RING AllReduce Sum RING LL RING uint8_t LL Sum LL Elapsed time: 7 Sum uint8_t Sum us
 uint8_t Elapsed time: 249 uint8_t Elapsed time: 160 us
 Elapsed time: 307 us
 us
time (ms) | load-checkpoint: 1.18
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 uint8_t AllReduce RING AllReduce Elapsed time: 123 RING LL RING us
 LL Sum LL Sum uint8_t Sum uint8_t Elapsed time: 109 uint8_t Elapsed time: 116 us
 Elapsed time: 6 us
 us
[after model, optimizer, and learning rate scheduler are built] datetime: 2023-10-24 02:23:40 
> building train, validation, and test datasets ...
 > datasets target sizes (minimum size):
    train:      6400
    validation: 704
    test:       64
> building train, validation, and test datasets for BERT ...
 > building dataset index ...
    reading sizes...
    reading pointers...
    reading document index...
    creating numpy buffer of mmap...
    creating memory view of numpy buffer...
 > finished creating indexed dataset in 0.006723 seconds
 > indexed dataset stats:
    number of documents: 35
    number of sentences: 7860
 > dataset split:
    train:
     document indices in [0, 33) total of 33 documents
     sentence indices in [0, 7617) total of 7617 sentences
    validation:
     document indices in [33, 35) total of 2 documents
     sentence indices in [7617, 7860) total of 243 sentences
    test:
     document indices in [35, 35) total of 0 documents
     sentence indices in [7860, 7860) total of 0 sentences
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Using network IB
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Using network IB
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Using network IB
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Using network IB
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 00/24 :    0   1   2   3
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0 [2] 3/-1/-1->1->-1 [3] 3/-1/-1->1->-1 [4] -1/-1/-1->1->3 [5] -1/-1/-1->1->3 [6] 0/-1/-1->1->2 [7] 0/-1/-1->1->2 [8] 2/-1/-1->1->0 [9] 2/-1/-1->1->0 [10] 3/-1/-1->1->-1 [11] 3/-1/-1->1->-1 [12] 2/-1/-1->1->0 [13] 2/-1/-1->1->0 [14] 3/-1/-1->1->-1 [15] 3/-1/-1->1->-1 [16] -1/-1/-1->1->3 [17] -1/-1/-1->1->3 [18] 0/-1/-1->1->2 [19] 0/-1/-1->1->2 [20] 2/-1/-1->1->0 [21] 2/-1/-1->1->0 [22] 3/-1/-1->1->-1 [23] 3/-1/-1->1->-1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 01/24 :    0   1   3   2
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] 0/-1/-1->3->1 [3] 0/-1/-1->3->1 [4] 1/-1/-1->3->0 [5] 1/-1/-1->3->0 [6] 2/-1/-1->3->-1 [7] 2/-1/-1->3->-1 [8] -1/-1/-1->3->2 [9] -1/-1/-1->3->2 [10] 0/-1/-1->3->1 [11] 0/-1/-1->3->1 [12] -1/-1/-1->3->2 [13] -1/-1/-1->3->2 [14] 0/-1/-1->3->1 [15] 0/-1/-1->3->1 [16] 1/-1/-1->3->0 [17] 1/-1/-1->3->0 [18] 2/-1/-1->3->-1 [19] 2/-1/-1->3->-1 [20] -1/-1/-1->3->2 [21] -1/-1/-1->3->2 [22] 0/-1/-1->3->1 [23] 0/-1/-1->3->1
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] -1/-1/-1->2->0 [3] -1/-1/-1->2->0 [4] 0/-1/-1->2->-1 [5] 0/-1/-1->2->-1 [6] 1/-1/-1->2->3 [7] 1/-1/-1->2->3 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] -1/-1/-1->2->0 [11] -1/-1/-1->2->0 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] -1/-1/-1->2->0 [15] -1/-1/-1->2->0 [16] 0/-1/-1->2->-1 [17] 0/-1/-1->2->-1 [18] 1/-1/-1->2->3 [19] 1/-1/-1->2->3 [20] 3/-1/-1->2->1 [21] 3/-1/-1->2->1 [22] -1/-1/-1->2->0 [23] -1/-1/-1->2->0
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 02/24 :    0   2   3   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 03/24 :    0   2   1   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 04/24 :    0   3   1   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 05/24 :    0   3   2   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 06/24 :    0   1   2   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 07/24 :    0   1   3   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 08/24 :    0   2   3   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 09/24 :    0   2   1   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 10/24 :    0   3   1   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 11/24 :    0   3   2   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 12/24 :    0   1   2   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 13/24 :    0   1   3   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 14/24 :    0   2   3   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 15/24 :    0   2   1   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 16/24 :    0   3   1   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 17/24 :    0   3   2   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 18/24 :    0   1   2   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 19/24 :    0   1   3   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 20/24 :    0   2   3   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 21/24 :    0   2   1   3
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 22/24 :    0   3   1   2
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 23/24 :    0   3   2   1
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] 2/-1/-1->0->3 [3] 2/-1/-1->0->3 [4] 3/-1/-1->0->2 [5] 3/-1/-1->0->2 [6] -1/-1/-1->0->1 [7] -1/-1/-1->0->1 [8] 1/-1/-1->0->-1 [9] 1/-1/-1->0->-1 [10] 2/-1/-1->0->3 [11] 2/-1/-1->0->3 [12] 1/-1/-1->0->-1 [13] 1/-1/-1->0->-1 [14] 2/-1/-1->0->3 [15] 2/-1/-1->0->3 [16] 3/-1/-1->0->2 [17] 3/-1/-1->0->2 [18] -1/-1/-1->0->1 [19] -1/-1/-1->0->1 [20] 1/-1/-1->0->-1 [21] 1/-1/-1->0->-1 [22] 2/-1/-1->0->3 [23] 2/-1/-1->0->3
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 00/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 00/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 00/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 04/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 01/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 02/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 06/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 06/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 06/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 10/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 07/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 08/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 12/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 12/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 12/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 16/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 13/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 14/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 18/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 18/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 18/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 22/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 19/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 20/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 02/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 01/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 01/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 03/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 03/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 04/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 08/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 07/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 07/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 09/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 09/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 10/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 14/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 13/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 13/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 15/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 15/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 16/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 20/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 19/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 19/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 21/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 21/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 22/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 04/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 03/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 02/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 01/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 05/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 05/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 05/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 10/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 09/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 08/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 07/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 11/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 11/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 11/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 16/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 15/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 14/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 13/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 17/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 17/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 17/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 22/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 21/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 20/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 19/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 23/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 23/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 23/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Connected all rings
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Connected all rings
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Connected all rings
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Connected all rings
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 01/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 07/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 08/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 02/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 09/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 04/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 01/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 13/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 07/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 19/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 10/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 08/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 09/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 20/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 09/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 13/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 21/0 : 1[46000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 14/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 20/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 19/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 16/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 21/0 : 0[7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 21/0 : 2[85000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 22/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 02/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 04/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 05/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 10/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 11/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 14/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 04/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 02/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 16/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 05/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 03/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 17/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 05/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 10/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 22/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 11/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 11/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 23/0 : 1[46000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 03/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 14/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 16/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 05/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 15/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 17/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 11/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 17/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 22/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 15/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 23/0 : 2[85000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 23/0 : 0[7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 17/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 23/0 : 3[c7000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 00/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 06/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 08/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 00/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 09/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 01/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 12/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 06/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 02/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 18/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 07/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 03/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 00/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 20/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 08/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 14/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 01/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Channel 21/0 : 3[c7000] -> 2[85000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 12/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Channel 15/0 : 0[7000] -> 3[c7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 06/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 13/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 07/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 18/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 09/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 19/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 12/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Channel 20/0 : 2[85000] -> 1[46000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 13/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 18/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 19/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Channel 21/0 : 1[46000] -> 0[7000] via P2P/IPC/read
x3005c0s19b1n0:15898:16238 [3] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15898:16238 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15898:16238 [3] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15895:16236 [0] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15895:16236 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15895:16236 [0] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15897:16237 [2] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15897:16237 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15897:16237 [2] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15896:16239 [1] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15896:16239 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
x3005c0s19b1n0:15896:16239 [1] NCCL INFO 24 coll channels, 32 p2p channels, 8 p2p channels per peer
x3005c0s19b1n0:15897:16237 [2] NCCL INFO comm 0x5558768f13e0 rank 2 nranks 4 cudaDev 2 busId 85000 - Init COMPLETE
x3005c0s19b1n0:15895:16236 [0] NCCL INFO comm 0x55a5f26dd7d0 rank 0 nranks 4 cudaDev 0 busId 7000 - Init COMPLETE
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24x3005c0s19b1n0:15896:16239 [1] NCCL INFO comm 0x55947bce12b0 rank 1 nranks 4 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800400
x3005c0s19b1n0:15898:16238 [3] NCCL INFO comm 0x55d295204080 rank 3 nranks 4 cudaDev 3 busId c7000 - Init COMPLETE
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24NCCL version 2.14.3+cuda11.8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24x3005c0s19b1n0:15897:16256 [2] NCCL INFO Using network IB
NCCL version 2.14.3+cuda11.8
NCCL version 2.14.3+cuda11.8
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Using network IB
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Using network IB
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Using network IB

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING LL Sum int64_t Elapsed time: 450 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING LL Sum int64_t Elapsed time: 11 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING LL Sum int64_t Elapsed time: 110 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL Sum int64_t Elapsed time: 113 us
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Connected all rings
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15897:16256 [2] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Connected all rings
x3005c0s19b1n0:15897:16256 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15895:16260 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Connected all rings
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15896:16261 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Connected all rings
x3005c0s19b1n0:15898:16262 [3] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15898:16262 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15897:16256 [2] NCCL INFO comm 0x5558768f3e70 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
x3005c0s19b1n0:15895:16260 [0] NCCL INFO comm 0x55a5f26e0260 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
x3005c0s19b1n0:15896:16261 [1] NCCL INFO comm 0x55947bce3d40 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
 > loading indexed mapping from /home/yuke/lyd/Megatron-LM/my-bert_text_sentence_train_indexmap_6400mns_509msl_0.10ssp_1234s.npy
x3005c0s19b1n0:15898:16262 [3] NCCL INFO comm 0x55d2952071e0 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
    loaded indexed file in 0.003 seconds
    total number of samples: 6454
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclInt64, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000014000 seconds

[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce RING AllReduce RING LL RING LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 LL Sum int64_t AllReduce Sum int64_t Elapsed time: 553 RING int64_t Elapsed time: 9 us
 LL Elapsed time: 525 us
 Sum us
 int64_t > loading indexed mapping from /home/yuke/lyd/Megatron-LM/my-bert_text_sentence_valid_indexmap_704mns_509msl_0.10ssp_1234s.npy Elapsed time: 395
 us
    loaded indexed file in 0.002 seconds
    total number of samples: 705
> finished creating BERT datasets ...
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Using network IB
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Using network IB
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Using network IB
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Using network IB
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Connected all rings
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15896:16275 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Connected all rings
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15897:16278 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Connected all rings
x3005c0s19b1n0:15895:16277 [0] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15895:16277 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Connected all rings
x3005c0s19b1n0:15898:16276 [3] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15898:16276 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15896:16275 [1] NCCL INFO comm 0x55947bce6e80 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3005c0s19b1n0:15897:16278 [2] NCCL INFO comm 0x555877e660e0 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3005c0s19b1n0:15895:16277 [0] NCCL INFO comm 0x55a5f26e38c0 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
x3005c0s19b1n0:15898:16276 [3] NCCL INFO comm 0x55d29520a6c0 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 3, datatype: ncclInt64, message size: 24 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000238000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce LL AllReduce LL RING Sum RING Sum LL uint8_t LL uint8_t Sum Elapsed time: 10599 Sum Elapsed time: 11 uint8_t us
 uint8_t us
 Elapsed time: 8596 Elapsed time: 4881 us
 us
[after dataloaders are built] datetime: 2023-10-24 02:23:41 time (ms) | model-and-optimizer-setup: 119.16 | train/valid/test-data-iterators-setup: 1110.58

done with setup ...
training ...
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8f31800400
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8f31800400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce LL AllReduce LL RING Sum RING Sum LL uint8_t LL uint8_t Sum Elapsed time: 125 Sum Elapsed time: 58 uint8_t us
 uint8_t us
 Elapsed time: 6 Elapsed time: 228 us
 us
[before the start of training step] datetime: 2023-10-24 02:23:41 
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.001342000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000053000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000062000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum AllReduce AllReduce AllReduce float RING RING RING Elapsed time: 13752 LL LL LL us
 Sum Sum Sum float float float Elapsed time: 10 Elapsed time: 3236 Elapsed time: 11341 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000065000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 21655 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum AllReduce half RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 21753 SIMPLE AllReduce us
 Sum RING half SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Elapsed time: 6582 Sum AllReduce us
 half RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 4325 SIMPLE AllReduce us
 Sum RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half LL AllReduce Elapsed time: 5514 Sum RING us
 half LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Elapsed time: 6709 Sum AllReduce us
 half RING Elapsed time: 4418 LL us
 Sum half Elapsed time: 5636 us
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Using network IB
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Using network IB
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Using network IB
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Using network IB
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Setting affinity for GPU 1 to ff0000,00ff0000
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Connected all rings
x3005c0s19b1n0:15896:17129 [1] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15896:17129 [1] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Setting affinity for GPU 2 to ff00,0000ff00
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Connected all rings
x3005c0s19b1n0:15897:17130 [2] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15897:17130 [2] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Setting affinity for GPU 3 to ff,000000ff
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Setting affinity for GPU 0 to ff000000,ff000000
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 00/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Connected all rings
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 01/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 02/32 :    0
x3005c0s19b1n0:15898:17134 [3] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 03/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 04/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 05/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 06/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 07/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 08/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 09/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 10/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 11/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 12/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 13/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 14/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 15/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 16/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 17/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 18/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 19/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 20/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 21/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 22/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 23/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 24/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 25/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 26/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 27/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 28/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 29/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 30/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Channel 31/32 :    0
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Connected all rings
x3005c0s19b1n0:15895:17133 [0] NCCL INFO Connected all trees by HAO
x3005c0s19b1n0:15895:17133 [0] NCCL INFO 32 coll channels, 32 p2p channels, 32 p2p channels per peer
x3005c0s19b1n0:15896:17129 [1] NCCL INFO comm 0x5594b181d240 rank 0 nranks 1 cudaDev 1 busId 46000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
x3005c0s19b1n0:15897:17130 [2] NCCL INFO comm 0x5558abcdd990 rank 0 nranks 1 cudaDev 2 busId 85000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
x3005c0s19b1n0:15898:17134 [3] NCCL INFO comm 0x55d2ca8071d0 rank 0 nranks 1 cudaDev 3 busId c7000 - Init COMPLETE
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
x3005c0s19b1n0:15895:17133 [0] NCCL INFO comm 0x55a627c8e4a0 rank 0 nranks 1 cudaDev 0 busId 7000 - Init COMPLETE
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
 iteration        1/     100 | consumed samples:           64 | elapsed time per iteration (ms): 1886.1 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 4294967296.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 1221.03 | backward-compute: 543.34 | backward-params-all-reduce: 7.13 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 4.00 | optimizer-unscale-and-check-inf: 107.87 | optimizer: 111.95 | batch-generator: 428.50
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf224400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 13708 float Elapsed time: 1395 float us
 Elapsed time: 10723 us
 Elapsed time: 8 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 11252 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 LL AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum RING AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 half SIMPLE RING AllReduce Elapsed time: 11351 Sum SIMPLE RING us
 half Sum SIMPLE Elapsed time: 4577 half Sum us
 Elapsed time: 10270 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 Elapsed time: 5839 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 RING AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL RING AllReduce Sum LL RING half Sum LL Elapsed time: 4673 half Sum us
 Elapsed time: 10403 half us
 Elapsed time: 5974 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
 iteration        2/     100 | consumed samples:          128 | elapsed time per iteration (ms): 197.8 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 2147483648.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 79.33 | backward-compute: 103.15 | backward-params-all-reduce: 6.60 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.67 | optimizer-unscale-and-check-inf: 3.07 | optimizer: 6.86 | batch-generator: 0.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 3522 float float Elapsed time: 8 us
 Elapsed time: 2305 Elapsed time: 667 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 7765 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce LL SIMPLE AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 7863 Elapsed time: 5007 Sum half us
 us
 half Elapsed time: 7531
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5215 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5104 Sum half us
 half Elapsed time: 7655 Elapsed time: 5336 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
 iteration        3/     100 | consumed samples:          192 | elapsed time per iteration (ms): 187.5 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 1073741824.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 73.29 | backward-compute: 99.67 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.35 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 510 float Elapsed time: 8 Elapsed time: 168 us
 Elapsed time: 309 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce SIMPLE RING Sum SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 half Sum AllReduce Elapsed time: 5234 half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING us
 Elapsed time: 5231 AllReduce SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us
 RING Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 SIMPLE half RING AllReduce Sum Elapsed time: 5304 LL RING half us
 Sum LL Elapsed time: 5079
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half Sum us
 AllReduce Elapsed time: 5331 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING us
 Elapsed time: 5326 AllReduce LL us
 RING Sum LL half Sum Elapsed time: 5433 half us
 Elapsed time: 5207 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration        4/     100 | consumed samples:          256 | elapsed time per iteration (ms): 182.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 536870912.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.17 | backward-compute: 96.96 | backward-params-all-reduce: 6.78 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.44 | optimizer-unscale-and-check-inf: 2.96 | optimizer: 6.50 | batch-generator: 0.72
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 1733 float Elapsed time: 1317 Elapsed time: 1647 us
 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5233 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE RING LL AllReduce Sum SIMPLE Sum RING half Sum half SIMPLE Elapsed time: 5102 half Elapsed time: 5331 Sum us
 Elapsed time: 5028 us
 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 Elapsed time: 5041 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 us
 RING AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL RING AllReduce Sum LL RING half Sum LL Elapsed time: 5199 half Sum us
 Elapsed time: 5163 half us
 Elapsed time: 5165 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration        5/     100 | consumed samples:          320 | elapsed time per iteration (ms): 183.1 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 268435456.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.43 | backward-compute: 97.07 | backward-params-all-reduce: 6.64 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.95 | optimizer: 6.37 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 437 float Elapsed time: 8 Elapsed time: 104 us
 Elapsed time: 230 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum AllReduce Sum half RING half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Elapsed time: 4996 SIMPLE Elapsed time: 5422 AllReduce us
 Sum us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 SIMPLE AllReduce Elapsed time: 5682 AllReduce Sum RING us
 RING half LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Elapsed time: 5198 Sum AllReduce Sum us
 half RING half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5094 LL Elapsed time: 5521 AllReduce us
 Sum us
 RING half LL Elapsed time: 5817 Sum us
 half Elapsed time: 5334 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
 iteration        6/     100 | consumed samples:          384 | elapsed time per iteration (ms): 182.1 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 134217728.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.12 | backward-compute: 97.03 | backward-params-all-reduce: 6.98 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.35 | batch-generator: 0.73
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 323 float Elapsed time: 8 Elapsed time: 157 us
 Elapsed time: 209 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE SIMPLE Sum Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 half half AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Elapsed time: 5409 Elapsed time: 5577 RING AllReduce us
 us
 SIMPLE RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum SIMPLE AllReduce AllReduce half Sum RING RING Elapsed time: 5805 half LL LL us
 Elapsed time: 5012 Sum Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 us
 half half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5508 Elapsed time: 5673 RING AllReduce us
 us
 LL RING Sum LL half Sum Elapsed time: 5939 half us
 Elapsed time: 5140 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
 iteration        7/     100 | consumed samples:          448 | elapsed time per iteration (ms): 182.3 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 67108864.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.13 | backward-compute: 97.07 | backward-params-all-reduce: 7.12 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.35 | batch-generator: 0.74
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000020000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 275 float Elapsed time: 8 Elapsed time: 217 us
 Elapsed time: 121 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING RING AllReduce SIMPLE SIMPLE RING Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum SIMPLE half AllReduce half Sum Elapsed time: 5262 RING Elapsed time: 4940 half us
 SIMPLE us
 Elapsed time: 5486
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us
 AllReduce half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING Elapsed time: 5044 RING AllReduce LL us
 LL RING Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum LL half AllReduce half Sum Elapsed time: 5371 RING Elapsed time: 5043 half us
 LL us
 Elapsed time: 5614 Sum us
 half Elapsed time: 5182 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
 iteration        8/     100 | consumed samples:          512 | elapsed time per iteration (ms): 182.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 33554432.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.14 | backward-compute: 97.09 | backward-params-all-reduce: 6.84 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.35 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 267 float float Elapsed time: 8 us
 Elapsed time: 177 Elapsed time: 157 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5437
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING AllReduce RING AllReduce SIMPLE RING SIMPLE RING Sum LL Sum SIMPLE half Sum half Sum Elapsed time: 5025 half Elapsed time: 5276 half us
 Elapsed time: 5534 us
 Elapsed time: 5563
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING RING AllReduce LL LL RING Sum Sum LL half half Sum Elapsed time: 5120 Elapsed time: 5397 half us
 us
 Elapsed time: 5695 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration        9/     100 | consumed samples:          576 | elapsed time per iteration (ms): 182.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 16777216.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.21 | backward-compute: 97.27 | backward-params-all-reduce: 6.57 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.95 | optimizer: 6.36 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 498 float float Elapsed time: 8 us
 Elapsed time: 257 Elapsed time: 274 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE AllReduce Sum RING half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Elapsed time: 4925 AllReduce Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 us
 RING half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 SIMPLE Elapsed time: 5074 RING AllReduce Sum us
 SIMPLE RING half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum LL Elapsed time: 5630 AllReduce half Sum us
 RING Elapsed time: 5186 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL us
 Elapsed time: 5024 AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 RING half AllReduce LL Elapsed time: 5170 RING Sum us
 LL half Sum Elapsed time: 5765 half us
 Elapsed time: 5314 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
 iteration       10/     100 | consumed samples:          640 | elapsed time per iteration (ms): 182.1 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 8388608.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.23 | backward-compute: 97.30 | backward-params-all-reduce: 6.62 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.94 | optimizer: 6.36 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000124000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf3ffa00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf3ffa00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000069000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000062000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000101000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 92 float float Elapsed time: 8 us
 Elapsed time: 1626 Elapsed time: 1755 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 10 | lm loss value: 1.046254E+01 | lm loss PPL: 3.498041E+04 | sop loss value: 8.416327E-01 | sop loss PPL: 2.320152E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 328 float float Elapsed time: 8 us
 Elapsed time: 146 Elapsed time: 173 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5320 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 LL AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce half SIMPLE AllReduce RING Elapsed time: 5419 Sum RING SIMPLE us
 half SIMPLE Sum Elapsed time: 5014 Sum half us
 half Elapsed time: 5074
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5561 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5112 Sum half us
 half Elapsed time: 5197 Elapsed time: 5691 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       11/     100 | consumed samples:          704 | elapsed time per iteration (ms): 437.8 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 4194304.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 323.52 | backward-compute: 97.44 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.34 | optimizer-unscale-and-check-inf: 2.89 | optimizer: 6.33 | batch-generator: 1.61
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 494 float float Elapsed time: 8 us
 Elapsed time: 165 Elapsed time: 208 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5182 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE LL AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 5095 Elapsed time: 5281 Sum half us
 us
 half Elapsed time: 5012
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5212 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5191 Sum half us
 half Elapsed time: 5144 Elapsed time: 5347 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
 iteration       12/     100 | consumed samples:          768 | elapsed time per iteration (ms): 182.1 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 2097152.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.12 | backward-compute: 97.15 | backward-params-all-reduce: 6.62 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.89 | optimizer: 6.31 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 486 float float Elapsed time: 8 us
 Elapsed time: 103 Elapsed time: 144 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce half RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Elapsed time: 5725 SIMPLE AllReduce us
 Sum RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half SIMPLE AllReduce AllReduce Elapsed time: 5575 Sum RING RING us
 half SIMPLE LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5799 Sum Sum AllReduce us
 half half RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Elapsed time: 5057 Elapsed time: 5822 LL AllReduce us
 us
 Sum RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half LL AllReduce Elapsed time: 5671 Sum RING us
 half LL Elapsed time: 5924 Sum us
 half Elapsed time: 5188 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       13/     100 | consumed samples:          832 | elapsed time per iteration (ms): 182.5 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 1048576.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.14 | backward-compute: 97.16 | backward-params-all-reduce: 7.11 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 3.00 | optimizer: 6.41 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 512 float Elapsed time: 8 float us
 Elapsed time: 279 us
 Elapsed time: 374 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING SIMPLE AllReduce SIMPLE Sum RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum half SIMPLE AllReduce half Elapsed time: 5196 Sum RING Elapsed time: 4994 us
 half SIMPLE us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5455 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce us
 half AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Elapsed time: 5337 RING LL AllReduce us
 LL Sum RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum half LL AllReduce half Elapsed time: 5294 Sum RING Elapsed time: 5092 us
 half LL us
 Elapsed time: 5577 Sum us
 half Elapsed time: 5467 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
 iteration       14/     100 | consumed samples:          896 | elapsed time per iteration (ms): 182.6 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 524288.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.14 | backward-compute: 97.60 | backward-params-all-reduce: 6.78 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.81 | optimizer: 6.25 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1436 float float Elapsed time: 8 us
 Elapsed time: 1491 Elapsed time: 1382 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING AllReduce RING SIMPLE RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum half AllReduce Sum half Elapsed time: 5500 RING half Elapsed time: 5017 us
 SIMPLE Elapsed time: 5041 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING Elapsed time: 4998 AllReduce RING LL us
 RING LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Sum half AllReduce Sum half Elapsed time: 5597 RING half Elapsed time: 5115 us
 LL Elapsed time: 5164 us
 Sum us
 half Elapsed time: 5129 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
 iteration       15/     100 | consumed samples:          960 | elapsed time per iteration (ms): 183.2 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 262144.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.81 | backward-compute: 97.59 | backward-params-all-reduce: 6.61 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.56 | optimizer: 5.97 | batch-generator: 1.35
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 7 float Elapsed time: 1627 float us
 Elapsed time: 1562 us
 Elapsed time: 1558 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000035000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5438
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING Sum AllReduce RING SIMPLE half RING SIMPLE Sum Elapsed time: 5043 LL Sum half us
 Sum half Elapsed time: 5551
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5154 us
 AllReduce Elapsed time: 5536 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5140 Sum half us
 half Elapsed time: 5672 Elapsed time: 5288 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
 iteration       16/     100 | consumed samples:         1024 | elapsed time per iteration (ms): 184.0 | learning rate: 0.000E+00 | global batch size:    64 | loss scale: 131072.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.86 | backward-compute: 97.73 | backward-params-all-reduce: 6.59 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.57 | optimizer: 5.98 | batch-generator: 0.74
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000082000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000077000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000077000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000077000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000078000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 4401 us
 Elapsed time: 6713 Elapsed time: 5281 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce AllReduce AllReduce RING RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE SIMPLE Sum AllReduce Sum Sum half RING half half Elapsed time: 4905 SIMPLE Elapsed time: 5250 Elapsed time: 5677 us
 Sum us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Elapsed time: 5217 AllReduce AllReduce RING us
 RING RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL LL Sum AllReduce Sum Sum half RING half half Elapsed time: 5020 LL Elapsed time: 5362 Elapsed time: 5816 us
 Sum us
 us
 half Elapsed time: 5353 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Rank 0] (after 17 iterations) memory (MB) | allocated: 6529.1025390625 | max allocated: 18364.3505859375 | reserved: 19254.0 | max reserved: 19254.0
 iteration       17/     100 | consumed samples:         1088 | elapsed time per iteration (ms): 241.6 | learning rate: 9.905E-05 | global batch size:    64 | lm loss: 1.047818E+01 | sop loss: 7.609406E-01 | loss scale: 131072.0 | grad norm: 57.001 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
time (ms) | forward-compute: 108.95 | backward-compute: 97.76 | backward-params-all-reduce: 6.90 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 3.02 | optimizer-clip-main-grad: 4.80 | optimizer-copy-main-to-model-params: 3.72 | optimizer: 25.93 | batch-generator: 0.74
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 1685 float Elapsed time: 10 float us
 Elapsed time: 863 us
 Elapsed time: 1143 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce SIMPLE RING Sum SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 half Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Elapsed time: 5190 half AllReduce RING us
 Elapsed time: 5083 RING SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us
 SIMPLE Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum half RING AllReduce half Elapsed time: 5392 LL RING Elapsed time: 5006 us
 Sum LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Elapsed time: 5288 half AllReduce RING us
 Elapsed time: 5179 RING LL us
 LL Sum Sum half half Elapsed time: 5527 Elapsed time: 5129 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
 iteration       18/     100 | consumed samples:         1152 | elapsed time per iteration (ms): 183.7 | learning rate: 9.905E-05 | global batch size:    64 | loss scale: 65536.0 | number of skipped iterations:   1 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.78 | backward-compute: 97.80 | backward-params-all-reduce: 6.63 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.66 | optimizer-clip-main-grad: 0.00 | optimizer-copy-main-to-model-params: 0.00 | optimizer: 6.10 | batch-generator: 1.29
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 100 float Elapsed time: 550 float us
 Elapsed time: 7 us
 Elapsed time: 122 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5265
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 us
 AllReduce SIMPLE AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING Sum RING AllReduce SIMPLE half SIMPLE RING Sum Elapsed time: 5076 Sum LL half us
 half Sum Elapsed time: 4947
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5710 half us
 AllReduce us
 Elapsed time: 5365
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 us
 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5172 Sum half us
 half Elapsed time: 5077 Elapsed time: 5834 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
 iteration       19/     100 | consumed samples:         1216 | elapsed time per iteration (ms): 198.6 | learning rate: 9.720E-05 | global batch size:    64 | lm loss: 1.047711E+01 | sop loss: 7.929427E-01 | loss scale: 65536.0 | grad norm: 62.823 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.26 | backward-compute: 97.69 | backward-params-all-reduce: 6.72 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.45 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.51 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.18 | batch-generator: 0.81
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1846 float float Elapsed time: 1255 us
 Elapsed time: 8 Elapsed time: 2000 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce half RING Elapsed time: 5491
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 us
 AllReduce Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING half RING AllReduce SIMPLE Elapsed time: 4932 SIMPLE RING Sum us
 Sum LL half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Sum Elapsed time: 5677 AllReduce Elapsed time: 5021 half us
 RING us
 Elapsed time: 5594
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5031 LL Sum us
 Sum half half Elapsed time: 5809 Elapsed time: 5156 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
 iteration       20/     100 | consumed samples:         1280 | elapsed time per iteration (ms): 200.2 | learning rate: 9.534E-05 | global batch size:    64 | lm loss: 9.890020E+00 | sop loss: 3.238808E+00 | loss scale: 65536.0 | grad norm: 40.084 | number of skipped iterations:   0 | number of nan iterations:   0 |[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes

time (ms) | forward-compute: 71.36 | backward-compute: 97.61 | backward-params-all-reduce: 6.57 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.38 | optimizer-unscale-and-check-inf: 2.89 | optimizer-clip-main-grad: 4.66 | optimizer-copy-main-to-model-params: 3.68 | optimizer: 22.72 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1803 float float Elapsed time: 8 us
 Elapsed time: 781 Elapsed time: 1749 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 20 | lm loss value: 9.870894E+00 | lm loss PPL: 1.935865E+04 | sop loss value: 3.430906E+00 | sop loss PPL: 3.090463E+01 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1877 float float Elapsed time: 8 us
 Elapsed time: 1999 Elapsed time: 240 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 5525 AllReduce us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum AllReduce RING AllReduce half RING LL RING Elapsed time: 5007 SIMPLE Sum SIMPLE us
 Sum half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5624 half AllReduce Elapsed time: 5763 us
 Elapsed time: 4992 RING us
 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum AllReduce AllReduce half RING RING Elapsed time: 5103 LL LL us
 Sum Sum half half Elapsed time: 5890 Elapsed time: 5126 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
 iteration       21/     100 | consumed samples:         1344 | elapsed time per iteration (ms): 265.4 | learning rate: 9.349E-05 | global batch size:    64 | lm loss: 9.840940E+00 | sop loss: 3.895467E+00 | loss scale: 65536.0 | grad norm: 50.117 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 133.91 | backward-compute: 97.60 | backward-params-all-reduce: 6.58 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.36 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.48 | optimizer-copy-main-to-model-params: 3.61 | optimizer: 22.62 | batch-generator: 2.31
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 1324 float Elapsed time: 8 Elapsed time: 1146 us
 Elapsed time: 330 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 half AllReduce half AllReduce Elapsed time: 4996 RING Elapsed time: 5223 RING us
 SIMPLE us
 SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum AllReduce half AllReduce half RING Elapsed time: 5555 RING Elapsed time: 5049 LL us
 LL us
 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half AllReduce half AllReduce Elapsed time: 5093 RING Elapsed time: 5319 RING us
 LL us
 LL Sum Sum half half Elapsed time: 5686 Elapsed time: 5172 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
 iteration       22/     100 | consumed samples:         1408 | elapsed time per iteration (ms): 198.5 | learning rate: 9.163E-05 | global batch size:    64 | lm loss: 9.282993E+00 | sop loss: 1.084750E+00 | loss scale: 65536.0 | grad norm: 15.133 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.26 | backward-compute: 97.63 | backward-params-all-reduce: 6.78 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.34 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.97 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1476 float float Elapsed time: 1175 us
 Elapsed time: 1511 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5410 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce LL SIMPLE AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 5506 Elapsed time: 5034 Sum half us
 us
 half Elapsed time: 5089
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5406 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5130 Sum half us
 half Elapsed time: 5214 Elapsed time: 5537 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       23/     100 | consumed samples:         1472 | elapsed time per iteration (ms): 199.8 | learning rate: 8.978E-05 | global batch size:    64 | lm loss: 9.105724E+00 | sop loss: 9.110751E-01 | loss scale: 65536.0 | grad norm: 10.431 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.21 | backward-compute: 97.40 | backward-params-all-reduce: 6.57 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.65 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 22.86 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 1379 float Elapsed time: 8 Elapsed time: 1312 us
 Elapsed time: 1101 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum half AllReduce RING half Elapsed time: 5329 RING SIMPLE Elapsed time: 5061 us
 SIMPLE Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce half Elapsed time: 5564 AllReduce RING Elapsed time: 5038 us
 RING LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum half AllReduce RING half Elapsed time: 5427 RING LL Elapsed time: 5157 us
 LL Sum us
 Sum half half Elapsed time: 5697 Elapsed time: 5168 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       24/     100 | consumed samples:         1536 | elapsed time per iteration (ms): 199.7 | learning rate: 8.792E-05 | global batch size:    64 | lm loss: 9.034531E+00 | sop loss: 8.620229E-01 | loss scale: 65536.0 | grad norm: 9.065 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.12 | backward-compute: 97.39 | backward-params-all-reduce: 6.62 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 3.00 | optimizer-clip-main-grad: 5.86 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 23.73 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 659 float float Elapsed time: 8 us
 Elapsed time: 2055 Elapsed time: 2028 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE Sum AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum half RING AllReduce half Elapsed time: 5414 SIMPLE RING Elapsed time: 5008 us
 Sum SIMPLE us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce Elapsed time: 5045 half AllReduce RING us
 Elapsed time: 5053 RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 LL Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum half RING AllReduce half Elapsed time: 5513 LL RING Elapsed time: 5105 us
 Sum LL us
 half Sum Elapsed time: 5176 half us
 Elapsed time: 5179 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       25/     100 | consumed samples:         1600 | elapsed time per iteration (ms): 197.7 | learning rate: 8.607E-05 | global batch size:    64 | lm loss: 8.757622E+00 | sop loss: 7.005879E-01 | loss scale: 65536.0 | grad norm: 3.398 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.05 | backward-compute: 97.34 | backward-params-all-reduce: 6.58 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.97 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 126 float Elapsed time: 302 float us
 Elapsed time: 617 us
 Elapsed time: 8 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE AllReduce Sum RING half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Elapsed time: 5292
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum us
 AllReduce RING half
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING SIMPLE Elapsed time: 5062 AllReduce SIMPLE Sum us
 RING Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 LL half Elapsed time: 5500 AllReduce Sum Elapsed time: 4981 us
 RING half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Elapsed time: 5392
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum us
 AllReduce RING half RING LL Elapsed time: 5159 LL Sum us
 Sum half half Elapsed time: 5637 Elapsed time: 5105 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       26/     100 | consumed samples:         1664 | elapsed time per iteration (ms): 198.3 | learning rate: 8.421E-05 | global batch size:    64 | lm loss: 8.682930E+00 | sop loss: 7.711104E-01 | loss scale: 65536.0 | grad norm: 6.662 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.42 | backward-compute: 97.41 | backward-params-all-reduce: 6.61 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.99 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000034000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 475 float float Elapsed time: 8 us
 Elapsed time: 310 Elapsed time: 129 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5331 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 LL SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce Sum Sum AllReduce RING half half RING SIMPLE Elapsed time: 5430 Elapsed time: 5000 SIMPLE Sum us
 us
 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5156 AllReduce Elapsed time: 5461 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5098 LL Sum us
 Sum half half Elapsed time: 5283 Elapsed time: 5589 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       27/     100 | consumed samples:         1728 | elapsed time per iteration (ms): 197.9 | learning rate: 8.236E-05 | global batch size:    64 | lm loss: 8.604494E+00 | sop loss: 8.680513E-01 | loss scale: 65536.0 | grad norm: 9.418 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.07 | backward-compute: 97.40 | backward-params-all-reduce: 6.51 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.71 | optimizer: 22.16 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000018000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 671 float float Elapsed time: 8 us
 Elapsed time: 581 Elapsed time: 564 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5172
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING AllReduce Sum AllReduce LL RING half RING Sum SIMPLE Elapsed time: 5041 SIMPLE half Sum us
 Sum Elapsed time: 5274 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half us
 Elapsed time: 5420 AllReduce Elapsed time: 4970 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5139 LL Sum us
 Sum half half Elapsed time: 5551 Elapsed time: 5099 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       28/     100 | consumed samples:         1792 | elapsed time per iteration (ms): 198.0 | learning rate: 8.050E-05 | global batch size:    64 | lm loss: 8.569429E+00 | sop loss: 7.673333E-01 | loss scale: 65536.0 | grad norm: 6.422 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.09 | backward-compute: 97.35 | backward-params-all-reduce: 6.58 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.52 | optimizer-unscale-and-check-inf: 2.67 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.15 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 249 float float Elapsed time: 957 us
 Elapsed time: 8 Elapsed time: 721 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE Sum AllReduce RING Sum half RING SIMPLE half Elapsed time: 5367 SIMPLE Sum Elapsed time: 5012 us
 Sum half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half Elapsed time: 5201
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce Elapsed time: 5424 us
 AllReduce RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL Sum AllReduce RING Sum half RING LL half Elapsed time: 5465 LL Sum Elapsed time: 5110 us
 Sum half us
 half Elapsed time: 5332 Elapsed time: 5549 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       29/     100 | consumed samples:         1856 | elapsed time per iteration (ms): 198.0 | learning rate: 7.865E-05 | global batch size:    64 | lm loss: 8.428103E+00 | sop loss: 6.900976E-01 | loss scale: 65536.0 | grad norm: 2.809 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.34 | backward-compute: 97.37 | backward-params-all-reduce: 6.60 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 21.98 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 415 us
 Elapsed time: 389 Elapsed time: 339 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce SIMPLE RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum SIMPLE AllReduce half Sum RING Elapsed time: 5418 half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE us
 Elapsed time: 5101 AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us
 RING half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 SIMPLE Elapsed time: 5503 RING AllReduce Sum us
 LL RING half
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum LL Elapsed time: 5089 AllReduce half Sum us
 RING Elapsed time: 5515 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL us
 Elapsed time: 5197 AllReduce Sum us
 RING half LL Elapsed time: 5627 Sum us
 half Elapsed time: 5218 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
 iteration       30/     100 | consumed samples:         1920 | elapsed time per iteration (ms): 198.1 | learning rate: 7.679E-05 | global batch size:    64 | lm loss: 8.333661E+00 | sop loss: 6.847333E-01 | loss scale: 65536.0 | grad norm: 2.065 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.06 | backward-compute: 97.42 | backward-params-all-reduce: 6.65 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.97 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 7 float Elapsed time: 192 Elapsed time: 469 us
 Elapsed time: 1525 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 30 | lm loss value: 8.266529E+00 | lm loss PPL: 3.891419E+03 | sop loss value: 7.587644E-01 | sop loss PPL: 2.135636E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 226 float float Elapsed time: 8 us
 Elapsed time: 26 Elapsed time: 85 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 5522 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce SIMPLE RING AllReduce RING Sum SIMPLE RING SIMPLE half Sum LL Sum Elapsed time: 5030 half Sum half us
 Elapsed time: 5177 half Elapsed time: 5443
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 Elapsed time: 5621 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING AllReduce AllReduce LL RING RING Sum LL LL half Sum Sum Elapsed time: 5127 half half us
 Elapsed time: 5305 Elapsed time: 5565 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       31/     100 | consumed samples:         1984 | elapsed time per iteration (ms): 263.0 | learning rate: 7.494E-05 | global batch size:    64 | lm loss: 8.283964E+00 | sop loss: 7.236323E-01 | loss scale: 65536.0 | grad norm: 4.164 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 133.44 | backward-compute: 97.34 | backward-params-all-reduce: 6.59 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.98 | batch-generator: 2.21
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 674 float Elapsed time: 225 Elapsed time: 7 us
 Elapsed time: 545 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5101 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce AllReduce half AllReduce RING RING Elapsed time: 5200 RING SIMPLE SIMPLE us
 SIMPLE Sum Sum Sum half half half Elapsed time: 5171 Elapsed time: 5455 Elapsed time: 4962 us
 us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce AllReduce RING RING RING LL LL LL Sum Sum Sum half half half Elapsed time: 5267 Elapsed time: 5577 Elapsed time: 5093 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       32/     100 | consumed samples:         2048 | elapsed time per iteration (ms): 198.2 | learning rate: 7.308E-05 | global batch size:    64 | lm loss: 8.124096E+00 | sop loss: 6.686243E-01 | loss scale: 65536.0 | grad norm: 1.957 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.28 | backward-compute: 97.24 | backward-params-all-reduce: 6.82 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.72 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 22.02 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000037000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 714 us
 Elapsed time: 1210 Elapsed time: 1188 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 5453 AllReduce us
 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce AllReduce Sum AllReduce RING RING half RING SIMPLE LL Elapsed time: 5009 SIMPLE Sum Sum us
 Sum half half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5166 Elapsed time: 5550 AllReduce Elapsed time: 5490 us
 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5105 LL Sum us
 Sum half half Elapsed time: 5301 Elapsed time: 5624 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       33/     100 | consumed samples:         2112 | elapsed time per iteration (ms): 198.5 | learning rate: 7.122E-05 | global batch size:    64 | lm loss: 8.124282E+00 | sop loss: 6.642271E-01 | loss scale: 65536.0 | grad norm: 2.068 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.81 | backward-compute: 97.45 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.63 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.94 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 26 float float Elapsed time: 463 us
 Elapsed time: 425 Elapsed time: 7 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE AllReduce Sum RING half SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Elapsed time: 5206 Sum AllReduce AllReduce us
 half RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5066 SIMPLE SIMPLE AllReduce us
 Sum Sum RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half LL AllReduce Elapsed time: 5005 Elapsed time: 5426 Sum RING us
 us
 half LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Elapsed time: 5303 Sum AllReduce AllReduce us
 half RING RING Elapsed time: 5163 LL LL us
 Sum Sum half half Elapsed time: 5136 Elapsed time: 5562 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       34/     100 | consumed samples:         2176 | elapsed time per iteration (ms): 197.8 | learning rate: 6.937E-05 | global batch size:    64 | lm loss: 8.045693E+00 | sop loss: 7.361682E-01 | loss scale: 65536.0 | grad norm: 4.944 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.06 | backward-compute: 97.37 | backward-params-all-reduce: 6.61 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.38 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.01 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 525 us
 Elapsed time: 415 Elapsed time: 356 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE Sum AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum half RING AllReduce half Elapsed time: 5316 SIMPLE RING Elapsed time: 4985 us
 Sum SIMPLE us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce Elapsed time: 4988 half AllReduce RING us
 Elapsed time: 5386 RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 LL Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum half RING AllReduce half Elapsed time: 5415 LL RING Elapsed time: 5082 us
 Sum LL us
 half Sum Elapsed time: 5118 half us
 Elapsed time: 5511 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
 iteration       35/     100 | consumed samples:         2240 | elapsed time per iteration (ms): 197.7 | learning rate: 6.751E-05 | global batch size:    64 | lm loss: 7.994264E+00 | sop loss: 7.078587E-01 | loss scale: 65536.0 | grad norm: 3.046 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.09 | backward-compute: 97.30 | backward-params-all-reduce: 6.56 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.93 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 973 us
 Elapsed time: 1160 Elapsed time: 1139 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5561 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce LL RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce half Sum AllReduce RING Elapsed time: 5659 half RING SIMPLE us
 Elapsed time: 5321 SIMPLE Sum us
 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 4921 AllReduce Elapsed time: 5586 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5417 LL Sum us
 Sum half half Elapsed time: 5047 Elapsed time: 5712 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
 iteration       36/     100 | consumed samples:         2304 | elapsed time per iteration (ms): 199.5 | learning rate: 6.566E-05 | global batch size:    64 | lm loss: 7.916845E+00 | sop loss: 6.913071E-01 | loss scale: 65536.0 | grad norm: 1.944 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.04 | backward-compute: 97.32 | backward-params-all-reduce: 6.82 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.55 | batch-generator: 0.74
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 1115 us
 Elapsed time: 1413 Elapsed time: 2093 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING AllReduce RING SIMPLE RING SIMPLE Sum SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum half Sum AllReduce half Elapsed time: 5406 half RING Elapsed time: 5012 us
 Elapsed time: 5190 SIMPLE us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us
 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half AllReduce RING AllReduce Elapsed time: 5463 RING LL RING us
 LL Sum LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum half Sum AllReduce half Elapsed time: 5503 half RING Elapsed time: 5109 us
 Elapsed time: 5320 LL us
 us
 Sum half Elapsed time: 5598 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       37/     100 | consumed samples:         2368 | elapsed time per iteration (ms): 199.0 | learning rate: 6.380E-05 | global batch size:    64 | lm loss: 7.806458E+00 | sop loss: 6.989788E-01 | loss scale: 65536.0 | grad norm: 3.078 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.20 | backward-compute: 97.40 | backward-params-all-reduce: 6.61 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.98 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1143 float float Elapsed time: 1660 us
 Elapsed time: 8 Elapsed time: 1415 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum half RING AllReduce half Elapsed time: 5064 SIMPLE RING Elapsed time: 5364 us
 Sum SIMPLE us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce Elapsed time: 5679 half AllReduce RING us
 Elapsed time: 5104 RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 us
 LL Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum half RING AllReduce half Elapsed time: 5161 LL RING Elapsed time: 5460 us
 Sum LL us
 half Sum Elapsed time: 5814 half us
 Elapsed time: 5230 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
 iteration       38/     100 | consumed samples:         2432 | elapsed time per iteration (ms): 199.0 | learning rate: 6.195E-05 | global batch size:    64 | lm loss: 7.843384E+00 | sop loss: 6.942789E-01 | loss scale: 65536.0 | grad norm: 1.907 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.21 | backward-compute: 97.40 | backward-params-all-reduce: 6.63 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.57 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.67 | optimizer: 21.95 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 1663 us
 Elapsed time: 1831 Elapsed time: 1889 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING AllReduce RING SIMPLE RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum SIMPLE Sum AllReduce half Sum half RING Elapsed time: 4990 half Elapsed time: 5569 SIMPLE us
 Elapsed time: 6130 us
 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Elapsed time: 5872 RING AllReduce RING us
 LL RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum LL Sum AllReduce half Sum half RING Elapsed time: 5088 half Elapsed time: 5665 LL us
 Elapsed time: 6261 us
 Sum us
 half Elapsed time: 6001 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
 iteration       39/     100 | consumed samples:         2496 | elapsed time per iteration (ms): 200.9 | learning rate: 6.009E-05 | global batch size:    64 | lm loss: 7.804807E+00 | sop loss: 6.926048E-01 | loss scale: 65536.0 | grad norm: 1.497 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.71 | backward-compute: 97.42 | backward-params-all-reduce: 7.21 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.36 | optimizer-unscale-and-check-inf: 2.87 | optimizer-clip-main-grad: 4.65 | optimizer-copy-main-to-model-params: 3.65 | optimizer: 22.63 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 1444 float Elapsed time: 8 Elapsed time: 1392 us
 Elapsed time: 1303 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING SIMPLE AllReduce SIMPLE Sum RING Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 half SIMPLE half AllReduce Elapsed time: 5533 Sum Elapsed time: 5013 RING us
 half us
 SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5320
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum AllReduce us
 AllReduce half RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING Elapsed time: 5822 LL AllReduce LL us
 Sum RING Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half LL half AllReduce Elapsed time: 5632 Sum Elapsed time: 5110 RING us
 half us
 LL Elapsed time: 5450 Sum us
 half Elapsed time: 5954 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
 iteration       40/     100 | consumed samples:         2560 | elapsed time per iteration (ms): 198.8 | learning rate: 5.824E-05 | global batch size:    64 | lm loss: 7.698965E+00 | sop loss: 6.803473E-01 | loss scale: 65536.0 | grad norm: 1.557 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.45 | backward-compute: 97.53 | backward-params-all-reduce: 6.70 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.48 | optimizer-unscale-and-check-inf: 2.74 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.60 | optimizer: 22.25 | batch-generator: 0.96
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 1027 us
 Elapsed time: 866 Elapsed time: 1013 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 40 | lm loss value: 7.752625E+00 | lm loss PPL: 2.327673E+03 | sop loss value: 7.361589E-01 | sop loss PPL: 2.087900E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000017000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 441 us
 Elapsed time: 538 Elapsed time: 460 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5658
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum AllReduce LL AllReduce half RING Sum RING Elapsed time: 5020 SIMPLE half SIMPLE us
 Sum Elapsed time: 5757 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half us
 half AllReduce Elapsed time: 5409 Elapsed time: 5063 RING us
 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum AllReduce AllReduce half RING RING Elapsed time: 5117 LL LL us
 Sum Sum half half Elapsed time: 5533 Elapsed time: 5199 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000088000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
 iteration       41/     100 | consumed samples:         2624 | elapsed time per iteration (ms): 262.4 | learning rate: 5.638E-05 | global batch size:    64 | lm loss: 7.690661E+00 | sop loss: 7.096262E-01 | loss scale: 65536.0 | grad norm: 3.115 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 132.95 | backward-compute: 97.26 | backward-params-all-reduce: 6.53 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.72 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.66 | optimizer: 22.09 | batch-generator: 1.53
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 45 us
 Elapsed time: 512 Elapsed time: 427 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE Sum AllReduce Sum half RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 half Elapsed time: 4977 SIMPLE AllReduce Elapsed time: 6109 us
 Sum RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce Elapsed time: 5140 Sum AllReduce RING us
 half RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5336 LL Sum AllReduce us
 Sum half RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half Elapsed time: 5079 LL AllReduce Elapsed time: 6207 us
 Sum RING us
 half LL Elapsed time: 5266 Sum us
 half Elapsed time: 5470 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       42/     100 | consumed samples:         2688 | elapsed time per iteration (ms): 198.0 | learning rate: 5.453E-05 | global batch size:    64 | lm loss: 7.604239E+00 | sop loss: 7.279773E-01 | loss scale: 65536.0 | grad norm: 4.446 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.09 | backward-compute: 97.55 | backward-params-all-reduce: 6.53 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.59 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.88 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000019000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 969 us
 Elapsed time: 441 Elapsed time: 501 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce SIMPLE RING Sum SIMPLE half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum Elapsed time: 5047
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce half us
 AllReduce RING Elapsed time: 5197
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING SIMPLE us
 AllReduce SIMPLE Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING Sum half AllReduce LL half Elapsed time: 5684 RING Sum Elapsed time: 5072 us
 LL half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum Elapsed time: 5144
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce half us
 AllReduce RING Elapsed time: 5294 RING LL us
 LL Sum Sum half half Elapsed time: 5817 Elapsed time: 5193 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
 iteration       43/     100 | consumed samples:         2752 | elapsed time per iteration (ms): 198.6 | learning rate: 5.267E-05 | global batch size:    64 | lm loss: 7.628188E+00 | sop loss: 6.978295E-01 | loss scale: 65536.0 | grad norm: 2.090 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.55 | backward-compute: 97.40 | backward-params-all-reduce: 6.74 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.57 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.92 | batch-generator: 0.97
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1553 float float Elapsed time: 8 us
 Elapsed time: 1795 Elapsed time: 1612 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5483 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE AllReduce Sum AllReduce Sum RING half RING half SIMPLE Elapsed time: 5581 SIMPLE Elapsed time: 5396 Sum us
 Sum us
 half half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5704 Elapsed time: 5024 AllReduce us
 us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL AllReduce AllReduce Sum RING RING half LL LL Elapsed time: 5491 Sum Sum us
 half half Elapsed time: 5829 Elapsed time: 5158 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       44/     100 | consumed samples:         2816 | elapsed time per iteration (ms): 201.3 | learning rate: 5.082E-05 | global batch size:    64 | lm loss: 7.572467E+00 | sop loss: 6.928813E-01 | loss scale: 65536.0 | grad norm: 1.588 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.69 | backward-compute: 97.30 | backward-params-all-reduce: 6.91 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.83 | optimizer-clip-main-grad: 6.34 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 24.00 | batch-generator: 1.32
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 1409 float Elapsed time: 8 float us
 Elapsed time: 2284 us
 Elapsed time: 1809 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5713
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce SIMPLE RING AllReduce RING Sum LL RING SIMPLE half Sum SIMPLE Sum Elapsed time: 5382 half Sum half us
 Elapsed time: 5811 half Elapsed time: 5780
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 Elapsed time: 5006 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5480 Sum half us
 half Elapsed time: 5912 Elapsed time: 5129 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       45/     100 | consumed samples:         2880 | elapsed time per iteration (ms): 198.1 | learning rate: 4.896E-05 | global batch size:    64 | lm loss: 7.633752E+00 | sop loss: 6.956639E-01 | loss scale: 65536.0 | grad norm: 1.918 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.09 | backward-compute: 97.31 | backward-params-all-reduce: 6.92 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.68 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 21.99 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 560 float float Elapsed time: 8 us
 Elapsed time: 330 Elapsed time: 253 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 RING AllReduce SIMPLE RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum SIMPLE AllReduce half Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING Elapsed time: 5096 half AllReduce SIMPLE us
 Elapsed time: 5005 RING Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 SIMPLE half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum Elapsed time: 5665 RING AllReduce half us
 LL RING Elapsed time: 5236
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum LL us
 AllReduce half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING Elapsed time: 5192 half AllReduce LL us
 Elapsed time: 5103 RING Sum us
 LL half Sum Elapsed time: 5789 half us
 Elapsed time: 5357 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       46/     100 | consumed samples:         2944 | elapsed time per iteration (ms): 198.3 | learning rate: 4.711E-05 | global batch size:    64 | lm loss: 7.594376E+00 | sop loss: 6.766107E-01 | loss scale: 65536.0 | grad norm: 1.231 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.02 | backward-compute: 97.37 | backward-params-all-reduce: 6.68 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.78 | optimizer-clip-main-grad: 4.52 | optimizer-copy-main-to-model-params: 3.60 | optimizer: 22.32 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 8 float Elapsed time: 625 float us
 Elapsed time: 881 us
 Elapsed time: 756 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5941
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce AllReduce SIMPLE AllReduce RING RING Sum RING SIMPLE LL half SIMPLE Sum Sum Elapsed time: 5049 Sum half half us
 half Elapsed time: 5322 Elapsed time: 6037
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5596 us
 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5144 Sum half us
 half Elapsed time: 5453 Elapsed time: 5718 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
 iteration       47/     100 | consumed samples:         3008 | elapsed time per iteration (ms): 198.7 | learning rate: 4.525E-05 | global batch size:    64 | lm loss: 7.525748E+00 | sop loss: 7.457288E-01 | loss scale: 65536.0 | grad norm: 5.354 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.37 | backward-compute: 97.64 | backward-params-all-reduce: 6.59 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.99 | batch-generator: 0.87
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 935 float float Elapsed time: 457 us
 Elapsed time: 8 Elapsed time: 598 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5457 RING us
 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum AllReduce AllReduce AllReduce half RING RING RING Elapsed time: 5452 SIMPLE SIMPLE LL us
 Sum Sum Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half half AllReduce Elapsed time: 5830 Elapsed time: 4976 Elapsed time: 5557 RING us
 us
 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum AllReduce AllReduce half RING RING Elapsed time: 5549 LL LL us
 Sum Sum half half Elapsed time: 5962 Elapsed time: 5105 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       48/     100 | consumed samples:         3072 | elapsed time per iteration (ms): 198.6 | learning rate: 4.340E-05 | global batch size:    64 | lm loss: 7.435813E+00 | sop loss: 6.693959E-01 | loss scale: 65536.0 | grad norm: 1.340 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.52 | backward-compute: 97.24 | backward-params-all-reduce: 6.98 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.65 | optimizer: 22.02 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 502 float Elapsed time: 8 Elapsed time: 150 us
 Elapsed time: 114 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5342 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING SIMPLE AllReduce RING LL Sum RING SIMPLE Sum half SIMPLE Sum half Elapsed time: 5001 Sum half Elapsed time: 5441 us
 half Elapsed time: 5091 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5341 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5097 Sum half us
 half Elapsed time: 5220 Elapsed time: 5471 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       49/     100 | consumed samples:         3136 | elapsed time per iteration (ms): 199.5 | learning rate: 4.154E-05 | global batch size:    64 | lm loss: 7.425218E+00 | sop loss: 7.086703E-01 | loss scale: 65536.0 | grad norm: 3.033 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.10 | backward-compute: 97.35 | backward-params-all-reduce: 6.53 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.98 | optimizer-clip-main-grad: 5.73 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 23.73 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 2122 float float Elapsed time: 8 us
 Elapsed time: 1977 Elapsed time: 1370 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5325 RING us
 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum AllReduce AllReduce AllReduce half RING RING RING Elapsed time: 5220 SIMPLE SIMPLE LL us
 Sum Sum Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half half AllReduce Elapsed time: 5660 Elapsed time: 5020 Elapsed time: 5423 RING us
 us
 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum AllReduce AllReduce half RING RING Elapsed time: 5316 LL LL us
 Sum Sum half half Elapsed time: 5797 Elapsed time: 5145 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       50/     100 | consumed samples:         3200 | elapsed time per iteration (ms): 198.0 | learning rate: 3.968E-05 | global batch size:    64 | lm loss: 7.384555E+00 | sop loss: 7.052233E-01 | loss scale: 65536.0 | grad norm: 2.598 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.04 | backward-compute: 97.34 | backward-params-all-reduce: 6.75 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.65 | optimizer: 22.03 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000019000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 907 float float Elapsed time: 388 us
 Elapsed time: 533 Elapsed time: 7 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 50 | lm loss value: 7.422451E+00 | lm loss PPL: 1.673129E+03 | sop loss value: 6.996937E-01 | sop loss PPL: 2.013136E+00 | 
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24----------------------------------------------------------------------------------------------------------------------------------------------------------[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING AllReduce LL AllReduce LL RING Sum RING Sum LL uint8_t LL uint8_t Sum Elapsed time: 177 Sum Elapsed time: 58 uint8_t us
 uint8_t us
 Elapsed time: 136 Elapsed time: 9 us
 us
saving checkpoint at iteration      50 to /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24/home/yuke/lyd/conda3/envs/pytorchNCCL-hao/lib/python3.9/site-packages/torch/nn/modules/module.py:1802: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8bf707a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8bf707a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum uint8_t Sum uint8_t uint8_t Elapsed time: 3526771 uint8_t Elapsed time: 3527559 Elapsed time: 3527579 us
 Elapsed time: 6 us
 us
 us
  successfully saved checkpoint at iteration      50 to /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000048000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL RING LL AllReduce Sum LL Sum RING uint8_t Sum uint8_t LL Elapsed time: 4400 uint8_t Elapsed time: 4383 Sum us
 Elapsed time: 4354 us
 uint8_t us
 Elapsed time: 6 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8bf707a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8bf707a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING RING AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL RING Sum AllReduce Sum LL uint8_t RING uint8_t Sum Elapsed time: 203 LL Elapsed time: 217 uint8_t us
 Sum us
 Elapsed time: 193 uint8_t us
 Elapsed time: 6 us
time (ms) | save-checkpoint: 3539.14
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 10135 float Elapsed time: 9919 float us
 Elapsed time: 9974 us
 Elapsed time: 7 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE SIMPLE AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 15982 Elapsed time: 16553 Sum half us
 us
 half Elapsed time: 15858
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 4871 us
 AllReduce AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL LL AllReduce RING Sum Sum RING LL half half LL Sum Elapsed time: 16080 Elapsed time: 16660 Sum half us
 us
 half Elapsed time: 15987 Elapsed time: 5002 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
 iteration       51/     100 | consumed samples:         3264 | elapsed time per iteration (ms): 3824.1 | learning rate: 3.783E-05 | global batch size:    64 | lm loss: 7.365117E+00 | sop loss: 6.856692E-01 | loss scale: 65536.0 | grad norm: 2.467 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 143.10 | backward-compute: 97.75 | backward-params-all-reduce: 17.56 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.65 | optimizer-unscale-and-check-inf: 2.66 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.60 | optimizer: 22.37 | batch-generator: 1.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000060000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000018000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 553 float float Elapsed time: 8 us
 Elapsed time: 347 Elapsed time: 385 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5393
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce SIMPLE AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING Sum RING AllReduce LL half SIMPLE RING Sum Elapsed time: 4972 Sum SIMPLE half us
 half Sum Elapsed time: 5496
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5124 half us
 AllReduce us
 Elapsed time: 5520 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 LL AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum RING AllReduce half LL RING Elapsed time: 5070 Sum LL us
 half Sum Elapsed time: 5251 half us
 Elapsed time: 5649 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
 iteration       52/     100 | consumed samples:         3328 | elapsed time per iteration (ms): 198.4 | learning rate: 3.597E-05 | global batch size:    64 | lm loss: 7.306406E+00 | sop loss: 6.921765E-01 | loss scale: 65536.0 | grad norm: 1.484 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.06 | backward-compute: 97.41 | backward-params-all-reduce: 6.49 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.59 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1166 float float Elapsed time: 8 us
 Elapsed time: 654 Elapsed time: 902 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 half RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce Elapsed time: 5416 SIMPLE AllReduce RING us
 Sum RING SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half SIMPLE Sum AllReduce Elapsed time: 5037 Sum half RING us
 half Elapsed time: 5000 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5432 us
 Sum AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Elapsed time: 5515 LL AllReduce RING us
 Sum RING LL half LL Sum Elapsed time: 5132 Sum half us
 half Elapsed time: 5124 Elapsed time: 5554 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       53/     100 | consumed samples:         3392 | elapsed time per iteration (ms): 197.9 | learning rate: 3.412E-05 | global batch size:    64 | lm loss: 7.337127E+00 | sop loss: 6.894203E-01 | loss scale: 65536.0 | grad norm: 1.286 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.07 | backward-compute: 97.36 | backward-params-all-reduce: 6.60 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.42 | optimizer-copy-main-to-model-params: 3.69 | optimizer: 22.08 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum float float Sum float Elapsed time: 7 Elapsed time: 1458 float Elapsed time: 1836 us
 us
 Elapsed time: 1875 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5320 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce LL Sum AllReduce RING Sum half RING SIMPLE half Elapsed time: 5059 SIMPLE Sum Elapsed time: 5418 us
 Sum half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5624 AllReduce Elapsed time: 5045 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5156 LL Sum us
 Sum half half Elapsed time: 5758 Elapsed time: 5173 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000057000 seconds
 iteration       54/     100 | consumed samples:         3456 | elapsed time per iteration (ms): 199.4 | learning rate: 3.226E-05 | global batch size:    64 | lm loss: 7.298626E+00 | sop loss: 7.030248E-01 | loss scale: 65536.0 | grad norm: 2.388 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.50 | backward-compute: 97.40 | backward-params-all-reduce: 6.63 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.72 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.64 | optimizer: 22.09 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 2348 float float Elapsed time: 1551 us
 Elapsed time: 8 Elapsed time: 2000 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5439
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE RING AllReduce RING Sum LL RING SIMPLE half Sum SIMPLE Sum Elapsed time: 5075 half Sum half us
 Elapsed time: 5536 half Elapsed time: 5023
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 Elapsed time: 5504 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5171 Sum half us
 half Elapsed time: 5144 Elapsed time: 5625 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
 iteration       55/     100 | consumed samples:         3520 | elapsed time per iteration (ms): 199.3 | learning rate: 3.041E-05 | global batch size:    64 | lm loss: 7.278763E+00 | sop loss: 6.967686E-01 | loss scale: 65536.0 | grad norm: 1.884 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.61 | backward-compute: 97.34 | backward-params-all-reduce: 6.62 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.34 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.93 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 215 float Elapsed time: 8 Elapsed time: 213 us
 Elapsed time: 233 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5365 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE AllReduce LL AllReduce Sum RING Sum RING half SIMPLE half SIMPLE Elapsed time: 5094 Sum Elapsed time: 5463 Sum us
 half us
 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5017 Elapsed time: 5527 AllReduce us
 us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL AllReduce AllReduce Sum RING RING half LL LL Elapsed time: 5191 Sum Sum us
 half half Elapsed time: 5150 Elapsed time: 5658 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       56/     100 | consumed samples:         3584 | elapsed time per iteration (ms): 197.9 | learning rate: 2.855E-05 | global batch size:    64 | lm loss: 7.299470E+00 | sop loss: 7.362754E-01 | loss scale: 65536.0 | grad norm: 5.760 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.03 | backward-compute: 97.34 | backward-params-all-reduce: 6.62 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.60 | optimizer: 22.10 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 712 float float Elapsed time: 8 us
 Elapsed time: 392 Elapsed time: 432 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING AllReduce RING SIMPLE RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum half AllReduce Sum half Elapsed time: 5479 RING half Elapsed time: 5002 us
 SIMPLE Elapsed time: 5186 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING Elapsed time: 5532 AllReduce RING LL us
 RING LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Sum half AllReduce Sum half Elapsed time: 5576 RING half Elapsed time: 5100 us
 LL Elapsed time: 5312 us
 Sum us
 half Elapsed time: 5662 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       57/     100 | consumed samples:         3648 | elapsed time per iteration (ms): 197.9 | learning rate: 2.670E-05 | global batch size:    64 | lm loss: 7.361423E+00 | sop loss: 7.044142E-01 | loss scale: 65536.0 | grad norm: 2.749 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.09 | backward-compute: 97.34 | backward-params-all-reduce: 6.58 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.96 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 454 float Elapsed time: 8 float us
 Elapsed time: 359 us
 Elapsed time: 316 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5482
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING Sum AllReduce AllReduce LL half RING RING Sum Elapsed time: 5182 SIMPLE SIMPLE half us
 Sum Sum Elapsed time: 5580
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half us
 AllReduce Elapsed time: 5056 Elapsed time: 5600 RING us
 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum AllReduce AllReduce half RING RING Elapsed time: 5277 LL LL us
 Sum Sum half half Elapsed time: 5177 Elapsed time: 5724 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
 iteration       58/     100 | consumed samples:         3712 | elapsed time per iteration (ms): 197.9 | learning rate: 2.484E-05 | global batch size:    64 | lm loss: 7.248400E+00 | sop loss: 6.945906E-01 | loss scale: 65536.0 | grad norm: 1.910 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.03 | backward-compute: 97.28 | backward-params-all-reduce: 6.70 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.78 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 22.06 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 1048 us
 Elapsed time: 1485 Elapsed time: 1586 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5427 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 LL SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce Sum Sum AllReduce RING half half RING SIMPLE Elapsed time: 5523 Elapsed time: 5044 SIMPLE Sum us
 us
 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5167 AllReduce Elapsed time: 5577 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5141 LL Sum us
 Sum half half Elapsed time: 5299 Elapsed time: 5705 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       59/     100 | consumed samples:         3776 | elapsed time per iteration (ms): 199.1 | learning rate: 2.299E-05 | global batch size:    64 | lm loss: 7.242190E+00 | sop loss: 6.805731E-01 | loss scale: 65536.0 | grad norm: 3.307 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.30 | backward-compute: 97.36 | backward-params-all-reduce: 6.55 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.56 | optimizer: 21.95 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1797 float float Elapsed time: 8 us
 Elapsed time: 553 Elapsed time: 1885 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5558 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE LL AllReduce RING Sum Sum RING SIMPLE half half SIMPLE Sum Elapsed time: 4997 Elapsed time: 5656 Sum half us
 us
 half Elapsed time: 5197
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5879 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5093 Sum half us
 half Elapsed time: 5329 Elapsed time: 6014 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       60/     100 | consumed samples:         3840 | elapsed time per iteration (ms): 199.5 | learning rate: 2.113E-05 | global batch size:    64 | lm loss: 7.258093E+00 | sop loss: 7.142962E-01 | loss scale: 65536.0 | grad norm: 3.486 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.96 | backward-compute: 97.74 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.92 | batch-generator: 1.64
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 1540 float Elapsed time: 7 Elapsed time: 1766 us
 Elapsed time: 1628 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 60 | lm loss value: 7.340408E+00 | lm loss PPL: 1.541341E+03 | sop loss value: 6.627727E-01 | sop loss PPL: 1.940164E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 7 float Elapsed time: 536 float us
 Elapsed time: 598 us
 Elapsed time: 610 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5970
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE AllReduce RING Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING LL half AllReduce SIMPLE Sum Elapsed time: 5273 RING Sum half us
 SIMPLE half Elapsed time: 6068
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum Elapsed time: 5498 us
 AllReduce half us
 RING Elapsed time: 5063
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL us
 AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING half AllReduce LL Elapsed time: 5369 RING Sum us
 LL half Sum Elapsed time: 5619 half us
 Elapsed time: 5196 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       61/     100 | consumed samples:         3904 | elapsed time per iteration (ms): 264.2 | learning rate: 1.928E-05 | global batch size:    64 | lm loss: 7.274001E+00 | sop loss: 7.256088E-01 | loss scale: 65536.0 | grad norm: 4.238 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 134.47 | backward-compute: 97.19 | backward-params-all-reduce: 6.79 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.97 | batch-generator: 1.48
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 2153 float float Elapsed time: 8 us
 Elapsed time: 1904 Elapsed time: 1942 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE AllReduce Sum AllReduce Sum RING half RING half SIMPLE Elapsed time: 6327 SIMPLE Elapsed time: 4988 Sum us
 Sum us
 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5546 AllReduce Elapsed time: 5911 AllReduce us
 RING us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL AllReduce Sum AllReduce Sum RING half RING half LL Elapsed time: 6424 LL Elapsed time: 5087 Sum us
 Sum us
 half half Elapsed time: 5684 Elapsed time: 6033 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000057000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
 iteration       62/     100 | consumed samples:         3968 | elapsed time per iteration (ms): 199.7 | learning rate: 1.742E-05 | global batch size:    64 | lm loss: 7.267147E+00 | sop loss: 7.458596E-01 | loss scale: 65536.0 | grad norm: 5.502 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.87 | backward-compute: 97.79 | backward-params-all-reduce: 6.56 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.72 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.02 | batch-generator: 1.54
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1311 float float Elapsed time: 599 us
 Elapsed time: 8 Elapsed time: 1557 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5406 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING LL SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum AllReduce half AllReduce half RING Elapsed time: 5505 RING Elapsed time: 4973 SIMPLE us
 SIMPLE us
 Sum Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half AllReduce Elapsed time: 5638 Elapsed time: 5170 RING us
 us
 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Sum AllReduce AllReduce half RING RING Elapsed time: 5070 LL LL us
 Sum Sum half half Elapsed time: 5770 Elapsed time: 5306 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000052000 seconds
 iteration       63/     100 | consumed samples:         4032 | elapsed time per iteration (ms): 199.7 | learning rate: 1.557E-05 | global batch size:    64 | lm loss: 7.164820E+00 | sop loss: 6.892351E-01 | loss scale: 65536.0 | grad norm: 1.798 | number of skipped iterations:   0 | number of nan iterations:   0 |[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes

time (ms) | forward-compute: 71.42 | backward-compute: 97.44 | backward-params-all-reduce: 6.53 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.36 | optimizer-unscale-and-check-inf: 2.81 | optimizer-clip-main-grad: 4.51 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 22.33 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 660 us
 Elapsed time: 1495 Elapsed time: 1752 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 5046 AllReduce us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING half AllReduce RING LL Elapsed time: 5083 RING SIMPLE Sum us
 SIMPLE Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum half Elapsed time: 5143 AllReduce half Elapsed time: 5444 us
 RING Elapsed time: 5036 us
 LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce half AllReduce RING Elapsed time: 5181 RING LL us
 LL Sum Sum half half Elapsed time: 5572 Elapsed time: 5167 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       64/     100 | consumed samples:         4096 | elapsed time per iteration (ms): 199.1 | learning rate: 1.371E-05 | global batch size:    64 | lm loss: 7.213695E+00 | sop loss: 6.930702E-01 | loss scale: 65536.0 | grad norm: 1.904 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.97 | backward-compute: 97.73 | backward-params-all-reduce: 6.62 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.96 | batch-generator: 0.91
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 451 float float Elapsed time: 8 us
 Elapsed time: 237 Elapsed time: 311 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce half half AllReduce RING Elapsed time: 5383 Elapsed time: 5419 RING SIMPLE us
 us
 SIMPLE Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum half AllReduce AllReduce half Elapsed time: 5775 RING LL RING Elapsed time: 5015 us
 Sum LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Elapsed time: 5480 half AllReduce RING us
 Elapsed time: 5515 RING LL us
 LL Sum Sum half half Elapsed time: 5897 Elapsed time: 5136 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       65/     100 | consumed samples:         4160 | elapsed time per iteration (ms): 199.8 | learning rate: 1.186E-05 | global batch size:    64 | lm loss: 7.189982E+00 | sop loss: 6.864401E-01 | loss scale: 65536.0 | grad norm: 1.169 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.08 | backward-compute: 97.32 | backward-params-all-reduce: 6.97 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.76 | optimizer-clip-main-grad: 5.71 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 23.66 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 2127 us
 Elapsed time: 1947 Elapsed time: 615 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce SIMPLE RING Sum SIMPLE half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum Elapsed time: 5335 AllReduce half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 us
 RING Elapsed time: 5188 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 SIMPLE us
 RING AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 SIMPLE RING half AllReduce Sum LL Elapsed time: 5618 RING half Sum us
 LL Elapsed time: 5056 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum us
 Elapsed time: 5433 AllReduce half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 RING Elapsed time: 5284 AllReduce LL us
 RING Sum LL half Sum Elapsed time: 5748 half us
 Elapsed time: 5184 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       66/     100 | consumed samples:         4224 | elapsed time per iteration (ms): 197.9 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.235250E+00 | sop loss: 7.052993E-01 | loss scale: 65536.0 | grad norm: 2.694 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.08 | backward-compute: 97.31 | backward-params-all-reduce: 6.73 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.94 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 298 float float Elapsed time: 8 us
 Elapsed time: 166 Elapsed time: 267 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 Elapsed time: 5312 AllReduce us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING Sum AllReduce RING SIMPLE half RING LL Sum Elapsed time: 6005 SIMPLE Sum half us
 Sum half Elapsed time: 5634
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half Elapsed time: 5410 us
 AllReduce Elapsed time: 4988 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING us
 AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING Sum AllReduce LL half RING Sum Elapsed time: 6102 LL half us
 Sum Elapsed time: 5764 half us
 Elapsed time: 5118 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
 iteration       67/     100 | consumed samples:         4288 | elapsed time per iteration (ms): 198.2 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.258782E+00 | sop loss: 7.083008E-01 | loss scale: 65536.0 | grad norm: 3.489 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.04 | backward-compute: 97.55 | backward-params-all-reduce: 6.83 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 22.01 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 340 us
 Elapsed time: 219 Elapsed time: 324 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum half AllReduce RING half Elapsed time: 5709 RING SIMPLE Elapsed time: 5532 us
 SIMPLE Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce half Elapsed time: 5961 AllReduce RING Elapsed time: 5027 us
 RING LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum half AllReduce RING half Elapsed time: 5806 RING LL Elapsed time: 5628 us
 LL Sum us
 Sum half half Elapsed time: 6089 Elapsed time: 5150 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
 iteration       68/     100 | consumed samples:         4352 | elapsed time per iteration (ms): 198.6 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.249082E+00 | sop loss: 7.008470E-01 | loss scale: 65536.0 | grad norm: 2.433 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.12 | backward-compute: 97.37 | backward-params-all-reduce: 7.10 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.61 | optimizer: 22.15 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 203 float float Elapsed time: 8 us
 Elapsed time: 776 Elapsed time: 367 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 Sum AllReduce half RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Elapsed time: 5303 SIMPLE AllReduce AllReduce us
 Sum RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half SIMPLE SIMPLE AllReduce Elapsed time: 5524 Sum Sum RING us
 half half LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 4919 Elapsed time: 5314 Sum AllReduce us
 us
 half RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 Elapsed time: 5402 LL AllReduce AllReduce us
 Sum RING RING half LL LL Elapsed time: 5622 Sum Sum us
 half half Elapsed time: 5051 Elapsed time: 5450 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       69/     100 | consumed samples:         4416 | elapsed time per iteration (ms): 198.1 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.208697E+00 | sop loss: 6.937556E-01 | loss scale: 65536.0 | grad norm: 2.697 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.28 | backward-compute: 97.30 | backward-params-all-reduce: 6.82 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.97 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000046000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 2058 float float Elapsed time: 1785 us
 Elapsed time: 2033 Elapsed time: 8 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 6197 RING us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce Sum AllReduce AllReduce RING half RING RING SIMPLE Elapsed time: 4980 SIMPLE LL Sum us
 Sum Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half Elapsed time: 5899 AllReduce Elapsed time: 6213 Elapsed time: 6305 us
 RING us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5077 LL Sum us
 Sum half half Elapsed time: 6027 Elapsed time: 6348 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
 iteration       70/     100 | consumed samples:         4480 | elapsed time per iteration (ms): 200.8 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.225807E+00 | sop loss: 6.983082E-01 | loss scale: 65536.0 | grad norm: 2.390 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.91 | backward-compute: 98.01 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.80 | optimizer-clip-main-grad: 4.55 | optimizer-copy-main-to-model-params: 3.62 | optimizer: 22.38 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1148 float float Elapsed time: 8 us
 Elapsed time: 951 Elapsed time: 1179 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 70 | lm loss value: 7.363050E+00 | lm loss PPL: 1.576639E+03 | sop loss value: 7.019970E-01 | sop loss PPL: 2.017778E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1969 float float Elapsed time: 8 us
 Elapsed time: 1796 Elapsed time: 1789 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE AllReduce Sum RING half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Elapsed time: 5764 AllReduce Sum us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING half
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce SIMPLE Elapsed time: 5431 AllReduce RING Sum us
 RING SIMPLE half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 LL Sum Elapsed time: 5978 AllReduce Sum half us
 RING half Elapsed time: 5028
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL Elapsed time: 5861 us
 AllReduce Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING half AllReduce LL Elapsed time: 5527 RING Sum us
 LL half Sum Elapsed time: 6100 half us
 Elapsed time: 5161 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       71/     100 | consumed samples:         4544 | elapsed time per iteration (ms): 264.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.189688E+00 | sop loss: 6.674684E-01 | loss scale: 65536.0 | grad norm: 4.143 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 132.90 | backward-compute: 97.36 | backward-params-all-reduce: 6.98 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.72 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 22.02 | batch-generator: 1.84
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 2110 float float Elapsed time: 8 us
 Elapsed time: 1902 Elapsed time: 1303 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5429 RING us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum AllReduce AllReduce RING half RING RING SIMPLE Elapsed time: 5685 LL SIMPLE Sum us
 Sum Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half half Elapsed time: 6073 AllReduce Elapsed time: 5526 Elapsed time: 5027 us
 RING us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5781 LL Sum us
 Sum half half Elapsed time: 6200 Elapsed time: 5157 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000056000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       72/     100 | consumed samples:         4608 | elapsed time per iteration (ms): 199.9 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.140197E+00 | sop loss: 6.924188E-01 | loss scale: 65536.0 | grad norm: 1.423 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.98 | backward-compute: 97.35 | backward-params-all-reduce: 7.22 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.38 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.05 | batch-generator: 1.63
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 1437 us
 Elapsed time: 1628 Elapsed time: 1870 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce Sum half AllReduce RING half Elapsed time: 5673 RING SIMPLE Elapsed time: 5255 us
 SIMPLE Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce half Elapsed time: 5436 AllReduce RING Elapsed time: 4911 us
 RING LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce Sum half AllReduce RING half Elapsed time: 5775 RING LL Elapsed time: 5353 us
 LL Sum us
 Sum half half Elapsed time: 5571 Elapsed time: 5048 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       73/     100 | consumed samples:         4672 | elapsed time per iteration (ms): 199.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.149151E+00 | sop loss: 7.272941E-01 | loss scale: 65536.0 | grad norm: 4.569 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.55 | backward-compute: 97.37 | backward-params-all-reduce: 6.82 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.67 | optimizer: 22.01 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000021000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 1375 us
 Elapsed time: 1654 Elapsed time: 1740 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000014000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5637 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING SIMPLE AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 LL Sum RING AllReduce Sum half SIMPLE RING half Elapsed time: 4977 Sum SIMPLE Elapsed time: 5734 us
 half Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5333 half AllReduce us
 Elapsed time: 5756 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 LL AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum RING AllReduce half LL RING Elapsed time: 5075 Sum LL us
 half Sum Elapsed time: 5463 half us
 Elapsed time: 5886 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       74/     100 | consumed samples:         4736 | elapsed time per iteration (ms): 197.2 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.235824E+00 | sop loss: 6.746373E-01 | loss scale: 65536.0 | grad norm: 0.967 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.45 | backward-compute: 97.74 | backward-params-all-reduce: 6.49 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 2.22 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 19.71 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 8 float Elapsed time: 37 float us
 Elapsed time: 381 us
 Elapsed time: 321 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5629 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING SIMPLE AllReduce RING LL Sum RING SIMPLE Sum half SIMPLE Sum half Elapsed time: 5024 Sum half Elapsed time: 5726 us
 half Elapsed time: 5166 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5552 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5121 Sum half us
 half Elapsed time: 5298 Elapsed time: 5678 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       75/     100 | consumed samples:         4800 | elapsed time per iteration (ms): 198.0 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.126987E+00 | sop loss: 6.935951E-01 | loss scale: 65536.0 | grad norm: 1.808 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.14 | backward-compute: 97.43 | backward-params-all-reduce: 6.57 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.32 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.93 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 525 float float Elapsed time: 8 us
 Elapsed time: 77 Elapsed time: 255 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5318
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE RING AllReduce AllReduce Sum LL RING RING half Sum SIMPLE SIMPLE Elapsed time: 5142 half Sum Sum us
 Elapsed time: 5417 half half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 Elapsed time: 4984 Elapsed time: 5525 AllReduce us
 us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL AllReduce AllReduce Sum RING RING half LL LL Elapsed time: 5240 Sum Sum us
 half half Elapsed time: 5117 Elapsed time: 5660 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       76/     100 | consumed samples:         4864 | elapsed time per iteration (ms): 195.6 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.277185E+00 | sop loss: 6.760061E-01 | loss scale: 65536.0 | grad norm: 0.936 | number of skipped iterations:   0 | number of nan iterations:   0 |[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes

time (ms) | forward-compute: 70.06 | backward-compute: 97.32 | backward-params-all-reduce: 6.67 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 2.21 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 19.75 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000054000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 558 float Elapsed time: 8 Elapsed time: 825 us
 Elapsed time: 773 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum Sum AllReduce RING half half RING SIMPLE Elapsed time: 4967 Elapsed time: 5997 SIMPLE Sum us
 us
 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 6617 AllReduce AllReduce Elapsed time: 6180 us
 RING RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum Sum AllReduce RING half half RING LL Elapsed time: 5072 Elapsed time: 6095 LL Sum us
 us
 Sum half half Elapsed time: 6748 Elapsed time: 6311 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
 iteration       77/     100 | consumed samples:         4928 | elapsed time per iteration (ms): 206.4 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.218236E+00 | sop loss: 7.018337E-01 | loss scale: 65536.0 | grad norm: 2.378 | number of skipped iterations:   0 | number of nan iterations:   0 |[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes

[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
time (ms) | forward-compute: 70.02 | backward-compute: 97.45 | backward-params-all-reduce: 7.56 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.66 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 960 float float Elapsed time: 8 us
 Elapsed time: 1074 Elapsed time: 861 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce SIMPLE Sum AllReduce RING Sum half RING SIMPLE half Elapsed time: 4921 SIMPLE Sum Elapsed time: 5290 us
 Sum half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 4981
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce Elapsed time: 5515 us
 AllReduce RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce LL Sum AllReduce RING Sum half RING LL half Elapsed time: 5031 LL Sum Elapsed time: 5395 us
 Sum half us
 half Elapsed time: 5113 Elapsed time: 5642 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       78/     100 | consumed samples:         4992 | elapsed time per iteration (ms): 197.9 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.159207E+00 | sop loss: 6.807369E-01 | loss scale: 65536.0 | grad norm: 1.085 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.10 | backward-compute: 97.43 | backward-params-all-reduce: 6.50 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.61 | optimizer: 21.98 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 7 float Elapsed time: 1180 float us
 Elapsed time: 1516 us
 Elapsed time: 1436 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE SIMPLE AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum Sum RING AllReduce half half SIMPLE RING Elapsed time: 5377 Elapsed time: 5053 Sum SIMPLE us
 us
 half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5054 half AllReduce AllReduce us
 Elapsed time: 5431 RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 LL LL AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum Sum RING AllReduce half half LL RING Elapsed time: 5474 Elapsed time: 5149 Sum LL us
 us
 half Sum Elapsed time: 5181 half us
 Elapsed time: 5562 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
 iteration       79/     100 | consumed samples:         5056 | elapsed time per iteration (ms): 196.7 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.222690E+00 | sop loss: 6.811157E-01 | loss scale: 65536.0 | grad norm: 0.963 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.26 | backward-compute: 97.30 | backward-params-all-reduce: 6.61 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 2.23 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 19.71 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 218 float float Elapsed time: 8 us
 Elapsed time: 218 Elapsed time: 269 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5168
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING SIMPLE RING RING SIMPLE Sum LL SIMPLE Sum half Sum Sum half Elapsed time: 4999 half half Elapsed time: 5092 us
 Elapsed time: 5266 Elapsed time: 5488 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce RING LL RING LL Sum LL Sum half Sum half Elapsed time: 5096 half Elapsed time: 5225 us
 Elapsed time: 5619 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       80/     100 | consumed samples:         5120 | elapsed time per iteration (ms): 199.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.195199E+00 | sop loss: 7.324027E-01 | loss scale: 65536.0 | grad norm: 5.105 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.05 | backward-compute: 97.35 | backward-params-all-reduce: 6.56 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.34 | optimizer-unscale-and-check-inf: 3.22 | optimizer-clip-main-grad: 5.69 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 23.74 | batch-generator: 0.75
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 277 float float Elapsed time: 8 us
 Elapsed time: 2177 Elapsed time: 1956 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 80 | lm loss value: 7.287707E+00 | lm loss PPL: 1.462214E+03 | sop loss value: 6.942420E-01 | sop loss PPL: 2.002191E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING RING AllReduce AllReduce LL LL RING RING Sum Sum LL LL float float Sum Sum Elapsed time: 239 Elapsed time: 8 float float us
 us
 Elapsed time: 47 Elapsed time: 58 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5711 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING Elapsed time: 5810
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce SIMPLE us
 AllReduce RING Sum RING SIMPLE half SIMPLE Sum Elapsed time: 5224 Sum half us
 half Elapsed time: 5802
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5013 us
 AllReduce us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5319 Sum half us
 half Elapsed time: 5923 Elapsed time: 5147 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       81/     100 | consumed samples:         5184 | elapsed time per iteration (ms): 262.2 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.165642E+00 | sop loss: 7.166770E-01 | loss scale: 65536.0 | grad norm: 3.760 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 132.35 | backward-compute: 97.47 | backward-params-all-reduce: 6.78 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.68 | optimizer-clip-main-grad: 4.42 | optimizer-copy-main-to-model-params: 3.69 | optimizer: 22.08 | batch-generator: 1.39
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1866 float float Elapsed time: 915 us
 Elapsed time: 7 Elapsed time: 1202 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5659 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 Sum AllReduce Sum AllReduce half RING half RING Elapsed time: 5767 SIMPLE Elapsed time: 5421 SIMPLE us
 Sum us
 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5999 AllReduce Elapsed time: 5011 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5517 LL Sum us
 Sum half half Elapsed time: 6132 Elapsed time: 5141 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000050000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000045000 seconds
 iteration       82/     100 | consumed samples:         5248 | elapsed time per iteration (ms): 199.4 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.141020E+00 | sop loss: 7.059278E-01 | loss scale: 65536.0 | grad norm: 2.760 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.19 | backward-compute: 97.24 | backward-params-all-reduce: 6.93 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.70 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 21.98 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000049000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 271 float float Elapsed time: 8 us
 Elapsed time: 213 Elapsed time: 124 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5949
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 us
 AllReduce SIMPLE AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING Sum RING AllReduce SIMPLE half SIMPLE RING Sum Elapsed time: 5014 Sum LL half us
 half Sum Elapsed time: 5924
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5527 half us
 AllReduce us
 Elapsed time: 6046
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 AllReduce LL AllReduce RING Sum RING LL half LL Sum Elapsed time: 5111 Sum half us
 half Elapsed time: 6044 Elapsed time: 5657 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000051000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       83/     100 | consumed samples:         5312 | elapsed time per iteration (ms): 198.4 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.258257E+00 | sop loss: 7.043935E-01 | loss scale: 65536.0 | grad norm: 3.582 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.08 | backward-compute: 97.94 | backward-params-all-reduce: 6.56 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 4.46 | optimizer-copy-main-to-model-params: 3.64 | optimizer: 22.03 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000077000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1371 float float Elapsed time: 835 us
 Elapsed time: 98 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 6059 AllReduce us
 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE AllReduce AllReduce AllReduce Sum RING RING RING half SIMPLE LL SIMPLE Elapsed time: 4982 Sum Sum Sum us
 half half half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 6046 Elapsed time: 6159 Elapsed time: 5704 AllReduce us
 us
 us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL AllReduce AllReduce Sum RING RING half LL LL Elapsed time: 5080 Sum Sum us
 half half Elapsed time: 6177 Elapsed time: 5840 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
 iteration       84/     100 | consumed samples:         5376 | elapsed time per iteration (ms): 200.1 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.183196E+00 | sop loss: 6.947051E-01 | loss scale: 65536.0 | grad norm: 1.892 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.39 | backward-compute: 97.84 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.34 | optimizer-unscale-and-check-inf: 2.75 | optimizer-clip-main-grad: 4.52 | optimizer-copy-main-to-model-params: 3.67 | optimizer: 22.28 | batch-generator: 1.02
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1160 float float Elapsed time: 214 us
 Elapsed time: 835 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING SIMPLE AllReduce SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum RING Sum AllReduce half SIMPLE half RING Elapsed time: 5487 Sum Elapsed time: 4971 SIMPLE us
 half us
 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5067
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half AllReduce us
 AllReduce Elapsed time: 5399 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING us
 LL AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum RING Sum AllReduce half LL half RING Elapsed time: 5587 Sum Elapsed time: 5069 LL us
 half us
 Sum Elapsed time: 5202 half us
 Elapsed time: 5522 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       85/     100 | consumed samples:         5440 | elapsed time per iteration (ms): 196.1 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.220216E+00 | sop loss: 6.923672E-01 | loss scale: 65536.0 | grad norm: 0.891 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.50 | backward-compute: 97.39 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 2.22 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 19.78 | batch-generator: 0.87
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 424 us
 Elapsed time: 428 Elapsed time: 367 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Elapsed time: 5886 AllReduce us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 SIMPLE AllReduce Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 half AllReduce LL AllReduce Elapsed time: 5753 RING Sum RING us
 SIMPLE half SIMPLE
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum Elapsed time: 5983 Sum AllReduce half us
 half RING Elapsed time: 6054 Elapsed time: 4995 LL us
 us
 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 half AllReduce AllReduce Elapsed time: 5848 RING RING us
 LL LL Sum Sum half half Elapsed time: 6188 Elapsed time: 5127 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       86/     100 | consumed samples:         5504 | elapsed time per iteration (ms): 196.1 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.236205E+00 | sop loss: 6.906007E-01 | loss scale: 65536.0 | grad norm: 0.863 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.11 | backward-compute: 97.24 | backward-params-all-reduce: 7.25 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 2.21 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 19.75 | batch-generator: 0.79
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 530 float float Elapsed time: 8 us
 Elapsed time: 300 Elapsed time: 280 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5218 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING SIMPLE RING RING LL Sum SIMPLE SIMPLE Sum half Sum Sum half Elapsed time: 4996 half half Elapsed time: 5316 us
 Elapsed time: 5612 Elapsed time: 5052 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us
 us
 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce AllReduce LL RING RING Sum LL LL half Sum Sum Elapsed time: 5092 half half us
 Elapsed time: 5737 Elapsed time: 5174 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000035000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       87/     100 | consumed samples:         5568 | elapsed time per iteration (ms): 198.1 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.134693E+00 | sop loss: 7.043263E-01 | loss scale: 65536.0 | grad norm: 2.588 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.13 | backward-compute: 97.48 | backward-params-all-reduce: 6.59 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.60 | optimizer: 22.06 | batch-generator: 0.78
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1725 float float Elapsed time: 1205 us
 Elapsed time: 1629 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce half RING Elapsed time: 6386
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING half AllReduce RING SIMPLE Elapsed time: 6282 RING SIMPLE Sum us
 LL Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum half Elapsed time: 6080 AllReduce half Elapsed time: 5033 us
 RING Elapsed time: 6483 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum AllReduce RING half RING LL Elapsed time: 6378 LL Sum us
 Sum half half Elapsed time: 6209 Elapsed time: 5159 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000044000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
 iteration       88/     100 | consumed samples:         5632 | elapsed time per iteration (ms): 201.0 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.228160E+00 | sop loss: 7.239790E-01 | loss scale: 65536.0 | grad norm: 4.382 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.36 | backward-compute: 97.38 | backward-params-all-reduce: 7.84 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.34 | optimizer-unscale-and-check-inf: 2.64 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.64 | optimizer: 22.68 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 675 us
 Elapsed time: 838 Elapsed time: 102 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE AllReduce Sum RING half SIMPLE Elapsed time: 5258 Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 us
 half AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5196 RING RING AllReduce us
 SIMPLE SIMPLE RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum Sum LL AllReduce half half Sum RING Elapsed time: 5004 Elapsed time: 5573 half LL us
 us
 Elapsed time: 5355 Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 us
 half AllReduce AllReduce Elapsed time: 5292 RING RING us
 LL LL Sum Sum half half Elapsed time: 5135 Elapsed time: 5709 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000041000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
 iteration       89/     100 | consumed samples:         5696 | elapsed time per iteration (ms): 199.2 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.201015E+00 | sop loss: 7.406560E-01 | loss scale: 65536.0 | grad norm: 5.942 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.78 | backward-compute: 97.45 | backward-params-all-reduce: 6.75 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.66 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.61 | optimizer: 22.41 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 1322 float Elapsed time: 635 Elapsed time: 1084 us
 Elapsed time: 8 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5207 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING LL AllReduce RING SIMPLE Sum RING SIMPLE Sum half SIMPLE Sum half Elapsed time: 5303 Sum half Elapsed time: 5022 us
 half Elapsed time: 4997 us
 Elapsed time: 5649 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce RING LL RING LL Sum LL Sum half Sum half Elapsed time: 5120 half Elapsed time: 5126 us
 Elapsed time: 5784 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       90/     100 | consumed samples:         5760 | elapsed time per iteration (ms): 198.9 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.089562E+00 | sop loss: 7.045947E-01 | loss scale: 65536.0 | grad norm: 2.621 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.77 | backward-compute: 97.51 | backward-params-all-reduce: 6.56 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.56 | optimizer-unscale-and-check-inf: 2.73 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 22.21 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 7 float float Elapsed time: 611 us
 Elapsed time: 1076 Elapsed time: 901 us
 us
 us
----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 90 | lm loss value: 7.295193E+00 | lm loss PPL: 1.473201E+03 | sop loss value: 6.990687E-01 | sop loss PPL: 2.011878E+00 | 
----------------------------------------------------------------------------------------------------------------------------------------------------------
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 8 float float Elapsed time: 384 us
 Elapsed time: 212 Elapsed time: 80 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 RING AllReduce SIMPLE RING Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE half AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Sum Elapsed time: 5803 RING AllReduce half us
 SIMPLE RING Elapsed time: 4993
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Sum SIMPLE us
 AllReduce half Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 RING Elapsed time: 5311 half AllReduce LL us
 Elapsed time: 5828 RING Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us
 LL half AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum Elapsed time: 5909 RING AllReduce half us
 LL RING Elapsed time: 5091 Sum LL us
 half Sum Elapsed time: 5440 half us
 Elapsed time: 5963 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000040000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       91/     100 | consumed samples:         5824 | elapsed time per iteration (ms): 263.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.108314E+00 | sop loss: 7.031202E-01 | loss scale: 65536.0 | grad norm: 2.413 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 133.10 | backward-compute: 97.82 | backward-params-all-reduce: 6.55 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 22.50 | batch-generator: 1.39
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000042000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000019000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 658 float float Elapsed time: 8 us
 Elapsed time: 235 Elapsed time: 470 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 6240 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 AllReduce RING RING AllReduce RING SIMPLE LL RING SIMPLE Sum Sum SIMPLE Sum half half Sum half Elapsed time: 4977 Elapsed time: 6346 half Elapsed time: 5238 us
 us
 Elapsed time: 5859 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING AllReduce RING LL RING LL Sum LL Sum half Sum half Elapsed time: 5077 half Elapsed time: 5367 us
 Elapsed time: 5989 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
 iteration       92/     100 | consumed samples:         5888 | elapsed time per iteration (ms): 198.6 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.124826E+00 | sop loss: 6.919625E-01 | loss scale: 65536.0 | grad norm: 1.310 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
time (ms) | forward-compute: 70.11 | backward-compute: 97.59 | backward-params-all-reduce: 6.57 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.36 | optimizer-unscale-and-check-inf: 2.80 | optimizer-clip-main-grad: 4.53 | optimizer-copy-main-to-model-params: 3.62 | optimizer: 22.33 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 844 float float Elapsed time: 8 us
 Elapsed time: 1118 Elapsed time: 921 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 SIMPLE AllReduce Sum RING half SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Elapsed time: 6433 Sum AllReduce us
 half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 Elapsed time: 5298 AllReduce SIMPLE AllReduce us
 RING Sum RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 SIMPLE half LL AllReduce Sum Elapsed time: 5413 Sum RING half us
 half LL Elapsed time: 5026
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Elapsed time: 6532 Sum us
 AllReduce us
 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING Elapsed time: 5394 AllReduce LL us
 RING Sum LL half Sum Elapsed time: 5538 half us
 Elapsed time: 5149 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
 iteration       93/     100 | consumed samples:         5952 | elapsed time per iteration (ms): 199.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.154169E+00 | sop loss: 7.040847E-01 | loss scale: 65536.0 | grad norm: 2.568 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.50 | backward-compute: 97.63 | backward-params-all-reduce: 6.83 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.68 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.58 | optimizer: 22.70 | batch-generator: 0.93
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 8 float Elapsed time: 1495 Elapsed time: 1063 us
 Elapsed time: 299 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 RING RING AllReduce SIMPLE SIMPLE RING Sum Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE half half AllReduce Sum Elapsed time: 4972 Elapsed time: 6438 RING half us
 us
 SIMPLE Elapsed time: 7011
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Sum us
 AllReduce AllReduce half
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING RING Elapsed time: 5915 AllReduce LL LL us
 RING Sum Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL half half AllReduce Sum Elapsed time: 5075 Elapsed time: 6536 RING half us
 us
 LL Elapsed time: 7143 Sum us
 half Elapsed time: 6036 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000036000 seconds
 iteration       94/     100 | consumed samples:         6016 | elapsed time per iteration (ms): 197.2 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.180117E+00 | sop loss: 6.939188E-01 | loss scale: 65536.0 | grad norm: 0.995 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.19 | backward-compute: 97.53 | backward-params-all-reduce: 8.03 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.65 | optimizer-clip-main-grad: 2.22 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 19.72 | batch-generator: 0.81
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1308 float float Elapsed time: 891 us
 Elapsed time: 835 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000013000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 half AllReduce Elapsed time: 5781 RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce Sum RING AllReduce RING half SIMPLE RING SIMPLE Elapsed time: 5015 Sum LL Sum us
 half Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5150 half Elapsed time: 5459 AllReduce us
 Elapsed time: 5879 us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL AllReduce AllReduce Sum RING RING half LL LL Elapsed time: 5112 Sum Sum us
 half half Elapsed time: 5278 Elapsed time: 5590 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
 iteration       95/     100 | consumed samples:         6080 | elapsed time per iteration (ms): 198.8 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.113697E+00 | sop loss: 6.963837E-01 | loss scale: 65536.0 | grad norm: 2.021 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.98 | backward-compute: 97.41 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.71 | optimizer-clip-main-grad: 4.45 | optimizer-copy-main-to-model-params: 3.66 | optimizer: 22.09 | batch-generator: 0.76
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum float Sum float float Elapsed time: 8 float Elapsed time: 677 Elapsed time: 456 us
 Elapsed time: 179 us
 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5241 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 AllReduce AllReduce RING RING LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce Sum half AllReduce RING half Elapsed time: 5340 RING SIMPLE Elapsed time: 5325 us
 SIMPLE Sum us
 Sum half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Elapsed time: 5685 AllReduce Elapsed time: 5055 us
 RING us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5422 LL Sum us
 Sum half half Elapsed time: 5811 Elapsed time: 5183 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000037000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
 iteration       96/     100 | consumed samples:         6144 | elapsed time per iteration (ms): 198.3 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.205934E+00 | sop loss: 6.948264E-01 | loss scale: 65536.0 | grad norm: 1.180 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.22 | backward-compute: 97.30 | backward-params-all-reduce: 6.84 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.52 | optimizer-unscale-and-check-inf: 2.72 | optimizer-clip-main-grad: 4.42 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 22.14 | batch-generator: 0.77
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 1264 float float Elapsed time: 1523 us
 Elapsed time: 2046 Elapsed time: 8 us
 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce half RING Elapsed time: 5714
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 us
 AllReduce Sum AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 RING half RING AllReduce SIMPLE Elapsed time: 5095 SIMPLE RING Sum us
 Sum LL half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 half Sum Elapsed time: 5033 AllReduce Elapsed time: 5682 half us
 RING us
 Elapsed time: 5811
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 us
 AllReduce Sum AllReduce RING half RING LL Elapsed time: 5192 LL Sum us
 Sum half half Elapsed time: 5164 Elapsed time: 5814 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000032000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       97/     100 | consumed samples:         6208 | elapsed time per iteration (ms): 199.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.127021E+00 | sop loss: 6.962686E-01 | loss scale: 65536.0 | grad norm: 1.967 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 71.59 | backward-compute: 97.31 | backward-params-all-reduce: 6.64 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.56 | optimizer: 21.96 | batch-generator: 0.73
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000031000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum float float Sum float Elapsed time: 498 Elapsed time: 8 float Elapsed time: 330 us
 us
 Elapsed time: 250 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum AllReduce half RING Elapsed time: 6211 SIMPLE us
 Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 half
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce AllReduce Elapsed time: 5600 AllReduce RING RING us
 RING SIMPLE LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 SIMPLE Sum Sum AllReduce Sum half half RING half Elapsed time: 6259 Elapsed time: 6309 LL Elapsed time: 5051 us
 us
 Sum us

[LYD INFO in NCCL_KERN_NAME (common.h)] 0 half
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce Elapsed time: 5696 AllReduce RING us
 RING LL LL Sum Sum half half Elapsed time: 6387 Elapsed time: 5172 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
 iteration       98/     100 | consumed samples:         6272 | elapsed time per iteration (ms): 198.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.132170E+00 | sop loss: 6.930836E-01 | loss scale: 65536.0 | grad norm: 1.130 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.05 | backward-compute: 97.43 | backward-params-all-reduce: 7.18 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.35 | optimizer-unscale-and-check-inf: 2.69 | optimizer-clip-main-grad: 4.43 | optimizer-copy-main-to-model-params: 3.59 | optimizer: 21.98 | batch-generator: 0.70
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000027000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000038000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000018000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf231800
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING RING AllReduce RING LL LL RING LL Sum Sum LL Sum float float Sum float Elapsed time: 808 Elapsed time: 8 float Elapsed time: 618 us
 us
 Elapsed time: 475 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000034000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 6095 us

[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce RING LL
[LYD INFO in NCCL_FUNC_NAME (common.h)] 3 Sum
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2 AllReduce half AllReduce RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 Elapsed time: 6192 RING SIMPLE AllReduce us
 SIMPLE Sum RING Sum half SIMPLE half Elapsed time: 5038 Sum Elapsed time: 5151 us
 half us

[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 6060
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce us
 AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING LL AllReduce LL Sum RING Sum half LL half Elapsed time: 5135 Sum Elapsed time: 5279 us
 half us
 Elapsed time: 6194 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000033000 seconds
 iteration       99/     100 | consumed samples:         6336 | elapsed time per iteration (ms): 198.6 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.128486E+00 | sop loss: 7.050041E-01 | loss scale: 65536.0 | grad norm: 2.875 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 70.28 | backward-compute: 97.86 | backward-params-all-reduce: 6.56 | backward-embedding-all-reduce: 0.03 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.66 | optimizer-clip-main-grad: 4.44 | optimizer-copy-main-to-model-params: 3.57 | optimizer: 21.98 | batch-generator: 0.68
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000028000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000030000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000009000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216c00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING AllReduce RING AllReduce LL RING LL RING Sum LL Sum LL float Sum float Sum Elapsed time: 608 float Elapsed time: 8 float us
 Elapsed time: 254 us
 Elapsed time: 294 us
 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 334723458, datatype: ncclFloat16/ncclHalf, message size: 669446916 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000012000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8de4000000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 334723458
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 6
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 544
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 669446916
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_FUNC_NAME (common.h)] 1 AllReduce RING SIMPLE Sum half Elapsed time: 5636 us

[LYD INFO in NCCL_FUNC_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce AllReduce RING RING
[LYD INFO in NCCL_FUNC_NAME (common.h)] 2
[LYD INFO in NCCL_FUNC_NAME (common.h)] 0 SIMPLE LL AllReduce AllReduce Sum Sum RING RING half half SIMPLE SIMPLE Elapsed time: 5029 Elapsed time: 5734 Sum Sum us
 us
 half half
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 Elapsed time: 5045 Elapsed time: 5228 AllReduce us
 us
 RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL AllReduce AllReduce Sum RING RING half LL LL Elapsed time: 5127 Sum Sum us
 half half Elapsed time: 5171 Elapsed time: 5351 us
 us
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000039000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 1, datatype: ncclFloat32/ncclFloat, message size: 4 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
 iteration      100/     100 | consumed samples:         6400 | elapsed time per iteration (ms): 195.5 | learning rate: 1.000E-05 | global batch size:    64 | lm loss: 7.073829E+00 | sop loss: 6.918234E-01 | loss scale: 65536.0 | grad norm: 0.895 | number of skipped iterations:   0 | number of nan iterations:   0 |
time (ms) | forward-compute: 69.99 | backward-compute: 97.28 | backward-params-all-reduce: 6.54 | backward-embedding-all-reduce: 0.02 | optimizer-copy-to-main-grad: 3.33 | optimizer-unscale-and-check-inf: 2.68 | optimizer-clip-main-grad: 2.15 | optimizer-copy-main-to-model-params: 3.56 | optimizer: 19.63 | batch-generator: 0.69
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000017000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000026000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000024000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000000000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf216a00
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce AllReduce RING LL RING RING LL Sum LL LL Sum float Sum Sum float Elapsed time: 551 float float Elapsed time: 8 us
 Elapsed time: 400 Elapsed time: 160 us
 us
 us
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at iteration 100 | lm loss value: 7.298887E+00 | lm loss PPL: 1.478654E+03 | sop loss value: 7.076339E-01 | sop loss PPL: 2.029184E+00 | [Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
-----------------------------------------------------------------------------------------------------------------------------------------------------------[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0


[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000040000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce LL LL AllReduce RING Sum Sum RING LL uint8_t uint8_t LL Sum Elapsed time: 151 Elapsed time: 45 Sum uint8_t us
 us
 uint8_t Elapsed time: 7 Elapsed time: 120 us
 us
saving checkpoint at iteration     100 to /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000088000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8bf707a400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8bf707a400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum uint8_t Sum uint8_t uint8_t Elapsed time: 3497110 uint8_t Elapsed time: 3496233 Elapsed time: 3494180 us
 Elapsed time: 6 us
 us
 us
  successfully saved checkpoint at iteration     100 to /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000020000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 1 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING AllReduce RING LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING LL Sum AllReduce LL Sum uint8_t RING Sum uint8_t Elapsed time: 2129 LL uint8_t Elapsed time: 2113 us
 Sum Elapsed time: 2101 us
 uint8_t us
 Elapsed time: 6 us
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000016000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000017000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8bf707a400
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8bf707a400
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING LL AllReduce LL Sum
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 RING Sum uint8_t AllReduce LL uint8_t Elapsed time: 288 RING Sum Elapsed time: 314 us
 LL uint8_t us
 Sum Elapsed time: 276 uint8_t us
 Elapsed time: 6 us
time (ms) | save-checkpoint: 3501.56
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING LL AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 Sum RING Sum AllReduce uint8_t LL uint8_t RING Elapsed time: 183 Sum Elapsed time: 139 LL us
 uint8_t us
 Sum Elapsed time: 127 uint8_t us
 Elapsed time: 6 us
[after training is done] datetime: 2023-10-24 02:24:11 
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 30, datatype: ncclInt64, message size: 240 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 1 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 3 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 2 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclBroadcast (broadcast.cc)] rank 0 Broadcast: count: 40976, datatype: ncclInt64, message size: 327808 Bytes
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000025000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000021000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 1 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000022000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 3 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 2 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000029000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 8192, datatype: ncclFloat32/ncclFloat, message size: 32768 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000018000 seconds
[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 2, datatype: ncclFloat32/ncclFloat, message size: 8 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000023000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8bf707a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8bf707a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 7
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 8
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce RING
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce RING LL AllReduce RING LL Sum RING LL Sum float LL Sum float Elapsed time: 9557 Sum float Elapsed time: 9392 us
 float Elapsed time: 9317 us
 Elapsed time: 7 us
 us
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 validation loss at the end of training for val data | lm loss value: 7.230080E+00 | lm loss PPL: 1.380332E+03 | sop loss value: 6.982795E-01 | sop loss PPL: 2.010291E+00 | 
saving checkpoint at iteration     100 to /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000043000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000011000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf30a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf30a000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 AllReduce AllReduce RING AllReduce RING RING LL RING LL LL Sum LL Sum Sum uint8_t Sum uint8_t uint8_t Elapsed time: 4084609 uint8_t Elapsed time: 4086303 Elapsed time: 4085298 us
 Elapsed time: 7 us
 us
 us
  successfully saved checkpoint at iteration     100 to /home/yuke/lyd/Megatron-LM/checkpoints/bert_345m
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24[Hao INFO in ncclAllReduce (all_reduce.cc)] rank 0 ncclAllReduce: count: 1, datatype: ncclUint8, message size: 1 Bytes

[LYD INFO in ncclAllReduce (all_reduce.cc)] rank 0 AllReduce Time: 0.000047000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 0

[LYD INFO in getAlgoInfo (enqueue.cc)] algorithm a is: 1

[LYD INFO in getAlgoInfo (enqueue.cc)] rank: 0, Duration between Point 1 and Point 2: 0.000010000 seconds

[LYD INFO in getAlgoInfo (enqueue.cc)] rank 0, Duration between Point 2 and Point 3: 0.000001000 seconds
[LYD INFO in getAlgoInfo (enqueue.cc)] out rank: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out coll: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sendbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out recvbuff address: 0x7f8ddf209000
[LYD INFO in getAlgoInfo (enqueue.cc)] out count: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out datatype: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSteps: 4
[LYD INFO in getAlgoInfo (enqueue.cc)] out sliceSteps: 2
[LYD INFO in getAlgoInfo (enqueue.cc)] out algorithm: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out protocol: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nChannels: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nThreads: 96
[LYD INFO in getAlgoInfo (enqueue.cc)] out nBytes: 1
[LYD INFO in getAlgoInfo (enqueue.cc)] out nstepsPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out nchunksPerLoop: 0
[LYD INFO in getAlgoInfo (enqueue.cc)] out chunkSize: 0
[LYD INFO in ncclLaunchKernel (enqueue.cc)] NCHANNELS is: 24
[LYD INFO in NCCL_KERN_NAME (common.h)] 1
[LYD INFO in NCCL_KERN_NAME (common.h)] 3 AllReduce AllReduce
[LYD INFO in NCCL_KERN_NAME (common.h)] 2 RING RING AllReduce LL
[LYD INFO in NCCL_KERN_NAME (common.h)] 0 LL RING Sum AllReduce Sum LL uint8_t RING uint8_t Sum Elapsed time: 1367 LL Elapsed time: 1285 uint8_t us
 Sum us
 Elapsed time: 1324 uint8_t us
 Elapsed time: 6 us
x3005c0s19b1n0:15895:16249 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15896:16247 [1] NCCL INFO [Service thread] Connection closed by localRank 1
x3005c0s19b1n0:15897:16248 [2] NCCL INFO [Service thread] Connection closed by localRank 2
x3005c0s19b1n0:15898:16250 [3] NCCL INFO [Service thread] Connection closed by localRank 3
x3005c0s19b1n0:15895:15895 [0] NCCL INFO comm 0x55a5f26dd7d0 rank 0 nranks 4 cudaDev 0 busId 7000 - Abort COMPLETE
x3005c0s19b1n0:15895:17138 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15895:15895 [0] NCCL INFO comm 0x55a627c8e4a0 rank 0 nranks 1 cudaDev 0 busId 7000 - Abort COMPLETE
x3005c0s19b1n0:15895:16281 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15896:15896 [1] NCCL INFO comm 0x55947bce12b0 rank 1 nranks 4 cudaDev 1 busId 46000 - Abort COMPLETE
x3005c0s19b1n0:15896:17135 [1] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15895:15895 [0] NCCL INFO comm 0x55a5f26e38c0 rank 0 nranks 1 cudaDev 0 busId 7000 - Abort COMPLETE
x3005c0s19b1n0:15895:16264 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15896:15896 [1] NCCL INFO comm 0x5594b181d240 rank 0 nranks 1 cudaDev 1 busId 46000 - Abort COMPLETE
x3005c0s19b1n0:15896:16279 [1] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15895:15895 [0] NCCL INFO comm 0x55a5f26e0260 rank 0 nranks 1 cudaDev 0 busId 7000 - Abort COMPLETE
x3005c0s19b1n0:15895:16194 [0] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15896:15896 [1] NCCL INFO comm 0x55947bce6e80 rank 0 nranks 1 cudaDev 1 busId 46000 - Abort COMPLETE
x3005c0s19b1n0:15896:16265 [1] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15897:15897 [2] NCCL INFO comm 0x5558768f13e0 rank 2 nranks 4 cudaDev 2 busId 85000 - Abort COMPLETE
x3005c0s19b1n0:15897:17136 [2] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15898:15898 [3] NCCL INFO comm 0x55d295204080 rank 3 nranks 4 cudaDev 3 busId c7000 - Abort COMPLETE
x3005c0s19b1n0:15898:17137 [3] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15896:15896 [1] NCCL INFO comm 0x55947bce3d40 rank 0 nranks 1 cudaDev 1 busId 46000 - Abort COMPLETE
x3005c0s19b1n0:15896:16192 [1] NCCL INFO [Service thread] Connection closed by localRank 1
x3005c0s19b1n0:15897:15897 [2] NCCL INFO comm 0x5558abcdd990 rank 0 nranks 1 cudaDev 2 busId 85000 - Abort COMPLETE
x3005c0s19b1n0:15897:16280 [2] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15898:15898 [3] NCCL INFO comm 0x55d2ca8071d0 rank 0 nranks 1 cudaDev 3 busId c7000 - Abort COMPLETE
x3005c0s19b1n0:15898:16282 [3] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15897:15897 [2] NCCL INFO comm 0x555877e660e0 rank 0 nranks 1 cudaDev 2 busId 85000 - Abort COMPLETE
x3005c0s19b1n0:15897:16263 [2] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15898:15898 [3] NCCL INFO comm 0x55d29520a6c0 rank 0 nranks 1 cudaDev 3 busId c7000 - Abort COMPLETE
x3005c0s19b1n0:15898:16266 [3] NCCL INFO [Service thread] Connection closed by localRank 0
x3005c0s19b1n0:15897:15897 [2] NCCL INFO comm 0x5558768f3e70 rank 0 nranks 1 cudaDev 2 busId 85000 - Abort COMPLETE
x3005c0s19b1n0:15897:16195 [2] NCCL INFO [Service thread] Connection closed by localRank 2
x3005c0s19b1n0:15898:15898 [3] NCCL INFO comm 0x55d2952071e0 rank 0 nranks 1 cudaDev 3 busId c7000 - Abort COMPLETE
x3005c0s19b1n0:15898:16193 [3] NCCL INFO [Service thread] Connection closed by localRank 3
x3005c0s19b1n0:15895:15895 [0] NCCL INFO comm 0x55a5d3f6f4e0 rank 0 nranks 4 cudaDev 0 busId 7000 - Abort COMPLETE
x3005c0s19b1n0:15896:15896 [1] NCCL INFO comm 0x55947743d920 rank 1 nranks 4 cudaDev 1 busId 46000 - Abort COMPLETE
x3005c0s19b1n0:15898:15898 [3] NCCL INFO comm 0x55d27baec6d0 rank 3 nranks 4 cudaDev 3 busId c7000 - Abort COMPLETE
x3005c0s19b1n0:15897:15897 [2] NCCL INFO comm 0x55585935e720 rank 2 nranks 4 cudaDev 2 busId 85000 - Abort COMPLETE
